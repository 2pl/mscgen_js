/**
     * Renders individual elements in sequence charts
     * @exports renderutensils
     * @license GPLv3
     * @author {@link https://github.com/sverweij | Sander Verweij}
     */

/*
 This file is part of mscgen_js.

 mscgen_js is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 mscgen_js is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with mscgen_js.  If not, see <http://www.gnu.org/licenses/>.
 */

/**
     * sets up a skeleton svg, with the skeleton for rendering an msc ready
     *
     *  desc with id __msc_source - will contain the msc source
     *  defs
     *      a list of markers used as arrow heads (each with an own id)
     *      a stylesheet (without an id)
     *      __defs - placeholder to put the msc elements in
     *  __body - a stack of layers, from bottom to top:
     *      __background    -
     *      __arcspanlayer  - for inline expressions ("arc spanning arcs")
     *      __lifelinelayer - for the lifelines
     *      __sequencelayer - for arcs and associated text
     *      __notelayer     - for notes and boxes - the labels of arcspanning arcs
     *                        will go in here as well
     * @exports renderskeleton
     * @license GPLv3
     * @author {@link https://github.com/sverweij | Sander Verweij}
     */

/**
 * A hodge podge of functions manipulating text
 *
 * @exports node/textutensils
 * @license GPLv3
 * @author {@link https://github.com/sverweij | Sander Verweij}
 */

/**
     *
     * @exports node/asttransform
     * @license GPLv3
     * @author {@link https://github.com/sverweij | Sander Verweij}
     */

/**
 * Defines several mappings of arckinds to agregations
 *
 * @exports node/dotmap
 * @license GPLv3
 * @author {@link https://github.com/sverweij | Sander Verweij}
 */

/**
 * Defines some functions to simplify a given abstract syntax tree.
 *
 * @exports node/flatten
 * @license GPLv3
 * @author {@link https://github.com/sverweij | Sander Verweij}
 */

/**
     *
     * renders an abstract syntax tree of a sequence chart
     *
     * knows of:
     *  - the syntax tree
     *  - the target canvasf
     *
     * Defines default sizes and distances for all objects.

     issue #13
     To get markers to work in canvg and to color them the same color as
     the associate line, we'll need to do something like this:

     <svg xmlns="http://www.w3.org/2000/svg" version="1.1">
     <g transform="translate(10,20)">
     <defs>
     <marker viewBox="0 0 10 10" id="end" refX="9" refY="3" markerUnits="strokeWidth" markerWidth="10" markerHeight="10" orient="auto">
     <path d="M 1 1 l 8 2 l -8 2 " fill="none" stroke="#ABCDEF" stroke-width="1"/>
     </marker>
     </defs>
     <line x1="50" y1="20" x2="210" y2="20" stroke-width="2" stroke="#ABCDEF" marker-end="url(#end)"/>
     </g>
     </svg>
     * @exports renderast
     * @license GPLv3
     * @author {@link https://github.com/sverweij | Sander Verweij}
     */

/*
    This file is part of mscgen_js.

    mscgen_js is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    mscgen_js is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with mscgen_js.  If not, see <http://www.gnu.org/licenses/>.
*/

define("xuparser",[],function(){function e(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}function t(e,t,n,r,i,s){this.message=e,this.expected=t,this.found=n,this.offset=r,this.line=i,this.column=s,this.name="SyntaxError"}function n(e){function Di(){return e.substring(Ci,Ni)}function Pi(){return Ci}function Hi(){return Ii(Ci).line}function Bi(){return Ii(Ci).column}function ji(e){throw Ri(null,[{type:"other",description:e}],Ci)}function Fi(e){throw Ri(e,null,Ci)}function Ii(t){function n(t,n,r){var i,s;for(i=n;i<r;i++)s=e.charAt(i),s==="\n"?(t.seenCR||t.line++,t.column=1,t.seenCR=!1):s==="\r"||s==="\u2028"||s==="\u2029"?(t.line++,t.column=1,t.seenCR=!0):(t.column++,t.seenCR=!1)}return ki!==t&&(ki>t&&(ki=0,Li={line:1,column:1,seenCR:!1}),n(Li,ki,t),ki=t),Li}function qi(e){if(Ni<Ai)return;Ni>Ai&&(Ai=Ni,Oi=[]),Oi.push(e)}function Ri(n,r,i){function s(e){var t=1;e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});while(t<e.length)e[t-1]===e[t]?e.splice(t,1):t++}function o(e,t){function n(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0180-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1080-\uFFFF]/g,function(e){return"\\u"+t(e)})}var r=new Array(e.length),i,s,o;for(o=0;o<e.length;o++)r[o]=e[o].description;return i=e.length>1?r.slice(0,-1).join(", ")+" or "+r[e.length-1]:r[0],s=t?'"'+n(t)+'"':"end of input","Expected "+i+" but "+s+" found."}var u=Ii(i),a=i<e.length?e.charAt(i):null;return r!==null&&s(r),new t(n!==null?n:o(r,a),r,a,i,u.line,u.column)}function Ui(){var t,n,i,s,h,p,d,v,m,g;return t=Ni,n=Os(),n!==r?(i=zi(),i!==r?(s=Ls(),s!==r?(e.charCodeAt(Ni)===123?(h=u,Ni++):(h=r,Mi===0&&qi(a)),h!==r?(p=Ls(),p!==r?(d=Wi(),d!==r?(v=Ls(),v!==r?(e.charCodeAt(Ni)===125?(m=f,Ni++):(m=r,Mi===0&&qi(l)),m!==r?(g=Ls(),g!==r?(Ci=t,n=c(n,d),t=n):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o),t}function zi(){var t;return e.substr(Ni,3).toLowerCase()===h?(t=e.substr(Ni,3),Ni+=3):(t=r,Mi===0&&qi(p)),t}function Wi(){var e,t,n,i,s;return e=Ni,t=Ni,n=Xi(),n!==r&&(Ci=t,n=v(n)),t=n,t===r&&(t=d),t!==r?(n=Ni,i=Ji(),i!==r&&(Ci=n,i=m(i)),n=i,n===r&&(n=d),n!==r?(i=Ni,s=Qi(),s!==r&&(Ci=i,s=g(s)),i=s,i===r&&(i=d),i!==r?(t=[t,n,i],e=t):(Ni=e,e=o)):(Ni=e,e=o)):(Ni=e,e=o),e}function Xi(){var t,n,i,s,u,a;t=Ni,n=Ni,i=[],s=Ni,u=Vi(),u!==r?(e.charCodeAt(Ni)===44?(a=b,Ni++):(a=r,Mi===0&&qi(w)),a!==r?(Ci=s,u=E(u),s=u):(Ni=s,s=o)):(Ni=s,s=o);while(s!==r)i.push(s),s=Ni,u=Vi(),u!==r?(e.charCodeAt(Ni)===44?(a=b,Ni++):(a=r,Mi===0&&qi(w)),a!==r?(Ci=s,u=E(u),s=u):(Ni=s,s=o)):(Ni=s,s=o);return i!==r?(s=Ni,u=Vi(),u!==r?(e.charCodeAt(Ni)===59?(a=S,Ni++):(a=r,Mi===0&&qi(x)),a!==r?(Ci=s,u=E(u),s=u):(Ni=s,s=o)):(Ni=s,s=o),s!==r?(i=[i,s],n=i):(Ni=n,n=o)):(Ni=n,n=o),n!==r&&(Ci=t,n=T(n)),t=n,t}function Vi(){var t,n,i,s,u,a,f,l;return t=Ni,n=Ls(),n!==r?(i=$i(),i!==r?(s=Ls(),s!==r?(e.charCodeAt(Ni)===61?(u=N,Ni++):(u=r,Mi===0&&qi(C)),u!==r?(a=Ls(),a!==r?(f=Ni,l=vs(),l!==r&&(Ci=f,l=k(l)),f=l,f===r&&(f=Ni,l=Ms(),l!==r&&(Ci=f,l=L(l)),f=l,f===r&&(f=Ni,l=Ps(),l!==r&&(Ci=f,l=A(l)),f=l)),f!==r?(l=Ls(),l!==r?(Ci=t,n=O(i,f),t=n):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o),t}function $i(){var t;return e.substr(Ni,6).toLowerCase()===M?(t=e.substr(Ni,6),Ni+=6):(t=r,Mi===0&&qi(_)),t===r&&(e.substr(Ni,5).toLowerCase()===D?(t=e.substr(Ni,5),Ni+=5):(t=r,Mi===0&&qi(P)),t===r&&(e.substr(Ni,11).toLowerCase()===H?(t=e.substr(Ni,11),Ni+=11):(t=r,Mi===0&&qi(B)),t===r&&(e.substr(Ni,12).toLowerCase()===j?(t=e.substr(Ni,12),Ni+=12):(t=r,Mi===0&&qi(F)),t===r&&(e.substr(Ni,9).toLowerCase()===I?(t=e.substr(Ni,9),Ni+=9):(t=r,Mi===0&&qi(q)))))),t}function Ji(){var t,n,i,s,u,a;t=Ni,n=Ni,i=[],s=Ni,u=Ki(),u!==r?(e.charCodeAt(Ni)===44?(a=b,Ni++):(a=r,Mi===0&&qi(w)),a!==r?(Ci=s,u=R(u),s=u):(Ni=s,s=o)):(Ni=s,s=o);while(s!==r)i.push(s),s=Ni,u=Ki(),u!==r?(e.charCodeAt(Ni)===44?(a=b,Ni++):(a=r,Mi===0&&qi(w)),a!==r?(Ci=s,u=R(u),s=u):(Ni=s,s=o)):(Ni=s,s=o);return i!==r?(s=Ni,u=Ki(),u!==r?(e.charCodeAt(Ni)===59?(a=S,Ni++):(a=r,Mi===0&&qi(x)),a!==r?(Ci=s,u=R(u),s=u):(Ni=s,s=o)):(Ni=s,s=o),s!==r?(i=[i,s],n=i):(Ni=n,n=o)):(Ni=n,n=o),n!==r&&(Ci=t,n=U(n)),t=n,t}function Ki(){var t,n,i,s,u,a,f,l;return Mi++,t=Ni,n=Ls(),n!==r?(i=gs(),i!==r?(s=Ls(),s!==r?(u=Ni,e.charCodeAt(Ni)===91?(a=W,Ni++):(a=r,Mi===0&&qi(X)),a!==r?(f=hs(),f!==r?(e.charCodeAt(Ni)===93?(l=V,Ni++):(l=r,Mi===0&&qi($)),l!==r?(Ci=u,a=J(f),u=a):(Ni=u,u=o)):(Ni=u,u=o)):(Ni=u,u=o),u===r&&(u=d),u!==r?(a=Ls(),a!==r?(Ci=t,n=K(i,u),t=n):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o),Mi--,t===r&&(n=r,Mi===0&&qi(z)),t}function Qi(){var t,n,i,s,u;t=[],n=Ni,i=Gi(),i!==r?(s=Ls(),s!==r?(e.charCodeAt(Ni)===59?(u=S,Ni++):(u=r,Mi===0&&qi(x)),u!==r?(Ci=n,i=J(i),n=i):(Ni=n,n=o)):(Ni=n,n=o)):(Ni=n,n=o);if(n!==r)while(n!==r)t.push(n),n=Ni,i=Gi(),i!==r?(s=Ls(),s!==r?(e.charCodeAt(Ni)===59?(u=S,Ni++):(u=r,Mi===0&&qi(x)),u!==r?(Ci=n,i=J(i),n=i):(Ni=n,n=o)):(Ni=n,n=o)):(Ni=n,n=o);else t=o;return t}function Gi(){var t,n,i,s,u,a,f;t=Ni,n=Ni,i=[],s=Ni,u=Yi(),u!==r?(a=Ls(),a!==r?(e.charCodeAt(Ni)===44?(f=b,Ni++):(f=r,Mi===0&&qi(w)),f!==r?(Ci=s,u=J(u),s=u):(Ni=s,s=o)):(Ni=s,s=o)):(Ni=s,s=o);while(s!==r)i.push(s),s=Ni,u=Yi(),u!==r?(a=Ls(),a!==r?(e.charCodeAt(Ni)===44?(f=b,Ni++):(f=r,Mi===0&&qi(w)),f!==r?(Ci=s,u=J(u),s=u):(Ni=s,s=o)):(Ni=s,s=o)):(Ni=s,s=o);return i!==r?(s=Ni,u=Yi(),u!==r&&(Ci=s,u=Q(u)),s=u,s!==r?(i=[i,s],n=i):(Ni=n,n=o)):(Ni=n,n=o),n!==r&&(Ci=t,n=G(n)),t=n,t}function Yi(){var e;return e=Zi(),e===r&&(e=rs()),e}function Zi(){var t,n,i,s,u,a;return t=Ni,n=Ni,i=es(),i!==r&&(Ci=n,i=J(i)),n=i,n===r&&(n=Ni,i=ns(),i!==r&&(Ci=n,i=J(i)),n=i,n===r&&(n=Ni,i=ts(),i!==r&&(Ci=n,i=J(i)),n=i)),n!==r?(i=Ni,e.charCodeAt(Ni)===91?(s=W,Ni++):(s=r,Mi===0&&qi(X)),s!==r?(u=hs(),u!==r?(e.charCodeAt(Ni)===93?(a=V,Ni++):(a=r,Mi===0&&qi($)),a!==r?(Ci=i,s=Y(u),i=s):(Ni=i,i=o)):(Ni=i,i=o)):(Ni=i,i=o),i===r&&(i=d),i!==r?(Ci=t,n=Z(n,i),t=n):(Ni=t,t=o)):(Ni=t,t=o),t}function es(){var e,t,n,i;return e=Ni,t=Ls(),t!==r?(n=is(),n!==r?(i=Ls(),i!==r?(Ci=e,t=et(n),e=t):(Ni=e,e=o)):(Ni=e,e=o)):(Ni=e,e=o),e}function ts(){var e,t,n,i;return e=Ni,t=Ls(),t!==r?(n=ss(),n!==r?(i=Ls(),i!==r?(Ci=e,t=et(n),e=t):(Ni=e,e=o)):(Ni=e,e=o)):(Ni=e,e=o),e}function ns(){var t,n,i,s,u,a,f,l;return t=Ni,n=Ls(),n!==r?(i=gs(),i!==r?(s=Ls(),s!==r?(u=os(),u!==r?(a=Ls(),a!==r?(f=gs(),f!==r?(l=Ls(),l!==r?(Ci=t,n=tt(i,u,f),t=n):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o),t===r&&(t=Ni,n=Ls(),n!==r?(e.charCodeAt(Ni)===42?(i=nt,Ni++):(i=r,Mi===0&&qi(rt)),i!==r?(s=Ls(),s!==r?(u=fs(),u!==r?(a=Ls(),a!==r?(f=gs(),f!==r?(l=Ls(),l!==r?(Ci=t,n=it(u,f),t=n):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o),t===r&&(t=Ni,n=Ls(),n!==r?(i=gs(),i!==r?(s=Ls(),s!==r?(u=as(),u!==r?(a=Ls(),a!==r?(e.charCodeAt(Ni)===42?(f=nt,Ni++):(f=r,Mi===0&&qi(rt)),f!==r?(l=Ls(),l!==r?(Ci=t,n=st(i,u),t=n):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o))),t}function rs(){var t,n,i,s,c,h,p,v,m,g,y,b,w,E,S,x;return t=Ni,n=Ls(),n!==r?(i=gs(),i!==r?(s=Ls(),s!==r?(c=cs(),c!==r?(h=Ls(),h!==r?(p=gs(),p!==r?(v=Ls(),v!==r?(m=Ni,e.charCodeAt(Ni)===91?(g=W,Ni++):(g=r,Mi===0&&qi(X)),g!==r?(y=hs(),y!==r?(e.charCodeAt(Ni)===93?(b=V,Ni++):(b=r,Mi===0&&qi($)),b!==r?(Ci=m,g=Y(y),m=g):(Ni=m,m=o)):(Ni=m,m=o)):(Ni=m,m=o),m===r&&(m=d),m!==r?(g=Ls(),g!==r?(e.charCodeAt(Ni)===123?(y=u,Ni++):(y=r,Mi===0&&qi(a)),y!==r?(b=Ls(),b!==r?(w=Qi(),w!==r?(E=Ls(),E!==r?(e.charCodeAt(Ni)===125?(S=f,Ni++):(S=r,Mi===0&&qi(l)),S!==r?(x=Ls(),x!==r?(Ci=t,n=ot(i,c,p,m,w),t=n):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o),t}function is(){var t;return e.substr(Ni,3)===ut?(t=ut,Ni+=3):(t=r,Mi===0&&qi(at)),t===r&&(e.substr(Ni,3)===ft?(t=ft,Ni+=3):(t=r,Mi===0&&qi(lt))),t}function ss(){var t;return e.substr(Ni,3)===ct?(t=ct,Ni+=3):(t=r,Mi===0&&qi(ht)),t}function os(){var e,t;return e=Ni,t=us(),t===r&&(t=as(),t===r&&(t=fs(),t===r&&(t=ls()))),t!==r&&(Ci=e,t=pt(t)),e=t,e}function us(){var t,n;return Mi++,e.substr(Ni,2)===vt?(t=vt,Ni+=2):(t=r,Mi===0&&qi(mt)),t===r&&(e.substr(Ni,3)===gt?(t=gt,Ni+=3):(t=r,Mi===0&&qi(yt)),t===r&&(e.substr(Ni,2)===bt?(t=bt,Ni+=2):(t=r,Mi===0&&qi(wt)),t===r&&(e.substr(Ni,5)===Et?(t=Et,Ni+=5):(t=r,Mi===0&&qi(St)),t===r&&(e.substr(Ni,3)===xt?(t=xt,Ni+=3):(t=r,Mi===0&&qi(Tt)),t===r&&(e.substr(Ni,2)===Nt?(t=Nt,Ni+=2):(t=r,Mi===0&&qi(Ct)),t===r&&(e.substr(Ni,4)===kt?(t=kt,Ni+=4):(t=r,Mi===0&&qi(Lt)),t===r&&(e.substr(Ni,2)===At?(t=At,Ni+=2):(t=r,Mi===0&&qi(Ot)),t===r&&(e.substr(Ni,3)===Mt?(t=Mt,Ni+=3):(t=r,Mi===0&&qi(_t)))))))))),Mi--,t===r&&(n=r,Mi===0&&qi(dt)),t}function as(){var t,n;return Mi++,e.substr(Ni,2)===Pt?(t=Pt,Ni+=2):(t=r,Mi===0&&qi(Ht)),t===r&&(e.substr(Ni,3)===Bt?(t=Bt,Ni+=3):(t=r,Mi===0&&qi(jt)),t===r&&(e.substr(Ni,2)===Ft?(t=Ft,Ni+=2):(t=r,Mi===0&&qi(It)),t===r&&(e.substr(Ni,2)===qt?(t=qt,Ni+=2):(t=r,Mi===0&&qi(Rt)),t===r&&(e.substr(Ni,2)===Ut?(t=Ut,Ni+=2):(t=r,Mi===0&&qi(zt)),t===r&&(e.substr(Ni,2).toLowerCase()===Wt?(t=e.substr(Ni,2),Ni+=2):(t=r,Mi===0&&qi(Xt))))))),Mi--,t===r&&(n=r,Mi===0&&qi(Dt)),t}function fs(){var t,n;return Mi++,e.substr(Ni,2)===$t?(t=$t,Ni+=2):(t=r,Mi===0&&qi(Jt)),t===r&&(e.substr(Ni,3)===Kt?(t=Kt,Ni+=3):(t=r,Mi===0&&qi(Qt)),t===r&&(e.substr(Ni,2)===Gt?(t=Gt,Ni+=2):(t=r,Mi===0&&qi(Yt)),t===r&&(e.substr(Ni,2)===Zt?(t=Zt,Ni+=2):(t=r,Mi===0&&qi(en)),t===r&&(e.substr(Ni,2)===tn?(t=tn,Ni+=2):(t=r,Mi===0&&qi(nn)),t===r&&(e.substr(Ni,2).toLowerCase()===rn?(t=e.substr(Ni,2),Ni+=2):(t=r,Mi===0&&qi(sn))))))),Mi--,t===r&&(n=r,Mi===0&&qi(Vt)),t}function ls(){var t,n;return Mi++,e.substr(Ni,4).toLowerCase()===un?(t=e.substr(Ni,4),Ni+=4):(t=r,Mi===0&&qi(an)),t===r&&(e.substr(Ni,4).toLowerCase()===fn?(t=e.substr(Ni,4),Ni+=4):(t=r,Mi===0&&qi(ln)),t===r&&(e.substr(Ni,4).toLowerCase()===cn?(t=e.substr(Ni,4),Ni+=4):(t=r,Mi===0&&qi(hn)),t===r&&(e.substr(Ni,3).toLowerCase()===pn?(t=e.substr(Ni,3),Ni+=3):(t=r,Mi===0&&qi(dn))))),Mi--,t===r&&(n=r,Mi===0&&qi(on)),t}function cs(){var t,n;return Mi++,t=Ni,e.substr(Ni,3).toLowerCase()===mn?(n=e.substr(Ni,3),Ni+=3):(n=r,Mi===0&&qi(gn)),n===r&&(e.substr(Ni,4).toLowerCase()===yn?(n=e.substr(Ni,4),Ni+=4):(n=r,Mi===0&&qi(bn)),n===r&&(e.substr(Ni,3).toLowerCase()===wn?(n=e.substr(Ni,3),Ni+=3):(n=r,Mi===0&&qi(En)),n===r&&(e.substr(Ni,5).toLowerCase()===Sn?(n=e.substr(Ni,5),Ni+=5):(n=r,Mi===0&&qi(xn)),n===r&&(e.substr(Ni,3).toLowerCase()===Tn?(n=e.substr(Ni,3),Ni+=3):(n=r,Mi===0&&qi(Nn)),n===r&&(e.substr(Ni,3).toLowerCase()===Cn?(n=e.substr(Ni,3),Ni+=3):(n=r,Mi===0&&qi(kn)),n===r&&(e.substr(Ni,6).toLowerCase()===Ln?(n=e.substr(Ni,6),Ni+=6):(n=r,Mi===0&&qi(An)),n===r&&(e.substr(Ni,3).toLowerCase()===On?(n=e.substr(Ni,3),Ni+=3):(n=r,Mi===0&&qi(Mn)),n===r&&(e.substr(Ni,8).toLowerCase()===_n?(n=e.substr(Ni,8),Ni+=8):(n=r,Mi===0&&qi(Dn)),n===r&&(e.substr(Ni,6).toLowerCase()===Pn?(n=e.substr(Ni,6),Ni+=6):(n=r,Mi===0&&qi(Hn)),n===r&&(e.substr(Ni,8).toLowerCase()===Bn?(n=e.substr(Ni,8),Ni+=8):(n=r,Mi===0&&qi(jn)),n===r&&(e.substr(Ni,6).toLowerCase()===Fn?(n=e.substr(Ni,6),Ni+=6):(n=r,Mi===0&&qi(In)),n===r&&(e.substr(Ni,4).toLowerCase()===qn?(n=e.substr(Ni,4),Ni+=4):(n=r,Mi===0&&qi(Rn)),n===r&&(e.substr(Ni,3).toLowerCase()===Un?(n=e.substr(Ni,3),Ni+=3):(n=r,Mi===0&&qi(zn)),n===r&&(e.substr(Ni,3).toLowerCase()===Wn?(n=e.substr(Ni,3),Ni+=3):(n=r,Mi===0&&qi(Xn)))))))))))))))),n!==r&&(Ci=t,n=pt(n)),t=n,Mi--,t===r&&(n=r,Mi===0&&qi(vn)),t}function hs(){var t,n,i,s,u,a;t=Ni,n=Ni,i=[],s=Ni,u=ps(),u!==r?(e.charCodeAt(Ni)===44?(a=b,Ni++):(a=r,Mi===0&&qi(w)),a!==r?(Ci=s,u=J(u),s=u):(Ni=s,s=o)):(Ni=s,s=o);while(s!==r)i.push(s),s=Ni,u=ps(),u!==r?(e.charCodeAt(Ni)===44?(a=b,Ni++):(a=r,Mi===0&&qi(w)),a!==r?(Ci=s,u=J(u),s=u):(Ni=s,s=o)):(Ni=s,s=o);return i!==r?(s=Ni,u=ps(),u!==r&&(Ci=s,u=J(u)),s=u,s!==r?(i=[i,s],n=i):(Ni=n,n=o)):(Ni=n,n=o),n!==r&&(Ci=t,n=Vn(n)),t=n,t}function ps(){var t,n,i,s,u,a,f,l;return t=Ni,n=Ls(),n!==r?(i=ds(),i!==r?(s=Ls(),s!==r?(e.charCodeAt(Ni)===61?(u=N,Ni++):(u=r,Mi===0&&qi(C)),u!==r?(a=Ls(),a!==r?(f=gs(),f!==r?(l=Ls(),l!==r?(Ci=t,n=$n(i,f),t=n):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o),t}function ds(){var t,n;return Mi++,e.substr(Ni,5).toLowerCase()===Kn?(t=e.substr(Ni,5),Ni+=5):(t=r,Mi===0&&qi(Qn)),t===r&&(e.substr(Ni,5).toLowerCase()===Gn?(t=e.substr(Ni,5),Ni+=5):(t=r,Mi===0&&qi(Yn)),t===r&&(e.substr(Ni,2).toLowerCase()===Zn?(t=e.substr(Ni,2),Ni+=2):(t=r,Mi===0&&qi(er)),t===r&&(e.substr(Ni,3).toLowerCase()===tr?(t=e.substr(Ni,3),Ni+=3):(t=r,Mi===0&&qi(nr)),t===r&&(e.substr(Ni,9).toLowerCase()===rr?(t=e.substr(Ni,9),Ni+=9):(t=r,Mi===0&&qi(ir)),t===r&&(e.substr(Ni,10).toLowerCase()===sr?(t=e.substr(Ni,10),Ni+=10):(t=r,Mi===0&&qi(or)),t===r&&(e.substr(Ni,9).toLowerCase()===ur?(t=e.substr(Ni,9),Ni+=9):(t=r,Mi===0&&qi(ar)),t===r&&(e.substr(Ni,10).toLowerCase()===fr?(t=e.substr(Ni,10),Ni+=10):(t=r,Mi===0&&qi(lr)),t===r&&(e.substr(Ni,11).toLowerCase()===cr?(t=e.substr(Ni,11),Ni+=11):(t=r,Mi===0&&qi(hr)),t===r&&(e.substr(Ni,12).toLowerCase()===pr?(t=e.substr(Ni,12),Ni+=12):(t=r,Mi===0&&qi(dr)),t===r&&(e.substr(Ni,12).toLowerCase()===vr?(t=e.substr(Ni,12),Ni+=12):(t=r,Mi===0&&qi(mr)),t===r&&(e.substr(Ni,13).toLowerCase()===gr?(t=e.substr(Ni,13),Ni+=13):(t=r,Mi===0&&qi(yr)),t===r&&(e.substr(Ni,12).toLowerCase()===br?(t=e.substr(Ni,12),Ni+=12):(t=r,Mi===0&&qi(wr)),t===r&&(e.substr(Ni,13).toLowerCase()===Er?(t=e.substr(Ni,13),Ni+=13):(t=r,Mi===0&&qi(Sr)),t===r&&(e.substr(Ni,14).toLowerCase()===xr?(t=e.substr(Ni,14),Ni+=14):(t=r,Mi===0&&qi(Tr)),t===r&&(e.substr(Ni,15).toLowerCase()===Nr?(t=e.substr(Ni,15),Ni+=15):(t=r,Mi===0&&qi(Cr)),t===r&&(e.substr(Ni,7).toLowerCase()===kr?(t=e.substr(Ni,7),Ni+=7):(t=r,Mi===0&&qi(Lr)))))))))))))))))),Mi--,t===r&&(n=r,Mi===0&&qi(Jn)),t}function vs(){var t,n,i,s;return t=Ni,e.charCodeAt(Ni)===34?(n=Ar,Ni++):(n=r,Mi===0&&qi(Or)),n!==r?(i=ms(),i!==r?(e.charCodeAt(Ni)===34?(s=Ar,Ni++):(s=r,Mi===0&&qi(Or)),s!==r?(Ci=t,n=Mr(i),t=n):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o),t}function ms(){var t,n,i,s;t=[],n=Ni,i=Ni,Mi++,e.charCodeAt(Ni)===34?(s=Ar,Ni++):(s=r,Mi===0&&qi(Or)),Mi--,s===r?i=_r:(Ni=i,i=o),i!==r?(e.substr(Ni,2)===Dr?(s=Dr,Ni+=2):(s=r,Mi===0&&qi(Pr)),s===r&&(e.length>Ni?(s=e.charAt(Ni),Ni++):(s=r,Mi===0&&qi(Hr))),s!==r?(Ci=n,i=Br(s),n=i):(Ni=n,n=o)):(Ni=n,n=o);while(n!==r)t.push(n),n=Ni,i=Ni,Mi++,e.charCodeAt(Ni)===34?(s=Ar,Ni++):(s=r,Mi===0&&qi(Or)),Mi--,s===r?i=_r:(Ni=i,i=o),i!==r?(e.substr(Ni,2)===Dr?(s=Dr,Ni+=2):(s=r,Mi===0&&qi(Pr)),s===r&&(e.length>Ni?(s=e.charAt(Ni),Ni++):(s=r,Mi===0&&qi(Hr))),s!==r?(Ci=n,i=Br(s),n=i):(Ni=n,n=o)):(Ni=n,n=o);return t}function gs(){var t,n,i;Mi++,t=Ni,n=[],Fr.test(e.charAt(Ni))?(i=e.charAt(Ni),Ni++):(i=r,Mi===0&&qi(Ir));if(i!==r)while(i!==r)n.push(i),Fr.test(e.charAt(Ni))?(i=e.charAt(Ni),Ni++):(i=r,Mi===0&&qi(Ir));else n=o;return n!==r&&(Ci=t,n=qr(n)),t=n,t===r&&(t=vs()),Mi--,t===r&&(n=r,Mi===0&&qi(jr)),t}function ys(){var t,n;return Mi++,t=Ni,Ur.test(e.charAt(Ni))?(n=e.charAt(Ni),Ni++):(n=r,Mi===0&&qi(zr)),n!==r&&(Ci=t,n=Wr()),t=n,Mi--,t===r&&(n=r,Mi===0&&qi(Rr)),t}function bs(){var t,n;return Mi++,t=Ni,Vr.test(e.charAt(Ni))?(n=e.charAt(Ni),Ni++):(n=r,Mi===0&&qi($r)),n!==r&&(Ci=t,n=Jr()),t=n,Mi--,t===r&&(n=r,Mi===0&&qi(Xr)),t}function ws(){var t;return e.substr(Ni,2)===Kr?(t=Kr,Ni+=2):(t=r,Mi===0&&qi(Qr)),t}function Es(){var t;return e.substr(Ni,2)===Gr?(t=Gr,Ni+=2):(t=r,Mi===0&&qi(Yr)),t}function Ss(){var t,n,i;return t=Ni,n=Ni,Mi++,e.substr(Ni,2)===Gr?(i=Gr,Ni+=2):(i=r,Mi===0&&qi(Yr)),Mi--,i===r?n=_r:(Ni=n,n=o),n!==r?(e.length>Ni?(i=e.charAt(Ni),Ni++):(i=r,Mi===0&&qi(Hr)),i!==r?(Ci=t,n=Br(i),t=n):(Ni=t,t=o)):(Ni=t,t=o),t}function xs(){var e,t,n,i;e=Ni,t=ws();if(t!==r){n=[],i=Ss();while(i!==r)n.push(i),i=Ss();n!==r?(i=Es(),i!==r?(Ci=e,t=Zr(t,n,i),e=t):(Ni=e,e=o)):(Ni=e,e=o)}else Ni=e,e=o;return e}function Ts(){var t;return e.substr(Ni,2)===ei?(t=ei,Ni+=2):(t=r,Mi===0&&qi(ti)),t===r&&(e.charCodeAt(Ni)===35?(t=ni,Ni++):(t=r,Mi===0&&qi(ri))),t}function Ns(){var t;return ii.test(e.charAt(Ni))?(t=e.charAt(Ni),Ni++):(t=r,Mi===0&&qi(si)),t}function Cs(){var e,t,n,i;e=Ni,t=Ts();if(t!==r){n=[],i=Ns();while(i!==r)n.push(i),i=Ns();n!==r?(Ci=e,t=oi(t,n),e=t):(Ni=e,e=o)}else Ni=e,e=o;return e}function ks(){var e,t;return Mi++,e=Cs(),e===r&&(e=xs()),Mi--,e===r&&(t=r,Mi===0&&qi(ui)),e}function Ls(){var e,t,n;e=[],t=[],n=ys();if(n!==r)while(n!==r)t.push(n),n=ys();else t=o;if(t===r){t=[],n=bs();if(n!==r)while(n!==r)t.push(n),n=bs();else t=o;t===r&&(t=ks())}while(t!==r){e.push(t),t=[],n=ys();if(n!==r)while(n!==r)t.push(n),n=ys();else t=o;if(t===r){t=[],n=bs();if(n!==r)while(n!==r)t.push(n),n=bs();else t=o;t===r&&(t=ks())}}return e}function As(){var e,t,n;e=[],t=[],n=ys();if(n!==r)while(n!==r)t.push(n),n=ys();else t=o;if(t===r){t=[],n=bs();if(n!==r)while(n!==r)t.push(n),n=bs();else t=o}while(t!==r){e.push(t),t=[],n=ys();if(n!==r)while(n!==r)t.push(n),n=ys();else t=o;if(t===r){t=[],n=bs();if(n!==r)while(n!==r)t.push(n),n=bs();else t=o}}return e}function Os(){var e,t,n,i,s;e=[],t=Ni,n=As(),n!==r?(i=ks(),i!==r?(s=As(),s!==r?(Ci=t,n=Br(i),t=n):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o);while(t!==r)e.push(t),t=Ni,n=As(),n!==r?(i=ks(),i!==r?(s=As(),s!==r?(Ci=t,n=Br(i),t=n):(Ni=t,t=o)):(Ni=t,t=o)):(Ni=t,t=o);return e}function Ms(){var e;return e=Ds(),e===r&&(e=_s()),e}function _s(){var t,n,i;Mi++,t=Ni,n=[],fi.test(e.charAt(Ni))?(i=e.charAt(Ni),Ni++):(i=r,Mi===0&&qi(li));if(i!==r)while(i!==r)n.push(i),fi.test(e.charAt(Ni))?(i=e.charAt(Ni),Ni++):(i=r,Mi===0&&qi(li));else n=o;return n!==r&&(Ci=t,n=ci(n)),t=n,Mi--,t===r&&(n=r,Mi===0&&qi(ai)),t}function Ds(){var t,n,i,s,u,a;Mi++,t=Ni,n=Ni,i=[],fi.test(e.charAt(Ni))?(s=e.charAt(Ni),Ni++):(s=r,Mi===0&&qi(li));if(s!==r)while(s!==r)i.push(s),fi.test(e.charAt(Ni))?(s=e.charAt(Ni),Ni++):(s=r,Mi===0&&qi(li));else i=o;if(i!==r){e.charCodeAt(Ni)===46?(s=pi,Ni++):(s=r,Mi===0&&qi(di));if(s!==r){u=[],fi.test(e.charAt(Ni))?(a=e.charAt(Ni),Ni++):(a=r,Mi===0&&qi(li));if(a!==r)while(a!==r)u.push(a),fi.test(e.charAt(Ni))?(a=e.charAt(Ni),Ni++):(a=r,Mi===0&&qi(li));else u=o;u!==r?(i=[i,s,u],n=i):(Ni=n,n=o)}else Ni=n,n=o}else Ni=n,n=o;return n!==r&&(Ci=t,n=vi(n)),t=n,Mi--,t===r&&(n=r,Mi===0&&qi(hi)),t}function Ps(){var t,n;return Mi++,e.substr(Ni,4).toLowerCase()===gi?(t=e.substr(Ni,4),Ni+=4):(t=r,Mi===0&&qi(yi)),t===r&&(e.substr(Ni,5).toLowerCase()===bi?(t=e.substr(Ni,5),Ni+=5):(t=r,Mi===0&&qi(wi)),t===r&&(e.substr(Ni,2).toLowerCase()===Ei?(t=e.substr(Ni,2),Ni+=2):(t=r,Mi===0&&qi(Si)),t===r&&(e.substr(Ni,3).toLowerCase()===xi?(t=e.substr(Ni,3),Ni+=3):(t=r,Mi===0&&qi(Ti))))),Mi--,t===r&&(n=r,Mi===0&&qi(mi)),t}function Hs(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n}function Bs(e){var t="false";switch(e.toLowerCase()){case"true":case"on":case"1":t="true"}return t}function js(e,t){var n=0;if(t===undefined||t==="*")return!0;if(e&&e.entities&&t)for(n=0;n<e.entities.length;n++)if(e.entities[n].name===t)return!0;return!1}function Fs(e,t){this.message="Entity '"+e+"' in arc ",this.message+="'"+t.from+" "+t.kind+" "+t.to+"' ",this.message+="is not defined.",this.name="EntityNotDefinedError"}function Is(e,t){var n=0,r=0,i={};e?i=e:i.entities=[];if(t&&t.arcs)for(n=0;n<t.arcs.length;n++)for(r=0;r<t.arcs[n].length;r++){if(!js(i,t.arcs[n][r].from))throw new Fs(t.arcs[n][r].from,t.arcs[n][r]);if(!js(i,t.arcs[n][r].to))throw new Fs(t.arcs[n][r].to,t.arcs[n][r])}return i}var n=arguments.length>1?arguments[1]:{},r={},i={program:Ui},s=Ui,o=r,u="{",a={type:"literal",value:"{",description:'"{"'},f="}",l={type:"literal",value:"}",description:'"}"'},c=function(e,t){t[1]=Is(t[1],t[2]);var n=Hs(t[0],Hs(t[1],t[2]));return e.length>0&&(n=Hs({precomment:e},n)),n},h="msc",p={type:"literal",value:"msc",description:'"msc"'},d=null,v=function(e){return{options:e}},m=function(e){return{entities:e}},g=function(e){return{arcs:e}},y=[],b=",",w={type:"literal",value:",",description:'","'},E=function(e){return e},S=";",x={type:"literal",value:";",description:'";"'},T=function(e){var t={},n,r;for(n in e[0])for(r in e[0][n])t[r]=e[0][n][r];return t=Hs(t,e[1]),t},N="=",C={type:"literal",value:"=",description:'"="'},k=function(e){return e},L=function(e){return e.toString()},A=function(e){return e.toString()},O=function(e,t){var n={};return e=e.toLowerCase(),e==="wordwraparcs"?n[e]=Bs(t):n[e]=t,n},M="hscale",_={type:"literal",value:"hscale",description:'"hscale"'},D="width",P={type:"literal",value:"width",description:'"width"'},H="arcgradient",B={type:"literal",value:"arcgradient",description:'"arcgradient"'},j="wordwraparcs",F={type:"literal",value:"wordwraparcs",description:'"wordwraparcs"'},I="watermark",q={type:"literal",value:"watermark",description:'"watermark"'},R=function(e){return e},U=function(e){return e[0].push(e[1]),e[0]},z={type:"other",description:"entity"},W="[",X={type:"literal",value:"[",description:'"["'},V="]",$={type:"literal",value:"]",description:'"]"'},J=function(e){return e},K=function(e,t){var n={};return n.name=e,n=Hs(n,t),n},Q=function(e){return[e]},G=function(e){return e[0].push(e[1][0]),e[0]},Y=function(e){return e},Z=function(e,t){return e=Hs(e,t),e},et=function(e){return{kind:e}},tt=function(e,t,n){return{kind:t,from:e,to:n}},nt="*",rt={type:"literal",value:"*",description:'"*"'},it=function(e,t){return{kind:e,from:"*",to:t}},st=function(e,t){return{kind:t,from:e,to:"*"}},ot=function(e,t,n,r,i){var s={kind:t,from:e,to:n,arcs:i};return s=Hs(s,r),s},ut="|||",at={type:"literal",value:"|||",description:'"|||"'},ft="...",lt={type:"literal",value:"...",description:'"..."'},ct="---",ht={type:"literal",value:"---",description:'"---"'},pt=function(e){return e.toLowerCase()},dt={type:"other",description:"bi-directional arrow"},vt="--",mt={type:"literal",value:"--",description:'"--"'},gt="<->",yt={type:"literal",value:"<->",description:'"<->"'},bt="==",wt={type:"literal",value:"==",description:'"=="'},Et="<<=>>",St={type:"literal",value:"<<=>>",description:'"<<=>>"'},xt="<=>",Tt={type:"literal",value:"<=>",description:'"<=>"'},Nt="..",Ct={type:"literal",value:"..",description:'".."'},kt="<<>>",Lt={type:"literal",value:"<<>>",description:'"<<>>"'},At="::",Ot={type:"literal",value:"::",description:'"::"'},Mt="<:>",_t={type:"literal",value:"<:>",description:'"<:>"'},Dt={type:"other",description:"left to right arrow"},Pt="->",Ht={type:"literal",value:"->",description:'"->"'},Bt="=>>",jt={type:"literal",value:"=>>",description:'"=>>"'},Ft="=>",It={type:"literal",value:"=>",description:'"=>"'},qt=">>",Rt={type:"literal",value:">>",description:'">>"'},Ut=":>",zt={type:"literal",value:":>",description:'":>"'},Wt="-x",Xt={type:"literal",value:"-x",description:'"-x"'},Vt={type:"other",description:"right to left arrow"},$t="<-",Jt={type:"literal",value:"<-",description:'"<-"'},Kt="<<=",Qt={type:"literal",value:"<<=",description:'"<<="'},Gt="<=",Yt={type:"literal",value:"<=",description:'"<="'},Zt="<<",en={type:"literal",value:"<<",description:'"<<"'},tn="<:",nn={type:"literal",value:"<:",description:'"<:"'},rn="x-",sn={type:"literal",value:"x-",description:'"x-"'},on={type:"other",description:"box"},un="note",an={type:"literal",value:"note",description:'"note"'},fn="abox",ln={type:"literal",value:"abox",description:'"abox"'},cn="rbox",hn={type:"literal",value:"rbox",description:'"rbox"'},pn="box",dn={type:"literal",value:"box",description:'"box"'},vn={type:"other",description:"arc spanning box"},mn="alt",gn={type:"literal",value:"alt",description:'"alt"'},yn="else",bn={type:"literal",value:"else",description:'"else"'},wn="opt",En={type:"literal",value:"opt",description:'"opt"'},Sn="break",xn={type:"literal",value:"break",description:'"break"'},Tn="par",Nn={type:"literal",value:"par",description:'"par"'},Cn="seq",kn={type:"literal",value:"seq",description:'"seq"'},Ln="strict",An={type:"literal",value:"strict",description:'"strict"'},On="neg",Mn={type:"literal",value:"neg",description:'"neg"'},_n="critical",Dn={type:"literal",value:"critical",description:'"critical"'},Pn="ignore",Hn={type:"literal",value:"ignore",description:'"ignore"'},Bn="consider",jn={type:"literal",value:"consider",description:'"consider"'},Fn="assert",In={type:"literal",value:"assert",description:'"assert"'},qn="loop",Rn={type:"literal",value:"loop",description:'"loop"'},Un="ref",zn={type:"literal",value:"ref",description:'"ref"'},Wn="exc",Xn={type:"literal",value:"exc",description:'"exc"'},Vn=function(e){var t={},n,r;for(n in e[0])for(r in e[0][n])t[r]=e[0][n][r];return t=Hs(t,e[1]),t},$n=function(e,t){var n={};return e=e.toLowerCase(),e=e.replace("colour","color"),n[e]=t,n},Jn={type:"other",description:"attribute name"},Kn="label",Qn={type:"literal",value:"label",description:'"label"'},Gn="idurl",Yn={type:"literal",value:"idurl",description:'"idurl"'},Zn="id",er={type:"literal",value:"id",description:'"id"'},tr="url",nr={type:"literal",value:"url",description:'"url"'},rr="linecolor",ir={type:"literal",value:"linecolor",description:'"linecolor"'},sr="linecolour",or={type:"literal",value:"linecolour",description:'"linecolour"'},ur="textcolor",ar={type:"literal",value:"textcolor",description:'"textcolor"'},fr="textcolour",lr={type:"literal",value:"textcolour",description:'"textcolour"'},cr="textbgcolor",hr={type:"literal",value:"textbgcolor",description:'"textbgcolor"'},pr="textbgcolour",dr={type:"literal",value:"textbgcolour",description:'"textbgcolour"'},vr="arclinecolor",mr={type:"literal",value:"arclinecolor",description:'"arclinecolor"'},gr="arclinecolour",yr={type:"literal",value:"arclinecolour",description:'"arclinecolour"'},br="arctextcolor",wr={type:"literal",value:"arctextcolor",description:'"arctextcolor"'},Er="arctextcolour",Sr={type:"literal",value:"arctextcolour",description:'"arctextcolour"'},xr="arctextbgcolor",Tr={type:"literal",value:"arctextbgcolor",description:'"arctextbgcolor"'},Nr="arctextbgcolour",Cr={type:"literal",value:"arctextbgcolour",description:'"arctextbgcolour"'},kr="arcskip",Lr={type:"literal",value:"arcskip",description:'"arcskip"'},Ar='"',Or={type:"literal",value:'"',description:'"\\""'},Mr=function(e){return e.join("")},_r=void 0,Dr='\\"',Pr={type:"literal",value:'\\"',description:'"\\\\\\""'},Hr={type:"any",description:"any character"},Br=function(e){return e},jr={type:"other",description:"identifier"},Fr=/^[A-Za-z_0-9]/,Ir={type:"class",value:"[A-Za-z_0-9]",description:"[A-Za-z_0-9]"},qr=function(e){return e.join("")},Rr={type:"other",description:"whitespace"},Ur=/^[ \t]/,zr={type:"class",value:"[ \\t]",description:"[ \\t]"},Wr=function(){return""},Xr={type:"other",description:"lineend"},Vr=/^[\r\n]/,$r={type:"class",value:"[\\r\\n]",description:"[\\r\\n]"},Jr=function(){return{}},Kr="/*",Qr={type:"literal",value:"/*",description:'"/*"'},Gr="*/",Yr={type:"literal",value:"*/",description:'"*/"'},Zr=function(e,t,n){return e+t.join("")+n},ei="//",ti={type:"literal",value:"//",description:'"//"'},ni="#",ri={type:"literal",value:"#",description:'"#"'},ii=/^[^\r\n]/,si={type:"class",value:"[^\\r\\n]",description:"[^\\r\\n]"},oi=function(e,t){return e+t.join("")},ui={type:"other",description:"comment"},ai={type:"other",description:"integer"},fi=/^[0-9]/,li={type:"class",value:"[0-9]",description:"[0-9]"},ci=function(e){return parseInt(e.join(""),10)},hi={type:"other",description:"real"},pi=".",di={type:"literal",value:".",description:'"."'},vi=function(e){return parseFloat(e.join(""))},mi={type:"other",description:"boolean"},gi="true",yi={type:"literal",value:"true",description:'"true"'},bi="false",wi={type:"literal",value:"false",description:'"false"'},Ei="on",Si={type:"literal",value:"on",description:'"on"'},xi="off",Ti={type:"literal",value:"off",description:'"off"'},Ni=0,Ci=0,ki=0,Li={line:1,column:1,seenCR:!1},Ai=0,Oi=[],Mi=0,_i;if("startRule"in n){if(!(n.startRule in i))throw new Error("Can't start parsing from rule \""+n.startRule+'".');s=i[n.startRule]}_i=s();if(_i!==r&&Ni===e.length)return _i;throw _i!==r&&Ni<e.length&&qi({type:"end",description:"end of input"}),Ri(null,Oi,Ai)}return e(t,Error),{SyntaxError:t,parse:n}}),define("msgennyparser",[],function(){function e(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}function t(e,t,n,r,i,s){this.message=e,this.expected=t,this.found=n,this.offset=r,this.line=i,this.column=s,this.name="SyntaxError"}function n(e){function Qr(){return e.substring(zr,Ur)}function Gr(){return zr}function Yr(){return ni(zr).line}function Zr(){return ni(zr).column}function ei(e){throw ii(null,[{type:"other",description:e}],zr)}function ti(e){throw ii(e,null,zr)}function ni(t){function n(t,n,r){var i,s;for(i=n;i<r;i++)s=e.charAt(i),s==="\n"?(t.seenCR||t.line++,t.column=1,t.seenCR=!1):s==="\r"||s==="\u2028"||s==="\u2029"?(t.line++,t.column=1,t.seenCR=!0):(t.column++,t.seenCR=!1)}return Wr!==t&&(Wr>t&&(Wr=0,Xr={line:1,column:1,seenCR:!1}),n(Xr,Wr,t),Wr=t),Xr}function ri(e){if(Ur<Vr)return;Ur>Vr&&(Vr=Ur,$r=[]),$r.push(e)}function ii(n,r,i){function s(e){var t=1;e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});while(t<e.length)e[t-1]===e[t]?e.splice(t,1):t++}function o(e,t){function n(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0180-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1080-\uFFFF]/g,function(e){return"\\u"+t(e)})}var r=new Array(e.length),i,s,o;for(o=0;o<e.length;o++)r[o]=e[o].description;return i=e.length>1?r.slice(0,-1).join(", ")+" or "+r[e.length-1]:r[0],s=t?'"'+n(t)+'"':"end of input","Expected "+i+" but "+s+" found."}var u=ni(i),a=i<e.length?e.charAt(i):null;return r!==null&&s(r),new t(n!==null?n:o(r,a),r,a,i,u.line,u.column)}function si(){var e,t,n,i;return e=Ur,t=Vi(),t!==r?(n=oi(),n!==r?(i=Wi(),i!==r?(zr=e,t=u(t,n),e=t):(Ur=e,e=o)):(Ur=e,e=o)):(Ur=e,e=o),e}function oi(){var e,t,n,i,s;return e=Ur,t=Ur,n=ui(),n!==r&&(zr=t,n=f(n)),t=n,t===r&&(t=a),t!==r?(n=Ur,i=li(),i!==r&&(zr=n,i=l(i)),n=i,n===r&&(n=a),n!==r?(i=Ur,s=hi(),s!==r&&(zr=i,s=c(s)),i=s,i===r&&(i=a),i!==r?(t=[t,n,i],e=t):(Ur=e,e=o)):(Ur=e,e=o)):(Ur=e,e=o),e}function ui(){var t,n,i,s,u,a;t=Ur,n=Ur,i=[],s=Ur,u=ai(),u!==r?(e.charCodeAt(Ur)===44?(a=p,Ur++):(a=r,Jr===0&&ri(d)),a!==r?(zr=s,u=v(u),s=u):(Ur=s,s=o)):(Ur=s,s=o);while(s!==r)i.push(s),s=Ur,u=ai(),u!==r?(e.charCodeAt(Ur)===44?(a=p,Ur++):(a=r,Jr===0&&ri(d)),a!==r?(zr=s,u=v(u),s=u):(Ur=s,s=o)):(Ur=s,s=o);return i!==r?(s=Ur,u=ai(),u!==r?(e.charCodeAt(Ur)===59?(a=m,Ur++):(a=r,Jr===0&&ri(g)),a!==r?(zr=s,u=v(u),s=u):(Ur=s,s=o)):(Ur=s,s=o),s!==r?(i=[i,s],n=i):(Ur=n,n=o)):(Ur=n,n=o),n!==r&&(zr=t,n=y(n)),t=n,t}function ai(){var t,n,i,s,u,a,f,l;return t=Ur,n=Wi(),n!==r?(i=fi(),i!==r?(s=Wi(),s!==r?(e.charCodeAt(Ur)===61?(u=b,Ur++):(u=r,Jr===0&&ri(w)),u!==r?(a=Wi(),a!==r?(f=Ur,l=Ai(),l!==r&&(zr=f,l=E(l)),f=l,f===r&&(f=Ur,l=$i(),l!==r&&(zr=f,l=S(l)),f=l,f===r&&(f=Ur,l=Qi(),l!==r&&(zr=f,l=x(l)),f=l)),f!==r?(l=Wi(),l!==r?(zr=t,n=T(i,f),t=n):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o),t}function fi(){var t;return e.substr(Ur,6).toLowerCase()===N?(t=e.substr(Ur,6),Ur+=6):(t=r,Jr===0&&ri(C)),t===r&&(e.substr(Ur,5).toLowerCase()===k?(t=e.substr(Ur,5),Ur+=5):(t=r,Jr===0&&ri(L)),t===r&&(e.substr(Ur,11).toLowerCase()===A?(t=e.substr(Ur,11),Ur+=11):(t=r,Jr===0&&ri(O)),t===r&&(e.substr(Ur,12).toLowerCase()===M?(t=e.substr(Ur,12),Ur+=12):(t=r,Jr===0&&ri(_)),t===r&&(e.substr(Ur,9).toLowerCase()===D?(t=e.substr(Ur,9),Ur+=9):(t=r,Jr===0&&ri(P)))))),t}function li(){var t,n,i,s,u,a;t=Ur,n=Ur,i=[],s=Ur,u=ci(),u!==r?(e.charCodeAt(Ur)===44?(a=p,Ur++):(a=r,Jr===0&&ri(d)),a!==r?(zr=s,u=H(u),s=u):(Ur=s,s=o)):(Ur=s,s=o);while(s!==r)i.push(s),s=Ur,u=ci(),u!==r?(e.charCodeAt(Ur)===44?(a=p,Ur++):(a=r,Jr===0&&ri(d)),a!==r?(zr=s,u=H(u),s=u):(Ur=s,s=o)):(Ur=s,s=o);return i!==r?(s=Ur,u=ci(),u!==r?(e.charCodeAt(Ur)===59?(a=m,Ur++):(a=r,Jr===0&&ri(g)),a!==r?(zr=s,u=H(u),s=u):(Ur=s,s=o)):(Ur=s,s=o),s!==r?(i=[i,s],n=i):(Ur=n,n=o)):(Ur=n,n=o),n!==r&&(zr=t,n=B(n)),t=n,t}function ci(){var t,n,i,s,u,f,l,c,h;return Jr++,t=Ur,n=Wi(),n!==r?(i=Di(),i!==r?(s=Wi(),s!==r?(u=Ur,e.charCodeAt(Ur)===58?(f=F,Ur++):(f=r,Jr===0&&ri(I)),f!==r?(l=Wi(),l!==r?(c=Li(),c!==r?(h=Wi(),h!==r?(zr=u,f=q(c),u=f):(Ur=u,u=o)):(Ur=u,u=o)):(Ur=u,u=o)):(Ur=u,u=o),u===r&&(u=a),u!==r?(zr=t,n=R(i,u),t=n):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o),Jr--,t===r&&(n=r,Jr===0&&ri(j)),t}function hi(){var t,n,i,s,u;t=[],n=Ur,i=pi(),i!==r?(s=Wi(),s!==r?(e.charCodeAt(Ur)===59?(u=m,Ur++):(u=r,Jr===0&&ri(g)),u!==r?(zr=n,i=U(i),n=i):(Ur=n,n=o)):(Ur=n,n=o)):(Ur=n,n=o);if(n!==r)while(n!==r)t.push(n),n=Ur,i=pi(),i!==r?(s=Wi(),s!==r?(e.charCodeAt(Ur)===59?(u=m,Ur++):(u=r,Jr===0&&ri(g)),u!==r?(zr=n,i=U(i),n=i):(Ur=n,n=o)):(Ur=n,n=o)):(Ur=n,n=o);else t=o;return t}function pi(){var t,n,i,s,u,a;t=Ur,n=Ur,i=[],s=Ur,u=di(),u!==r?(e.charCodeAt(Ur)===44?(a=p,Ur++):(a=r,Jr===0&&ri(d)),a!==r?(zr=s,u=U(u),s=u):(Ur=s,s=o)):(Ur=s,s=o);while(s!==r)i.push(s),s=Ur,u=di(),u!==r?(e.charCodeAt(Ur)===44?(a=p,Ur++):(a=r,Jr===0&&ri(d)),a!==r?(zr=s,u=U(u),s=u):(Ur=s,s=o)):(Ur=s,s=o);return i!==r?(s=Ur,u=di(),u!==r&&(zr=s,u=z(u)),s=u,s!==r?(i=[i,s],n=i):(Ur=n,n=o)):(Ur=n,n=o),n!==r&&(zr=t,n=W(n)),t=n,t}function di(){var e;return e=vi(),e===r&&(e=bi()),e}function vi(){var t,n,i,s,u,f,l;return t=Ur,n=Ur,i=mi(),i!==r&&(zr=n,i=X(i)),n=i,n===r&&(n=Ur,i=yi(),i!==r&&(zr=n,i=V(i)),n=i,n===r&&(n=Ur,i=gi(),i!==r&&(zr=n,i=$(i)),n=i)),n!==r?(i=Ur,e.charCodeAt(Ur)===58?(s=F,Ur++):(s=r,Jr===0&&ri(I)),s!==r?(u=Wi(),u!==r?(f=Li(),f!==r?(l=Wi(),l!==r?(zr=i,s=E(f),i=s):(Ur=i,i=o)):(Ur=i,i=o)):(Ur=i,i=o)):(Ur=i,i=o),i===r&&(i=a),i!==r?(zr=t,n=J(n,i),t=n):(Ur=t,t=o)):(Ur=t,t=o),t}function mi(){var e,t,n,i;return e=Ur,t=Wi(),t!==r?(n=wi(),n!==r?(i=Wi(),i!==r?(zr=e,t=K(n),e=t):(Ur=e,e=o)):(Ur=e,e=o)):(Ur=e,e=o),e}function gi(){var e,t,n,i;return e=Ur,t=Wi(),t!==r?(n=Ei(),n!==r?(i=Wi(),i!==r?(zr=e,t=K(n),e=t):(Ur=e,e=o)):(Ur=e,e=o)):(Ur=e,e=o),e}function yi(){var t,n,i,s,u,a,f,l;return t=Ur,n=Wi(),n!==r?(i=Di(),i!==r?(s=Wi(),s!==r?(u=Si(),u!==r?(a=Wi(),a!==r?(f=Di(),f!==r?(l=Wi(),l!==r?(zr=t,n=Q(i,u,f),t=n):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o),t===r&&(t=Ur,n=Wi(),n!==r?(e.charCodeAt(Ur)===42?(i=G,Ur++):(i=r,Jr===0&&ri(Y)),i!==r?(s=Wi(),s!==r?(u=Ni(),u!==r?(a=Wi(),a!==r?(f=Di(),f!==r?(l=Wi(),l!==r?(zr=t,n=Z(u,f),t=n):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o),t===r&&(t=Ur,n=Wi(),n!==r?(i=Di(),i!==r?(s=Wi(),s!==r?(u=Ti(),u!==r?(a=Wi(),a!==r?(e.charCodeAt(Ur)===42?(f=G,Ur++):(f=r,Jr===0&&ri(Y)),f!==r?(l=Wi(),l!==r?(zr=t,n=et(i,u),t=n):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o))),t}function bi(){var t,n,i,s,u,f,l,c,h,p,d,v,m,g,y;return t=Ur,n=Wi(),n!==r?(i=Di(),i!==r?(s=Wi(),s!==r?(u=ki(),u!==r?(f=Wi(),f!==r?(l=Di(),l!==r?(c=Wi(),c!==r?(h=Ur,e.charCodeAt(Ur)===58?(p=F,Ur++):(p=r,Jr===0&&ri(I)),p!==r?(d=Wi(),d!==r?(v=Li(),v!==r?(m=Wi(),m!==r?(zr=h,p=E(v),h=p):(Ur=h,h=o)):(Ur=h,h=o)):(Ur=h,h=o)):(Ur=h,h=o),h===r&&(h=a),h!==r?(e.charCodeAt(Ur)===123?(p=tt,Ur++):(p=r,Jr===0&&ri(nt)),p!==r?(d=Wi(),d!==r?(v=hi(),v!==r?(m=Wi(),m!==r?(e.charCodeAt(Ur)===125?(g=rt,Ur++):(g=r,Jr===0&&ri(it)),g!==r?(y=Wi(),y!==r?(zr=t,n=st(i,u,l,h,v),t=n):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o),t}function wi(){var t;return e.substr(Ur,3)===ot?(t=ot,Ur+=3):(t=r,Jr===0&&ri(ut)),t===r&&(e.substr(Ur,3)===at?(t=at,Ur+=3):(t=r,Jr===0&&ri(ft))),t}function Ei(){var t;return e.substr(Ur,3)===lt?(t=lt,Ur+=3):(t=r,Jr===0&&ri(ct)),t}function Si(){var e,t;return e=Ur,t=xi(),t===r&&(t=Ti(),t===r&&(t=Ni(),t===r&&(t=Ci()))),t!==r&&(zr=e,t=ht(t)),e=t,e}function xi(){var t,n;return Jr++,e.substr(Ur,2)===dt?(t=dt,Ur+=2):(t=r,Jr===0&&ri(vt)),t===r&&(e.substr(Ur,3)===mt?(t=mt,Ur+=3):(t=r,Jr===0&&ri(gt)),t===r&&(e.substr(Ur,2)===yt?(t=yt,Ur+=2):(t=r,Jr===0&&ri(bt)),t===r&&(e.substr(Ur,5)===wt?(t=wt,Ur+=5):(t=r,Jr===0&&ri(Et)),t===r&&(e.substr(Ur,3)===St?(t=St,Ur+=3):(t=r,Jr===0&&ri(xt)),t===r&&(e.substr(Ur,2)===Tt?(t=Tt,Ur+=2):(t=r,Jr===0&&ri(Nt)),t===r&&(e.substr(Ur,4)===Ct?(t=Ct,Ur+=4):(t=r,Jr===0&&ri(kt)),t===r&&(e.substr(Ur,2)===Lt?(t=Lt,Ur+=2):(t=r,Jr===0&&ri(At)),t===r&&(e.substr(Ur,3)===Ot?(t=Ot,Ur+=3):(t=r,Jr===0&&ri(Mt)))))))))),Jr--,t===r&&(n=r,Jr===0&&ri(pt)),t}function Ti(){var t,n;return Jr++,e.substr(Ur,2)===Dt?(t=Dt,Ur+=2):(t=r,Jr===0&&ri(Pt)),t===r&&(e.substr(Ur,3)===Ht?(t=Ht,Ur+=3):(t=r,Jr===0&&ri(Bt)),t===r&&(e.substr(Ur,2)===jt?(t=jt,Ur+=2):(t=r,Jr===0&&ri(Ft)),t===r&&(e.substr(Ur,2)===It?(t=It,Ur+=2):(t=r,Jr===0&&ri(qt)),t===r&&(e.substr(Ur,2)===Rt?(t=Rt,Ur+=2):(t=r,Jr===0&&ri(Ut)),t===r&&(e.substr(Ur,2).toLowerCase()===zt?(t=e.substr(Ur,2),Ur+=2):(t=r,Jr===0&&ri(Wt))))))),Jr--,t===r&&(n=r,Jr===0&&ri(_t)),t}function Ni(){var t,n;return Jr++,e.substr(Ur,2)===Vt?(t=Vt,Ur+=2):(t=r,Jr===0&&ri($t)),t===r&&(e.substr(Ur,3)===Jt?(t=Jt,Ur+=3):(t=r,Jr===0&&ri(Kt)),t===r&&(e.substr(Ur,2)===Qt?(t=Qt,Ur+=2):(t=r,Jr===0&&ri(Gt)),t===r&&(e.substr(Ur,2)===Yt?(t=Yt,Ur+=2):(t=r,Jr===0&&ri(Zt)),t===r&&(e.substr(Ur,2)===en?(t=en,Ur+=2):(t=r,Jr===0&&ri(tn)),t===r&&(e.substr(Ur,2).toLowerCase()===nn?(t=e.substr(Ur,2),Ur+=2):(t=r,Jr===0&&ri(rn))))))),Jr--,t===r&&(n=r,Jr===0&&ri(Xt)),t}function Ci(){var t,n;return Jr++,e.substr(Ur,4).toLowerCase()===on?(t=e.substr(Ur,4),Ur+=4):(t=r,Jr===0&&ri(un)),t===r&&(e.substr(Ur,4).toLowerCase()===an?(t=e.substr(Ur,4),Ur+=4):(t=r,Jr===0&&ri(fn)),t===r&&(e.substr(Ur,4).toLowerCase()===ln?(t=e.substr(Ur,4),Ur+=4):(t=r,Jr===0&&ri(cn)),t===r&&(e.substr(Ur,3).toLowerCase()===hn?(t=e.substr(Ur,3),Ur+=3):(t=r,Jr===0&&ri(pn))))),Jr--,t===r&&(n=r,Jr===0&&ri(sn)),t}function ki(){var t,n;return Jr++,t=Ur,e.substr(Ur,3).toLowerCase()===vn?(n=e.substr(Ur,3),Ur+=3):(n=r,Jr===0&&ri(mn)),n===r&&(e.substr(Ur,4).toLowerCase()===gn?(n=e.substr(Ur,4),Ur+=4):(n=r,Jr===0&&ri(yn)),n===r&&(e.substr(Ur,3).toLowerCase()===bn?(n=e.substr(Ur,3),Ur+=3):(n=r,Jr===0&&ri(wn)),n===r&&(e.substr(Ur,5).toLowerCase()===En?(n=e.substr(Ur,5),Ur+=5):(n=r,Jr===0&&ri(Sn)),n===r&&(e.substr(Ur,3).toLowerCase()===xn?(n=e.substr(Ur,3),Ur+=3):(n=r,Jr===0&&ri(Tn)),n===r&&(e.substr(Ur,3).toLowerCase()===Nn?(n=e.substr(Ur,3),Ur+=3):(n=r,Jr===0&&ri(Cn)),n===r&&(e.substr(Ur,6).toLowerCase()===kn?(n=e.substr(Ur,6),Ur+=6):(n=r,Jr===0&&ri(Ln)),n===r&&(e.substr(Ur,3).toLowerCase()===An?(n=e.substr(Ur,3),Ur+=3):(n=r,Jr===0&&ri(On)),n===r&&(e.substr(Ur,8).toLowerCase()===Mn?(n=e.substr(Ur,8),Ur+=8):(n=r,Jr===0&&ri(_n)),n===r&&(e.substr(Ur,6).toLowerCase()===Dn?(n=e.substr(Ur,6),Ur+=6):(n=r,Jr===0&&ri(Pn)),n===r&&(e.substr(Ur,8).toLowerCase()===Hn?(n=e.substr(Ur,8),Ur+=8):(n=r,Jr===0&&ri(Bn)),n===r&&(e.substr(Ur,6).toLowerCase()===jn?(n=e.substr(Ur,6),Ur+=6):(n=r,Jr===0&&ri(Fn)),n===r&&(e.substr(Ur,4).toLowerCase()===In?(n=e.substr(Ur,4),Ur+=4):(n=r,Jr===0&&ri(qn)),n===r&&(e.substr(Ur,3).toLowerCase()===Rn?(n=e.substr(Ur,3),Ur+=3):(n=r,Jr===0&&ri(Un)),n===r&&(e.substr(Ur,3).toLowerCase()===zn?(n=e.substr(Ur,3),Ur+=3):(n=r,Jr===0&&ri(Wn)))))))))))))))),n!==r&&(zr=t,n=ht(n)),t=n,Jr--,t===r&&(n=r,Jr===0&&ri(dn)),t}function Li(){var e;return e=Ai(),e===r&&(e=Mi()),e}function Ai(){var t,n,i,s;return t=Ur,e.charCodeAt(Ur)===34?(n=Xn,Ur++):(n=r,Jr===0&&ri(Vn)),n!==r?(i=Oi(),i!==r?(e.charCodeAt(Ur)===34?(s=Xn,Ur++):(s=r,Jr===0&&ri(Vn)),s!==r?(zr=t,n=$n(i),t=n):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o),t}function Oi(){var t,n,i,s;t=[],n=Ur,i=Ur,Jr++,e.charCodeAt(Ur)===34?(s=Xn,Ur++):(s=r,Jr===0&&ri(Vn)),Jr--,s===r?i=Jn:(Ur=i,i=o),i!==r?(e.substr(Ur,2)===Kn?(s=Kn,Ur+=2):(s=r,Jr===0&&ri(Qn)),s===r&&(e.length>Ur?(s=e.charAt(Ur),Ur++):(s=r,Jr===0&&ri(Gn))),s!==r?(zr=n,i=Yn(s),n=i):(Ur=n,n=o)):(Ur=n,n=o);while(n!==r)t.push(n),n=Ur,i=Ur,Jr++,e.charCodeAt(Ur)===34?(s=Xn,Ur++):(s=r,Jr===0&&ri(Vn)),Jr--,s===r?i=Jn:(Ur=i,i=o),i!==r?(e.substr(Ur,2)===Kn?(s=Kn,Ur+=2):(s=r,Jr===0&&ri(Qn)),s===r&&(e.length>Ur?(s=e.charAt(Ur),Ur++):(s=r,Jr===0&&ri(Gn))),s!==r?(zr=n,i=Yn(s),n=i):(Ur=n,n=o)):(Ur=n,n=o);return t}function Mi(){var e,t;return e=Ur,t=_i(),t!==r&&(zr=e,t=Zn(t)),e=t,e}function _i(){var t,n,i,s;t=[],n=Ur,i=Ur,Jr++,e.charCodeAt(Ur)===44?(s=p,Ur++):(s=r,Jr===0&&ri(d)),s===r&&(e.charCodeAt(Ur)===59?(s=m,Ur++):(s=r,Jr===0&&ri(g)),s===r&&(e.charCodeAt(Ur)===123?(s=tt,Ur++):(s=r,Jr===0&&ri(nt)))),Jr--,s===r?i=Jn:(Ur=i,i=o),i!==r?(e.length>Ur?(s=e.charAt(Ur),Ur++):(s=r,Jr===0&&ri(Gn)),s!==r?(zr=n,i=Yn(s),n=i):(Ur=n,n=o)):(Ur=n,n=o);while(n!==r)t.push(n),n=Ur,i=Ur,Jr++,e.charCodeAt(Ur)===44?(s=p,Ur++):(s=r,Jr===0&&ri(d)),s===r&&(e.charCodeAt(Ur)===59?(s=m,Ur++):(s=r,Jr===0&&ri(g)),s===r&&(e.charCodeAt(Ur)===123?(s=tt,Ur++):(s=r,Jr===0&&ri(nt)))),Jr--,s===r?i=Jn:(Ur=i,i=o),i!==r?(e.length>Ur?(s=e.charAt(Ur),Ur++):(s=r,Jr===0&&ri(Gn)),s!==r?(zr=n,i=Yn(s),n=i):(Ur=n,n=o)):(Ur=n,n=o);return t}function Di(){var t,n,i;Jr++,t=Ur,n=[],tr.test(e.charAt(Ur))?(i=e.charAt(Ur),Ur++):(i=r,Jr===0&&ri(nr));if(i!==r)while(i!==r)n.push(i),tr.test(e.charAt(Ur))?(i=e.charAt(Ur),Ur++):(i=r,Jr===0&&ri(nr));else n=o;return n!==r&&(zr=t,n=rr(n)),t=n,t===r&&(t=Ai()),Jr--,t===r&&(n=r,Jr===0&&ri(er)),t}function Pi(){var t,n;return Jr++,t=Ur,sr.test(e.charAt(Ur))?(n=e.charAt(Ur),Ur++):(n=r,Jr===0&&ri(or)),n!==r&&(zr=t,n=ur()),t=n,Jr--,t===r&&(n=r,Jr===0&&ri(ir)),t}function Hi(){var t,n;return Jr++,t=Ur,fr.test(e.charAt(Ur))?(n=e.charAt(Ur),Ur++):(n=r,Jr===0&&ri(lr)),n!==r&&(zr=t,n=cr()),t=n,Jr--,t===r&&(n=r,Jr===0&&ri(ar)),t}function Bi(){var t;return e.substr(Ur,2)===hr?(t=hr,Ur+=2):(t=r,Jr===0&&ri(pr)),t}function ji(){var t;return e.substr(Ur,2)===dr?(t=dr,Ur+=2):(t=r,Jr===0&&ri(vr)),t}function Fi(){var t,n,i;return t=Ur,n=Ur,Jr++,e.substr(Ur,2)===dr?(i=dr,Ur+=2):(i=r,Jr===0&&ri(vr)),Jr--,i===r?n=Jn:(Ur=n,n=o),n!==r?(e.length>Ur?(i=e.charAt(Ur),Ur++):(i=r,Jr===0&&ri(Gn)),i!==r?(zr=t,n=Yn(i),t=n):(Ur=t,t=o)):(Ur=t,t=o),t}function Ii(){var e,t,n,i;e=Ur,t=Bi();if(t!==r){n=[],i=Fi();while(i!==r)n.push(i),i=Fi();n!==r?(i=ji(),i!==r?(zr=e,t=mr(t,n,i),e=t):(Ur=e,e=o)):(Ur=e,e=o)}else Ur=e,e=o;return e}function qi(){var t;return e.substr(Ur,2)===gr?(t=gr,Ur+=2):(t=r,Jr===0&&ri(yr)),t===r&&(e.charCodeAt(Ur)===35?(t=br,Ur++):(t=r,Jr===0&&ri(wr))),t}function Ri(){var t;return Er.test(e.charAt(Ur))?(t=e.charAt(Ur),Ur++):(t=r,Jr===0&&ri(Sr)),t}function Ui(){var e,t,n,i;e=Ur,t=qi();if(t!==r){n=[],i=Ri();while(i!==r)n.push(i),i=Ri();n!==r?(zr=e,t=xr(t,n),e=t):(Ur=e,e=o)}else Ur=e,e=o;return e}function zi(){var e,t;return Jr++,e=Ui(),e===r&&(e=Ii()),Jr--,e===r&&(t=r,Jr===0&&ri(Tr)),e}function Wi(){var e,t,n;e=[],t=[],n=Pi();if(n!==r)while(n!==r)t.push(n),n=Pi();else t=o;if(t===r){t=[],n=Hi();if(n!==r)while(n!==r)t.push(n),n=Hi();else t=o;t===r&&(t=zi())}while(t!==r){e.push(t),t=[],n=Pi();if(n!==r)while(n!==r)t.push(n),n=Pi();else t=o;if(t===r){t=[],n=Hi();if(n!==r)while(n!==r)t.push(n),n=Hi();else t=o;t===r&&(t=zi())}}return e}function Xi(){var e,t,n;e=[],t=[],n=Pi();if(n!==r)while(n!==r)t.push(n),n=Pi();else t=o;if(t===r){t=[],n=Hi();if(n!==r)while(n!==r)t.push(n),n=Hi();else t=o}while(t!==r){e.push(t),t=[],n=Pi();if(n!==r)while(n!==r)t.push(n),n=Pi();else t=o;if(t===r){t=[],n=Hi();if(n!==r)while(n!==r)t.push(n),n=Hi();else t=o}}return e}function Vi(){var e,t,n,i,s;e=[],t=Ur,n=Xi(),n!==r?(i=zi(),i!==r?(s=Xi(),s!==r?(zr=t,n=Yn(i),t=n):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o);while(t!==r)e.push(t),t=Ur,n=Xi(),n!==r?(i=zi(),i!==r?(s=Xi(),s!==r?(zr=t,n=Yn(i),t=n):(Ur=t,t=o)):(Ur=t,t=o)):(Ur=t,t=o);return e}function $i(){var e;return e=Ki(),e===r&&(e=Ji()),e}function Ji(){var t,n,i;Jr++,t=Ur,n=[],Cr.test(e.charAt(Ur))?(i=e.charAt(Ur),Ur++):(i=r,Jr===0&&ri(kr));if(i!==r)while(i!==r)n.push(i),Cr.test(e.charAt(Ur))?(i=e.charAt(Ur),Ur++):(i=r,Jr===0&&ri(kr));else n=o;return n!==r&&(zr=t,n=Lr(n)),t=n,Jr--,t===r&&(n=r,Jr===0&&ri(Nr)),t}function Ki(){var t,n,i,s,u,a;Jr++,t=Ur,n=Ur,i=[],Cr.test(e.charAt(Ur))?(s=e.charAt(Ur),Ur++):(s=r,Jr===0&&ri(kr));if(s!==r)while(s!==r)i.push(s),Cr.test(e.charAt(Ur))?(s=e.charAt(Ur),Ur++):(s=r,Jr===0&&ri(kr));else i=o;if(i!==r){e.charCodeAt(Ur)===46?(s=Or,Ur++):(s=r,Jr===0&&ri(Mr));if(s!==r){u=[],Cr.test(e.charAt(Ur))?(a=e.charAt(Ur),Ur++):(a=r,Jr===0&&ri(kr));if(a!==r)while(a!==r)u.push(a),Cr.test(e.charAt(Ur))?(a=e.charAt(Ur),Ur++):(a=r,Jr===0&&ri(kr));else u=o;u!==r?(i=[i,s,u],n=i):(Ur=n,n=o)}else Ur=n,n=o}else Ur=n,n=o;return n!==r&&(zr=t,n=_r(n)),t=n,Jr--,t===r&&(n=r,Jr===0&&ri(Ar)),t}function Qi(){var t,n;return Jr++,e.substr(Ur,4).toLowerCase()===Pr?(t=e.substr(Ur,4),Ur+=4):(t=r,Jr===0&&ri(Hr)),t===r&&(e.substr(Ur,5).toLowerCase()===Br?(t=e.substr(Ur,5),Ur+=5):(t=r,Jr===0&&ri(jr)),t===r&&(e.substr(Ur,2).toLowerCase()===Fr?(t=e.substr(Ur,2),Ur+=2):(t=r,Jr===0&&ri(Ir)),t===r&&(e.substr(Ur,3).toLowerCase()===qr?(t=e.substr(Ur,3),Ur+=3):(t=r,Jr===0&&ri(Rr))))),Jr--,t===r&&(n=r,Jr===0&&ri(Dr)),t}function Gi(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n}function Yi(e){var t="false";switch(e.toLowerCase()){case"true":case"on":case"1":t="true"}return t}function Zi(e,t,n){var r=0;if(t===undefined||t==="*")return!0;if(e&&e.entities&&t)for(r=0;r<e.entities.length;r++)if(e.entities[r].name===t)return!0;return n?n[t]===!0:!1}function es(e){var t={};return t.name=e,t}function ts(e,t,n){var r=0,i=0,s={};e?s=e:s.entities=[],n||(n={});if(t&&t.arcs)for(r=0;r<t.arcs.length;r++)for(i=0;i<t.arcs[r].length;i++)Zi(s,t.arcs[r][i].from,n)||(s.entities[s.entities.length]=es(t.arcs[r][i].from)),t.arcs[r][i].arcs&&(n[t.arcs[r][i].to]=!0,Gi(s,ts(s,t.arcs[r][i],n)),delete n[t.arcs[r][i].to]),Zi(s,t.arcs[r][i].to,n)||(s.entities[s.entities.length]=es(t.arcs[r][i].to));return s}var n=arguments.length>1?arguments[1]:{},r={},i={program:si},s=si,o=r,u=function(e,t){t[1]=ts(t[1],t[2]);var n=Gi(t[0],Gi(t[1],t[2]));return e.length>0&&(n=Gi({precomment:e},n)),n},a=null,f=function(e){return{options:e}},l=function(e){return{entities:e}},c=function(e){return{arcs:e}},h=[],p=",",d={type:"literal",value:",",description:'","'},v=function(e){return e},m=";",g={type:"literal",value:";",description:'";"'},y=function(e){var t={},n,r;for(n in e[0])for(r in e[0][n])t[r]=e[0][n][r];return t=Gi(t,e[1]),t},b="=",w={type:"literal",value:"=",description:'"="'},E=function(e){return e},S=function(e){return e.toString()},x=function(e){return e.toString()},T=function(e,t){var n={};return e=e.toLowerCase(),e==="wordwraparcs"?n[e]=Yi(t):n[e]=t,n},N="hscale",C={type:"literal",value:"hscale",description:'"hscale"'},k="width",L={type:"literal",value:"width",description:'"width"'},A="arcgradient",O={type:"literal",value:"arcgradient",description:'"arcgradient"'},M="wordwraparcs",_={type:"literal",value:"wordwraparcs",description:'"wordwraparcs"'},D="watermark",P={type:"literal",value:"watermark",description:'"watermark"'},H=function(e){return e},B=function(e){return e[0].push(e[1]),e[0]},j={type:"other",description:"entity"},F=":",I={type:"literal",value:":",description:'":"'},q=function(e){return e},R=function(e,t){var n={};return n.name=e,t&&(n.label=t),n},U=function(e){return e},z=function(e){return[e]},W=function(e){return e[0].push(e[1][0]),e[0]},X=function(e){return e},V=function(e){return e},$=function(e){return e},J=function(e,t){return t&&(e.label=t),e},K=function(e){return{kind:e}},Q=function(e,t,n){return{kind:t,from:e,to:n}},G="*",Y={type:"literal",value:"*",description:'"*"'},Z=function(e,t){return{kind:e,from:"*",to:t}},et=function(e,t){return{kind:t,from:e,to:"*"}},tt="{",nt={type:"literal",value:"{",description:'"{"'},rt="}",it={type:"literal",value:"}",description:'"}"'},st=function(e,t,n,r,i){var s={kind:t,from:e,to:n,arcs:i};return r&&(s.label=r),s},ot="|||",ut={type:"literal",value:"|||",description:'"|||"'},at="...",ft={type:"literal",value:"...",description:'"..."'},lt="---",ct={type:"literal",value:"---",description:'"---"'},ht=function(e){return e.toLowerCase()},pt={type:"other",description:"bi-directional arrow"},dt="--",vt={type:"literal",value:"--",description:'"--"'},mt="<->",gt={type:"literal",value:"<->",description:'"<->"'},yt="==",bt={type:"literal",value:"==",description:'"=="'},wt="<<=>>",Et={type:"literal",value:"<<=>>",description:'"<<=>>"'},St="<=>",xt={type:"literal",value:"<=>",description:'"<=>"'},Tt="..",Nt={type:"literal",value:"..",description:'".."'},Ct="<<>>",kt={type:"literal",value:"<<>>",description:'"<<>>"'},Lt="::",At={type:"literal",value:"::",description:'"::"'},Ot="<:>",Mt={type:"literal",value:"<:>",description:'"<:>"'},_t={type:"other",description:"left to right arrow"},Dt="->",Pt={type:"literal",value:"->",description:'"->"'},Ht="=>>",Bt={type:"literal",value:"=>>",description:'"=>>"'},jt="=>",Ft={type:"literal",value:"=>",description:'"=>"'},It=">>",qt={type:"literal",value:">>",description:'">>"'},Rt=":>",Ut={type:"literal",value:":>",description:'":>"'},zt="-x",Wt={type:"literal",value:"-x",description:'"-x"'},Xt={type:"other",description:"right to left arrow"},Vt="<-",$t={type:"literal",value:"<-",description:'"<-"'},Jt="<<=",Kt={type:"literal",value:"<<=",description:'"<<="'},Qt="<=",Gt={type:"literal",value:"<=",description:'"<="'},Yt="<<",Zt={type:"literal",value:"<<",description:'"<<"'},en="<:",tn={type:"literal",value:"<:",description:'"<:"'},nn="x-",rn={type:"literal",value:"x-",description:'"x-"'},sn={type:"other",description:"box"},on="note",un={type:"literal",value:"note",description:'"note"'},an="abox",fn={type:"literal",value:"abox",description:'"abox"'},ln="rbox",cn={type:"literal",value:"rbox",description:'"rbox"'},hn="box",pn={type:"literal",value:"box",description:'"box"'},dn={type:"other",description:"arc spanning box"},vn="alt",mn={type:"literal",value:"alt",description:'"alt"'},gn="else",yn={type:"literal",value:"else",description:'"else"'},bn="opt",wn={type:"literal",value:"opt",description:'"opt"'},En="break",Sn={type:"literal",value:"break",description:'"break"'},xn="par",Tn={type:"literal",value:"par",description:'"par"'},Nn="seq",Cn={type:"literal",value:"seq",description:'"seq"'},kn="strict",Ln={type:"literal",value:"strict",description:'"strict"'},An="neg",On={type:"literal",value:"neg",description:'"neg"'},Mn="critical",_n={type:"literal",value:"critical",description:'"critical"'},Dn="ignore",Pn={type:"literal",value:"ignore",description:'"ignore"'},Hn="consider",Bn={type:"literal",value:"consider",description:'"consider"'},jn="assert",Fn={type:"literal",value:"assert",description:'"assert"'},In="loop",qn={type:"literal",value:"loop",description:'"loop"'},Rn="ref",Un={type:"literal",value:"ref",description:'"ref"'},zn="exc",Wn={type:"literal",value:"exc",description:'"exc"'},Xn='"',Vn={type:"literal",value:'"',description:'"\\""'},$n=function(e){return e.join("")},Jn=void 0,Kn='\\"',Qn={type:"literal",value:'\\"',description:'"\\\\\\""'},Gn={type:"any",description:"any character"},Yn=function(e){return e},Zn=function(e){return e.join("").trim()},er={type:"other",description:"identifier"},tr=/^[A-Za-z_0-9]/,nr={type:"class",value:"[A-Za-z_0-9]",description:"[A-Za-z_0-9]"},rr=function(e){return e.join("")},ir={type:"other",description:"whitespace"},sr=/^[ \t]/,or={type:"class",value:"[ \\t]",description:"[ \\t]"},ur=function(){return""},ar={type:"other",description:"lineend"},fr=/^[\r\n]/,lr={type:"class",value:"[\\r\\n]",description:"[\\r\\n]"},cr=function(){return{}},hr="/*",pr={type:"literal",value:"/*",description:'"/*"'},dr="*/",vr={type:"literal",value:"*/",description:'"*/"'},mr=function(e,t,n){return e+t.join("")+n},gr="//",yr={type:"literal",value:"//",description:'"//"'},br="#",wr={type:"literal",value:"#",description:'"#"'},Er=/^[^\r\n]/,Sr={type:"class",value:"[^\\r\\n]",description:"[^\\r\\n]"},xr=function(e,t){return e+t.join("")},Tr={type:"other",description:"comment"},Nr={type:"other",description:"integer"},Cr=/^[0-9]/,kr={type:"class",value:"[0-9]",description:"[0-9]"},Lr=function(e){return parseInt(e.join(""),10)},Ar={type:"other",description:"real"},Or=".",Mr={type:"literal",value:".",description:'"."'},_r=function(e){return parseFloat(e.join(""))},Dr={type:"other",description:"boolean"},Pr="true",Hr={type:"literal",value:"true",description:'"true"'},Br="false",jr={type:"literal",value:"false",description:'"false"'},Fr="on",Ir={type:"literal",value:"on",description:'"on"'},qr="off",Rr={type:"literal",value:"off",description:'"off"'},Ur=0,zr=0,Wr=0,Xr={line:1,column:1,seenCR:!1},Vr=0,$r=[],Jr=0,Kr;if("startRule"in n){if(!(n.startRule in i))throw new Error("Can't start parsing from rule \""+n.startRule+'".');s=i[n.startRule]}Kr=s();if(Kr!==r&&Ur===e.length)return Kr;throw Kr!==r&&Ur<e.length&&ri({type:"end",description:"end of input"}),ii(null,$r,Vr)}return e(t,Error),{SyntaxError:t,parse:n}}),define("renderutensils",[],function(){function s(e){var t={height:15,width:15,x:2,y:2};if(typeof e.getBBox=="function"){var r=document.getElementsByTagName("svg")[0];r.appendChild(e),t=e.getBBox(),r.removeChild(e);if(t.height>n||t.width>n||t.height<0-n||t.width<0-n)t={height:0,width:0,x:0,y:0}}return t}function o(t,n){var i=r.createElementNS(e,"path");return i.setAttribute("d",t),n&&i.setAttribute("class",n),i}function u(t,n){var i=r.createElementNS(e,"polygon");return i.setAttribute("points",t),n&&i.setAttribute("class",n),i}function a(t,n,i,s,o,u,a){var f=r.createElementNS(e,"rect");return f.setAttribute("width",t),f.setAttribute("height",n),s&&f.setAttribute("x",s),o&&f.setAttribute("y",o),u&&f.setAttribute("rx",u),a&&f.setAttribute("ry",a),i&&f.setAttribute("class",i),f}function f(e,t,n,r,i){var s=3,u="M"+r+","+i;return u+="l"+s+", -"+t/2,u+="l"+(e-2*s)+",0",u+="l"+s+","+t/2,u+="l-"+s+","+t/2,u+="l-"+(e-2*s)+",0 ",u+="l-"+s+",-"+t/2,o(u,n)}function l(e,t,n,r,i,s){var u=s?s:9,a=u.toString(10),f="M"+r+","+i;return f+="l"+(e-u)+",0 ",f+="l0,"+a+" l"+a+",0 m-"+a+",-"+a+" l"+a+","+a+" ",f+="l0,"+(t-u)+" ",f+="l-"+e+",0 ",f+="l0,-"+t+" ",o(f,n)}function c(e,t,n,r,i,s){var u=s?s:7,a="M"+r+","+i;return a+=" l"+e+",0 ",a+=" l0,"+(t-u),a+=" l-"+u.toString(10)+","+u.toString(10),a+=" l-"+(e-u)+",0 ",a+="H",o(a,n)}function h(n,s,o,u,a,f,l){var c=r.createElementNS(e,"text"),h=r.createElementNS(e,"tspan"),p=r.createElementNS(e,"tspan"),d=r.createTextNode(n);c.setAttribute("x",s.toString()),c.setAttribute("y",o.toString()),u&&c.setAttribute("class",u),h.appendChild(d);if(a){var v=r.createElementNS(e,"a");v.setAttributeNS(t,"xlink:href",a),v.setAttributeNS(t,"xlink:title",a),v.setAttributeNS(t,"xlink:show","new"),v.appendChild(h),c.appendChild(v)}else c.appendChild(h);if(f){p.appendChild(r.createTextNode(" ["+f+"]")),p.setAttribute("style",i);if(l){var m=r.createElementNS(e,"a");m.setAttributeNS(t,"xlink:href",l),m.setAttributeNS(t,"xlink:title",l),m.setAttributeNS(t,"xlink:show","new"),m.appendChild(p),c.appendChild(m)}else c.appendChild(p)}return c}function p(t,n,i,s,o){var u=r.createElementNS(e,"line");return u.setAttribute("x1",t.toString()),u.setAttribute("y1",n.toString()),u.setAttribute("x2",i.toString()),u.setAttribute("y2",s.toString()),o&&u.setAttribute("class",o),u}function d(e,t,n,r,i){var s=2,u="M"+e.toString()+","+t.toString(),a=n>e?a=1:a=-1,f=a*(r-t)/(n-e),l=n-e,c=r-t;return u+="l"+a.toString()+","+f.toString(),u+="M"+e.toString()+","+(t-s).toString(),u+=" l"+l.toString()+","+c.toString(),u+="M"+e.toString()+","+(t+s).toString(),u+=" l"+l.toString()+","+c.toString(),u+="M"+(n-a).toString()+","+r.toString(),u+="l"+a.toString()+","+f.toString(),o(u,i)}function v(e,t,n,r,i,s){return s?d(e,t,n,r,i):p(e,t,n,r,i)}function m(e){var t={"->":{pathEnd:"M 9 3 l -8 2",linestyle:"stroke: inherit",headclass:"arrow-style inherit"},"<->":{pathEnd:"M 9 3 l -8 2",pathStart:"M 9 3 l 8 2",linestyle:"stroke: inherit",headclass:"arrow-style inherit"},"=>":{pathEnd:"M 1,1 9,3 1,5 z",linestyle:"stroke: inherit",headclass:"filled arrow-style inherit inherit-fill"},"<=>":{pathEnd:"M 1,1 9,3 1,5 z",pathStart:"M 17,1 9,3 17,5 z",linestyle:"stroke: inherit",headclass:"filled arrow-style inherit inherit-fill"},"=>>":{pathEnd:"M 1 1 l 8 2 l -8 2",linestyle:"stroke: inherit",headclass:"arrow-style inherit"},"<<=>>":{pathEnd:"M 1 1 l 8 2 l -8 2",pathStart:"M 17 1 l -8 2 l 8 2",linestyle:"stroke: inherit;",headclass:"arrow-style inherit"},">>":{pathEnd:"M 1 1 l 8 2 l -8 2",linestyle:"stroke-dasharray: 5,2; stroke: inherit;",headclass:"arrow-style inherit"},"<<>>":{pathEnd:"M 1 1 l 8 2 l -8 2",pathStart:"M 17 1 l -8 2 l 8 2",linestyle:"stroke-dasharray: 5,2; stroke: inherit;",headclass:"arrow-style inherit"},"..":{linestyle:"stroke-dasharray: 5,2; stroke: inherit;",headclass:"arrow-style inherit"},":>":{pathEnd:"M 1,1 9,3 1,5 z",linestyle:"stroke: inherit",headclass:"filled arrow-style inherit inherit-fill"},"<:>":{pathEnd:"M 1,1 9,3 1,5 z",pathStart:"M 17,1 9,3 17,5 z",linestyle:"stroke: inherit",headclass:"filled arrow-style inherit inherit-fill"},"-x":{pathEnd:"M6.5,-0.5 L11.5,5.5 M6.5,5.5 L11.5,-0.5",linestyle:"stroke: inherit",headclass:"arrow-style inherit"}},n=t[e];return n===undefined?{linestyle:"stroke: inherit;",headclass:"arrow-style inherit"}:n}function g(e,t,n,r,i,s){var o=v(t,n,r,i,undefined,s.indexOf(":")>-1),u=m(s),a=b(e);return u.pathEnd&&(u.headclass?a.appendChild(S(e+"_end","arrow-marker","auto",u.pathEnd,u.headclass)):a.appendChild(S(e+"_end","arrow-marker","auto",u.pathEnd,"arrow-style")),o.setAttribute("marker-end","url(#"+e+"_end"+")")),u.pathStart&&(u.headclass?a.appendChild(S(e+"_start","arrow-marker","auto",u.pathStart,u.headclass)):a.appendChild(S(e+"_start","arrow-marker","auto",u.pathStart,"arrow-style")),o.setAttribute("marker-start","url(#"+e+"_start"+")")),u.linestyle&&o.setAttribute("style",u.linestyle),a.appendChild(o),a}function y(e,t,n,r,i){var s="M"+e.toString()+", -"+t.toString();return s+=" l"+r.toString()+",0",s+=" l0,"+n.toString(),s+=" l-"+r.toString()+",0",o(s,i)}function b(t){var n=r.createElementNS(e,"g");return n.setAttribute("id",t),n}function w(n,i,s){var o=r.createElementNS(e,"use");return o.setAttribute("x",n.toString()),o.setAttribute("y",i.toString()),o.setAttributeNS(t,"xlink:href","#"+s),o}function E(t,n,i){var s=r.createElementNS(e,"marker");return s.setAttribute("orient",i),s.setAttribute("id",t),s.setAttribute("class",n),s.setAttribute("viewBox","0 0 10 10"),s.setAttribute("refX","9"),s.setAttribute("refY","3"),s.setAttribute("markerUnits","strokeWidth"),s.setAttribute("markerWidth","10"),s.setAttribute("markerHeight","10"),s.setAttribute("refX","9"),s.setAttribute("refX","9"),s}function S(e,t,n,r,i){var s=E(e,t,n),u=o(r,i);return s.appendChild(u),s}function x(e,t,n,r,i){var s=E(e,t,n),o=u(r,i);return s.appendChild(o),s}var e="http://www.w3.org/2000/svg",t="http://www.w3.org/1999/xlink",n=1e5,r,i="vertical-align : text-top;";return i+="font-size: 0.7em; text-anchor: start;",{init:function(e){r=e},createPath:function(e,t){return o(e,t)},createRect:function(e,t,n,r,i,s,o){return a(e,t,n,r,i,s,o)},createABox:function(e,t,n,r,i){return f(e,t,n,r,i)},createNote:function(e,t,n,r,i,s){return l(e,t,n,r,i,s)},createEdgeRemark:function(e,t,n,r,i,s){return c(e,t,n,r,i,s)},createText:function(e,t,n,r,i,s,o){return h(e,t,n,r,i,s,o)},createLine:function(e,t,n,r,i,s){return v(e,t,n,r,i,s)},createArrow:function(e,t,n,r,i,s){return g(e,t,n,r,i,s)},createUTurn:function(e,t,n,r,i){return y(e,t,n,r,i)},createGroup:function(e){return b(e)},createUse:function(e,t,n){return w(e,t,n)},createMarkerPath:function(e,t,n,r,i){return S(e,t,n,r,i)},createMarkerPolygon:function(e,t,n,r,i){return x(e,t,n,r,i)},getBBox:function(e){return s(e)},SVGNS:e,XLINKNS:t}}),define("renderskeleton",["./renderutensils"],function(e){function r(t){var n=t;return n.appendChild(e.createMarkerPath("signal","arrow-marker","auto","M 9 3 l -8 2","arrow-style")),n.appendChild(e.createMarkerPath("signal-u","arrow-marker","auto","M 9 3 l -8 -2","arrow-style")),n.appendChild(e.createMarkerPath("signal-l","arrow-marker","auto","M 9 3 l 8 2","arrow-style")),n.appendChild(e.createMarkerPath("signal-lu","arrow-marker","auto","M 9 3 l 8 -2","arrow-style")),n.appendChild(e.createMarkerPolygon("method","arrow-marker","auto","1,1 9,3 1,5","filled arrow-style")),n.appendChild(e.createMarkerPolygon("method-l","arrow-marker","auto","17,1 9,3 17,5","filled arrow-style")),n.appendChild(e.createMarkerPath("callback","arrow-marker","auto","M 1 1 l 8 2 l -8 2","arrow-style")),n.appendChild(e.createMarkerPath("callback-l","arrow-marker","auto","M 17 1 l -8 2 l 8 2","arrow-style")),n.appendChild(e.createMarkerPath("lost","arrow-marker","auto","M6.5,-0.5 L11.5,5.5 M6.5,5.5 L11.5,-0.5","arrow-style")),n}function i(){var e=t.createElement("style");return e.setAttribute("type","text/css"),e.appendChild(t.createTextNode(c)),e}function s(n){var r=t.createElementNS(e.SVGNS,"svg");return r.setAttribute("version","1.1"),r.setAttribute("id",n),r.setAttribute("xmlns",e.SVGNS),r.setAttribute("xmlns:xlink",e.XLINKNS),r}function o(){var s=t.createElementNS(e.SVGNS,"defs");return s.appendChild(i(t)),s=r(s),s.appendChild(e.createGroup(n+"__defs")),s}function u(){var r=t.createElementNS(e.SVGNS,"desc");return r.setAttribute("id",n+"__msc_source"),r}function a(){var t=e.createGroup(n+"__body");return t.appendChild(e.createGroup(n+"__background")),t.appendChild(e.createGroup(n+"__arcspanlayer")),t.appendChild(e.createGroup(n+"__lifelinelayer")),t.appendChild(e.createGroup(n+"__sequencelayer")),t.appendChild(e.createGroup(n+"__notelayer")),t.appendChild(e.createGroup(n+"__watermark")),t}function f(t){var n;return"object"!=typeof document?n=t.document:n=window.document,e.init(n),n}function l(e,r,i){t=f(i),n=r;var l=t.getElementById(e);l===null&&(l=t.body);var c=s(r);c.appendChild(u()),c.appendChild(o()),c.appendChild(a()),l.appendChild(c)}var t,n="mscgen_js$svg$",c="svg {     font-family: Helvetica, sans-serif;     font-size: 9pt;     background-color: white;     stroke : black;     color  : black; } rect {     fill: none;     stroke: black;     stroke-width: 2; } .bglayer {     fill:white;     stroke: white;     stroke-width: 0; } rect.textbg {     fill:white;     stroke:white;     stroke-width:0;     opacity: 0.9; } line {     stroke: black;     stroke-width: 2; } .arcrowomit {     stroke-dasharray: 2,2; } text {     color: inherit;     stroke: none;     text-anchor: middle; } text.entity {     text-decoration : underline; } text.anchor-start {     text-anchor: start; }path {     stroke: black;     color: black;     stroke-width: 2;     fill: none; } .dotted {    stroke-dasharray: 5,2; } .striped {     stroke-dasharray: 10,5; } .arrow-marker {     overflow:visible; } .arrow-style {     stroke : black;     stroke-dasharray : 100,1; /* 'none' should work, but doesn't in webkit */     stroke-width : 1; } .filled {     stroke:inherit;     fill:black; /* no-inherit */ } .arcrowomit {     stroke-dasharray: 2,2; } .box {     /* fill: #ffc;  no-inherit */     fill : white;     opacity: 0.9; } .boxtext, .arctext {     font-size: 0.8em;     text-anchor: middle; } .comment {     stroke-dasharray: 5,2; } .signal {     marker-end : url(#signal); } .signal-u {     marker-end : url(#signal-u); } .signal-both {     marker-end : url(#signal);     marker-start : url(#signal-l); } .signal-both-u {     marker-end : url(#signal-u);     marker-start : url(#signal-lu); } .signal-both-self {     marker-end : url(#signal-u);     marker-start : url(#signal-l); } .method {     marker-end : url(#method); } .method-both {     marker-end : url(#method);     marker-start : url(#method-l); } .returnvalue {     stroke-dasharray: 5,2;     marker-end : url(#callback); } .returnvalue-both {     stroke-dasharray: 5,2;     marker-end : url(#callback);     marker-start : url(#callback-l); } .callback {     marker-end : url(#callback); } .callback-both {     marker-end : url(#callback);     marker-start : url(#callback-l); } .emphasised {     marker-end : url(#method); } .emphasised-both {     marker-end : url(#method);     marker-start : url(#method-l); } .lost {     marker-end : url(#lost); } .inherit {     stroke : inherit;     color : inherit; } .inherit-fill {     fill : inherit; } .watermark {     stroke: black;     color : black;     fill  : black;     font-size: 48pt;     font-weight: bold;     opacity : 0.14; }";return{bootstrap:function(e,t,n){return l(e,t,n)},init:function(e){return f(e)}}}),define("node/textutensils",[],function(){function e(e,t){var n=0,r=[],i=0,s=0,o=0,u=0,a=e.replace(/[\t\n]+/g," ").replace(/\\n/g,"\n");while(u<=a.length)u>=a.length?r.push(a.substring(i,u)):a[u]==="\n"?(n=0,o=u,r.push(a.substring(i,o)),i=o+1):n++>=t&&(o=a.substring(0,u).lastIndexOf(" "),o===-1||o<i?(n=1,o=u,s=u):(n=0,s=o+1),r.push(a.substring(i,o)),i=s),u++;return r}function t(e){var t=Math.abs(e),n=t/8;return t>160&&t<=320?n=t/6.4:t>320&&t<=480?n=t/5.9:t>480&&(n=t/5.6),n}function n(e){var t=e.replace(/\\\"/g,'"');return t}function r(e){var t={msgenny:"msgenny",mscgen:"mscgen",msc:"mscgen",mscin:"mscgen",xu:"xu",json:"json",ast:"json"},n=e.lastIndexOf(".");if(n>-1){var r=e.slice(n+1);if(t[r])return t[r]}return"mscgen"}return{wrap:function(t,n){return e(t,n)},determineMaxTextWidth:function(e){return t(e)},unescapeString:function(e){return n(e)},classifyExtension:function(e){return r(e)}}}),define("node/asttransform",[],function(){function e(e,t){var n,r,i=e;if(i&&t)for(n=0;n<i.length;n++)for(r=0;r<t.length;r++)i[n]=t[r](i[n]);return i}function t(e,n,r,i){var s,o,u,a,f=n;if(e&&f&&(r||i))for(s=0;s<f.length;s++){if(r)for(u=0;u<r.length;u++)f[s]=r[u](f[s],e);for(o=0;o<f[s].length;o++){if(i)for(a=0;a<i.length;a++)f[s][o]=i[a](f[s][o],e,f[s]);f[s][o].arcs&&t(e,f[s][o].arcs,r,i)}}return f}function n(n,r,i,s){var o=n;return o.entities=e(o.entities,r),o.arcs=t(n.entities,n.arcs,s,i),o}return{transform:function(e,t,r,i){return n(e,t,r,i)}}}),define("node/dotmap",[],function(){function i(e,t,n){var r={"->":"signal","<->":"signal-both","=>":"method","<=>":"method-both",">>":"returnvalue","<<>>":"returnvalue-both","..":"dotted","=>>":"callback","<<=>>":"callback-both",":>":"emphasised","<:>":"emphasised-both","::":"double","-x":"lost"},i="";return e&&r[e]&&(i=r[e],t&&n&&t>=n&&(i==="signal"&&(i="signal-u"),i==="signal-both"&&(t===n?i="signal-both-self":i="signal-both-u"))),i}var e={"->":"rvee","<->":"rvee","=>":"normal","<=>":"normal","-x":"oinvonormal"},t={box:"box",abox:"hexagon",rbox:"box",note:"note"},n={">>":"dashed","<<>>":"dashed","..":"dashed",":>":"bold","<:>":"bold","::":"bold",rbox:"rounded"},r={"|||":"emptyarc","...":"emptyarc","---":"emptyarc","->":"directional","=>":"directional","=>>":"directional",">>":"directional",":>":"directional","-x":"directional",note:"box",box:"box",abox:"box",rbox:"box","<->":"bidirectional","<=>":"bidirectional","<<=>>":"bidirectional","<<>>":"bidirectional","<:>":"bidirectional","--":"nondirectional","==":"nondirectional","..":"nondirectional","::":"nondirectional",alt:"inline_expression","else":"inline_expression",opt:"inline_expression","break":"inline_expression",par:"inline_expression",seq:"inline_expression",strict:"inline_expression",neg:"inline_expression",critical:"inline_expression",ignore:"inline_expression",consider:"inline_expression",assert:"inline_expression",loop:"inline_expression",ref:"inline_expression",exc:"inline_expression"};return{getArrow:function(t){return e[t]},getShape:function(e){return t[e]},getStyle:function(e){return n[e]},getAggregate:function(e){return r[e]},determineArcClass:function(e,t,n){return i(e,t,n)}}}),define("node/flatten",["./asttransform","./dotmap"],function(e,t){function r(e){var t=e;return t.label===undefined&&(t.label=t.name),t}function i(e){var t={"<-":"->","<=":"=>","<<=":"=>>","<<":">>","<:":":>","x-":"-x"},n=e;if(n.kind&&t[n.kind]){n.kind=t[n.kind];var r=n.from;n.from=n.to,n.to=r}return n}function s(e,t){var n=e;return!n.linecolor&&t.arclinecolor&&(n.linecolor=t.arclinecolor),!n.textcolor&&t.arctextcolor&&(n.textcolor=t.arctextcolor),!n.textbgcolor&&t.arctextbgcolor&&(n.textbgcolor=t.arctextbgcolor),n}function o(e,t){function n(e,t){var n;for(n=0;n<e.length;n++)if(e[n].name===t)return n;return-1}var r=e;if(r&&r.from){var i=n(t,r.from);i>-1&&(r=s(e,t[i]))}return r}function u(e){var t=e.arcs.length;for(var n=0;n<e.arcs.length;n++)e.arcs[n][0].arcs&&(t+=u(e.arcs[n][0])+1);return t}function a(e,r,i,o,f){var l={};if("inline_expression"===t.getAggregate(e[0].kind)){l=JSON.parse(JSON.stringify(e[0]));if(l)if(l.arcs){l.numberofrows=u(l),delete l.arcs,r.arcs.push([l]);for(var c=0;c<e[0].arcs.length;c++){a(e[0].arcs[c],r,l.from,l.to,f+1);for(var h=0;h<e[0].arcs[c].length;h++)s(e[0].arcs[c][h],l)}l.depth=f,f>n&&(n=f),r.arcs.push([{kind:"|||",from:l.from,to:l.to}])}else r.arcs.push([l])}else{if(i&&o)for(var p=0;p<e.length;p++)"emptyarc"===t.getAggregate(e[p].kind)&&(e[p].from=i,e[p].to=o,e[p].depth=f);r.arcs.push(e)}}function f(e){var t,r={};n=0,r.options=e.options?JSON.parse(JSON.stringify(e.options)):undefined,r.entities=e.entities?JSON.parse(JSON.stringify(e.entities)):undefined,r.arcs=[];if(e&&e.arcs)for(t=0;t<e.arcs.length;t++)a(e.arcs[t],r,undefined,undefined,0);return r.depth=n+1,r}function l(e){if(e.entities&&e.arcs){var t,n;for(t=0;t<e.arcs.length;t++)for(n=0;n<e.arcs[t].length;n++)if(e.arcs[t][n].to==="*"){var r=JSON.parse(JSON.stringify(e.arcs[t][n]));delete e.arcs[t][n];var i=!0,s=0;for(s=0;s<e.entities.length;s++)r.from!==e.entities[s].name&&(r.to=e.entities[s].name,i?(i=!1,e.arcs[t][n]=JSON.parse(JSON.stringify(r))):e.arcs[t].push(JSON.parse(JSON.stringify(r))))}}return e}var n=0;return{swapRTLArc:function(e){return i(e)},unwind:function(e){return f(e)},explodeBroadcasts:function(e){return l(e)},flatten:function(t){return e.transform(f(t),[r],[i,o])},dotFlatten:function(t){return l(e.transform(t,[r],[i,o]))}}}),define("renderast",["./renderutensils","./renderskeleton","./node/textutensils","./node/flatten","./node/dotmap"],function(e,t,n,r,i){function k(){C=[]}function L(e){return C[e]?C[e]:{y:c+1.5*v+e*v,height:v}}function A(e,t,n){if(t===undefined||t<v)t=v;if(n===undefined){var r=L(e-1);r&&r.y>0?n=r.y+(r.height+t)/2:n=c+1.5*v+e*v}C[e]={y:n,height:t}}function O(e,n){N=t.init(n);var r=N.getElementById(d+e);if(r&&r!==null&&r!==undefined){var i=N.getElementById(e);i.removeChild(r)}}function M(e){u=o,c=l,f=a,v=h,g=m,y=!1,e&&(e.hscale&&(u=e.hscale*o,f=e.hscale*a),e.arcgradient&&(v=parseInt(e.arcgradient,10)+h,g=parseInt(e.arcgradient,10)+m),e.wordwraparcs&&e.wordwraparcs==="true"&&(y=!0))}function _(e){return T+e}function D(n,i,o,a){n=r.flatten(n),T=d+o,t.bootstrap(o,T,a),N=t.init(a),x=e.getBBox(e.createText("ÁjyÎ9ƒ@",0,0)).height,M(n.options);var l=0;b=0,n.depth&&(l=2*(n.depth+1)*2*p,b=n.depth),H(n.entities),B(n.arcs,n.entities);var c=n.entities.length*u+l,h=n.arcs?n.arcs.length:0,v=L(h-1),m=v.y+v.height/2+2*s,g=(u+l-f)/2,y=s,w=1;if(i){var E=N.getElementById(_("__msc_source")),S=N.createTextNode("\n\n# Generated by mscgen_js - http://sverweij.github.io/mscgen_js\n"+i);E.appendChild(S)}var C=N.getElementById(_("__background")),k=e.createRect(c,m,"bglayer",0-g,0-y);C.appendChild(k);if(n.options&&n.options.watermark){var A=N.getElementById(_("__watermark")),O=e.createText(n.options.watermark,c/2,m/2,"watermark"),D=0-Math.atan(m/c)*360/(2*Math.PI);O.setAttribute("transform","rotate("+D.toString()+" "+(c/2).toString()+" "+(m/2).toString()+")"),A.appendChild(O)}n.options&&n.options.width&&(w=n.options.width/c,c*=w,m*=w,g*=w,y*=w);var P=N.getElementById(T),j=N.getElementById(_("__body"));j.setAttribute("transform","translate("+g+","+y+")"+" scale("+w+","+w+")"),P.setAttribute("width",c.toString()),P.setAttribute("height",m.toString())}function P(t){var n=c,r=[],i=0;for(i=0;i<t.length;i++){r[i]=q(t[i].name,t[i]);var s=e.getBBox(r[i]).height;s>n&&(n=s)}return n}function H(t){var n=N.getElementById(_("__defs")),r=N.getElementById(_("__sequencelayer")),i=0,s;E={},S={};var o={};if(t){c=P(t)+p*2;for(s=0;s<t.length;s++)o={},n.appendChild(q(_(t[s].name),t[s])),r.appendChild(e.createUse(i,0,_(t[s].name))),E[t[s].name]=i+f/2,i+=u,t[s].arclinecolor&&(o.arclinecolor=t[s].arclinecolor),t[s].arctextcolor&&(o.arctextcolor=t[s].arctextcolor),t[s].arctextbgcolor&&(o.arctextbgcolor=t[s].arctextbgcolor),S[t[s].name]=o}w=i}function B(t,n){var r=N.getElementById(_("__defs")),s=N.getElementById(_("__lifelinelayer")),o=N.getElementById(_("__sequencelayer")),a=N.getElementById(_("__notelayer")),l=[],c="",h=w-u+f,d,v,m=0;r.appendChild(R(n,_("arcrow"))),s.appendChild(e.createUse(0,L(-1).y,_("arcrow"))),k();if(t){for(d=0;d<t.length;d++){var g=!1,y=[];A(d);for(v=0;v<t[d].length;v++){var b=_(d.toString()+"_"+v.toString()),S;c="",t[d][v].label&&(c=t[d][v].label);switch(i.getAggregate(t[d][v].kind)){case"emptyarc":S=z(t[d][v],b),g="..."===t[d][v].kind,y.push({id:b,layer:o});break;case"box":S=Y(b,E[t[d][v].from],E[t[d][v].to],t[d][v]),y.push({id:b,layer:a});break;case"inline_expression":S=j(b+"_label",t[d][v]),y.push({id:b+"_label",layer:a}),l.push({id:b,arc:t[d][v],rownum:d});break;default:if(t[d][v].from&&t[d][v].to){var T=t[d][v].from,C=t[d][v].to,O=0,M=0;if(C==="*"){M=E[T];for(m=0;m<n.length;m++)n[m].name!=T&&(O=E[n[m].name],t[d][v].label="",r.appendChild(W(b+"bc"+m,t[d][v],M,O)),y.push({id:b+"bc"+m,layer:o}));t[d][v].label=c,S=$(b+"_txt",t[d][v],0,0-x/2-p,h),y.push({id:b+"_txt",layer:o})}else M=E[T],O=E[C],S=W(b,t[d][v],M,O),y.push({id:b,layer:o})}}S&&(A(d,Math.max(L(d).height,e.getBBox(S).height+2*p)),r.appendChild(S))}var D="arcrow_"+d.toString(),P="arcrow";g&&(P="arcrowomit"),r.appendChild(R(n,P,L(d).height,_(D))),s.appendChild(e.createUse(0,L(d).y,_(D)));for(var H=0;H<y.length;H++)y[H].layer.appendChild(e.createUse(0,L(d).y,y[H].id))}F(l)}}function j(t,n){var r=E[n.from],i=E[n.to],s=7;if(r>i){var o=r;r=i,i=o}var a=i-r+(u-2*p)-s-p,f=r-(u-3*p)/2-(b-n.depth)*2*p,l=e.createGroup(t);n.label=n.kind+(n.label?": "+n.label:"");var c=$(t+"_txt",n,f+p-a/2,v/4,a,"anchor-start"),h=e.getBBox(c),d=Math.max(h.height+2*p,v/2-2*p),m=Math.min(h.width+2*p,a),g=e.createEdgeRemark(m-p+s,d,"box",f,0,s);return G(g,n),l.appendChild(g),l.appendChild(c),l}function F(t){var n=N.getElementById(_("__defs")),r=N.getElementById(_("__arcspanlayer"));for(var i=0;i<t.length;i++)n.appendChild(I(t[i])),r.appendChild(e.createUse(0,L(t[i].rownum).y,t[i].id))}function I(e){var t=L(e.rownum).y,n=L(e.rownum+e.arc.numberofrows+1).y,r=n-t;return e.arc.label="",Y(e.id,E[e.arc.from],E[e.arc.to],e.arc,r)}function q(t,n){var r=e.createGroup(t),i=$(t+"_txt",n,0,c/2,f,"entity"),s=e.createRect(f,c);return G(s,n),r.appendChild(s),r.appendChild(i),r}function R(t,n,r,i){var s=0;if(i===undefined||i===null)i=n;if(r===undefined||r===null||r<v)r=v;var o=e.createGroup(i),a=0;for(s=0;s<t.length;s++){var l=e.createLine(a+f/2,0-r/2,a+f/2,r/2,n);t[s].linecolor&&l.setAttribute("style","stroke : "+t[s].linecolor+";"),o.appendChild(l),a+=u}return o}function U(t,n,r,i,s){var o=2*(v/5),a=u/3,f=e.createGroup("selfie");if(i){var l=e.createUTurn(n,(o-4)/2,r-2+o,a-4,"none"),c=e.createUTurn(n,(o+4)/2,r+6+o,a,t);s&&(l.setAttribute("style","stroke: "+s+";"),c.setAttribute("style","stroke: "+s+";")),f.appendChild(l),f.appendChild(c)}else{var h=e.createUTurn(n,o/2,r+o,a,t);s&&h.setAttribute("style","stroke: "+s+";"),f.appendChild(h)}return f}function z(e,t){var n;if(e.from&&e.to&&E[e.from]>E[e.to]){var r=e.from;e.from=e.to,e.to=r}switch(e.kind){case"...":case"|||":n=J(t,e);break;case"---":n=K(t,e)}return n}function W(t,n,r,s){var o=e.createGroup(t),a="",f=g,l=":>"===n.kind||"::"===n.kind||"<:>"===n.kind;a=i.determineArcClass(n.kind,r,s),"-x"===n.kind&&(s=r+(s-r)*.75);var c=0;n.arcskip&&(c=n.arcskip*v,f=c),n.label&&n.label.indexOf("\\n")===-1&&(n.label+="\\n");if(r===s)o.appendChild(U(a,r,c,l,n.linecolor)),o.appendChild($(t+"_txt",n,r+2-u/2,0-v/5,u,"anchor-start"));else{var h=e.createLine(r,0,s,f,a,l);n.linecolor&&h.setAttribute("style","stroke:"+n.linecolor+"; fill: "+n.linecolor+";"),o.appendChild(h),o.appendChild($(t+"_txt",n,r,0,s-r))}return o}function X(e,t,r){var i=e.split("\\n"),s=n.determineMaxTextWidth(r);switch(t){case"box":case"rbox":case"abox":case"note":case undefined:i=n.wrap(e,s);break;default:y&&(i=n.wrap(e,s))}return i}function V(t,n,r,i,s,o,u){var a=t,f={};u===0?f=e.createText(n,r,i+x/4+u*x,s,o.url,o.id,o.idurl):f=e.createText(n,r,i+x/4+u*x,s,o.url);var l=e.getBBox(f),c=e.createRect(l.width,l.height,"textbg",l.x,l.y);return Q(f,o),o.textbgcolor&&c.setAttribute("style","fill: "+o.textbgcolor+"; stroke:"+o.textbgcolor+";"),o.url&&!o.textcolor&&(o.textcolor="blue",Q(f,o)),a.appendChild(c),a.appendChild(f),a}function $(t,r,i,s,o,u){var a=e.createGroup(t);if(r.label){var f=i+o/2;r.label=n.unescapeString(r.label),r.id&&(r.id=n.unescapeString(r.id));var l=X(r.label,r.kind,o),c=s-(l.length-1)*x/2-(l.length-1)/2;for(var h=0;h<l.length;h++)a=V(a,l[h],f,c,u,r,h),c++}return a}function J(t,n){var r=0,i=w-u+f,s=e.createGroup(t);return n.from&&n.to&&(r=E[n.from],i=Math.abs(E[n.to]-E[n.from])),s.appendChild($(t,n,r,0,i)),s}function K(t,n){var r=0,i=w-u+f,s="dotted",o=e.createGroup(t);if(n.from&&n.to){var a=(b-n.depth)*2*p;r=E[n.from]-(u+2*p)/2-a,i=E[n.to]+(u+2*p)/2+a,s="striped"}var l=e.createLine(r,0,i,0,s);return o.appendChild(l),o.appendChild(J(t+"_txt",n)),n.linecolor&&l.setAttribute("style","stroke: "+n.linecolor+";"),o}function Q(e,t){if(t.textcolor){var n="";n+="fill:"+t.textcolor+";",e.setAttribute("style",n)}}function G(e,t){var n="";t.textbgcolor&&(n+="fill:"+t.textbgcolor+";"),t.linecolor&&(n+="stroke:"+t.linecolor+";"),e.setAttribute("style",n)}function Y(t,n,r,i,s){if(n>r){var o=n;n=r,r=o}var a=r-n+u-2*p,f=9,l=6,c=n-(u-2*p)/2,h=e.createGroup(t),d,m=$(t+"_txt",i,c,0,a),g=e.getBBox(m),y=s?s:Math.max(g.height+2*p,v-2*p);switch(i.kind){case"box":d=e.createRect(a,y,"box",c,0-y/2);break;case"rbox":d=e.createRect(a,y,"box",c,0-y/2,l,l);break;case"abox":d=e.createABox(a,y,"box",c,0);break;case"note":d=e.createNote(a,y,"box",c,0-y/2,f);break;default:var w=(b-i.depth)*2*p;d=e.createRect(a+w*2,y,"box",c-w,0)}return G(d,i),h.appendChild(d),h.appendChild(m),h}var s=3,o=160,u=o,a=100,f=a,l=34,c=l,h=38,p=2,d="mscgen_js$svg$",v=h,m=0,g=m,y=!1,b=0,w=0,E={},S={},x=12,T=d,N,C=[];return{clean:function(e,t){O(e,t)},renderAST:function(e,t,n,r){D(e,t,n,r)}}}),define("controller-inpage",["xuparser","msgennyparser","renderast"],function(e,t,n){function s(){var e=document.getElementsByClassName("mscgen_js"),t,n;for(var s=0;s<e.length;s++){if(""===e[s].id||null===e[s].id||undefined===e[s].id)e[s].id=r+s.toString();n=e[s].getAttribute("data-language");if(undefined===n||null===n)n=i;t=o(e[s].textContent,n),t.entities?u(t,e[s].id,e[s].textContent):e[s].innerHTML+="<div style='color: red'>ERROR: line "+t.line+", column "+t.column+": "+t.message+"</div>"}}function o(n,r){var i={};try{"msgenny"===r?i=t.parse(n):"json"===r?i=JSON.parse(n):"xu"===r?i=e.parse(n):i=e.parse(n)}catch(s){return s}return i}function u(e,t,r){document.getElementById(t).innerHTML="",n.clean(t,window),n.renderAST(e,r,t,window)}var r="mscgen_js$parent_",i="mscgen";s()}),require(["controller-inpage"],function(e){}),define("mscgen-inpage",function(){});