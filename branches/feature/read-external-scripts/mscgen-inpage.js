/**
 * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*
 This file is part of mscgen_js.

 mscgen_js is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 mscgen_js is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with mscgen_js.  If not, see <http://www.gnu.org/licenses/>.
 */

(function(){var e,t,n;(function(r){function v(e,t){return h.call(e,t)}function m(e,t){var n,r,i,s,o,u,a,f,c,h,p,v=t&&t.split("/"),m=l.map,g=m&&m["*"]||{};if(e&&e.charAt(0)===".")if(t){e=e.split("/"),o=e.length-1,l.nodeIdCompat&&d.test(e[o])&&(e[o]=e[o].replace(d,"")),e=v.slice(0,v.length-1).concat(e);for(c=0;c<e.length;c+=1){p=e[c];if(p===".")e.splice(c,1),c-=1;else if(p===".."){if(c===1&&(e[2]===".."||e[0]===".."))break;c>0&&(e.splice(c-1,2),c-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((v||g)&&m){n=e.split("/");for(c=n.length;c>0;c-=1){r=n.slice(0,c).join("/");if(v)for(h=v.length;h>0;h-=1){i=m[v.slice(0,h).join("/")];if(i){i=i[r];if(i){s=i,u=c;break}}}if(s)break;!a&&g&&g[r]&&(a=g[r],f=c)}!s&&a&&(s=a,u=f),s&&(n.splice(0,u,s),e=n.join("/"))}return e}function g(e,t){return function(){var n=p.call(arguments,0);return typeof n[0]!="string"&&n.length===1&&n.push(null),s.apply(r,n.concat([e,t]))}}function y(e){return function(t){return m(t,e)}}function b(e){return function(t){a[e]=t}}function w(e){if(v(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!v(a,e)&&!v(c,e))throw new Error("No "+e);return a[e]}function E(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function S(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice,d=/\.js$/;o=function(e,t){var n,r=E(e),i=r[0];return e=r[1],i&&(i=m(i,t),n=w(i)),i?n&&n.normalize?e=n.normalize(e,y(t)):e=m(e,t):(e=m(e,t),r=E(e),i=r[0],e=r[1],i&&(n=w(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return g(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:S(e)}}},i=function(e,t,n,i){var s,l,h,p,d,m=[],y=typeof n,E;i=i||e;if(y==="undefined"||y==="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(d=0;d<t.length;d+=1){p=o(t[d],i),l=p.f;if(l==="require")m[d]=u.require(e);else if(l==="exports")m[d]=u.exports(e),E=!0;else if(l==="module")s=m[d]=u.module(e);else if(v(a,l)||v(f,l)||v(c,l))m[d]=w(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,g(i,!0),b(l),{}),m[d]=a[l]}}h=n?n.apply(a[e],m):undefined;if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!E)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){if(typeof e=="string")return u[e]?u[e](t):w(o(e,t).f);if(!e.splice){l=e,l.deps&&s(l.deps,l.callback);if(!t)return;t.splice?(e=t,t=n,n=null):e=r}return t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s},s.config=function(e){return s(e)},e._defined=a,n=function(e,t,n){if(typeof e!="string")throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),!v(a,e)&&!v(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}})(),n("../../node_modules/almond/almond",function(){}),n("parse/xuparser",[],function(){"use strict";function e(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}function t(e,n,r,i){this.message=e,this.expected=n,this.found=r,this.location=i,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,t)}function n(e){function Ai(){return e.substring(xi,Si)}function Oi(){return Pi(xi,Si)}function Mi(t){throw Bi(null,[{type:"other",description:t}],e.substring(xi,Si),Pi(xi,Si))}function _i(t){throw Bi(t,null,e.substring(xi,Si),Pi(xi,Si))}function Di(t){var n=Ti[t],r,i;if(n)return n;r=t-1;while(!Ti[r])r--;n=Ti[r],n={line:n.line,column:n.column,seenCR:n.seenCR};while(r<t)i=e.charAt(r),i==="\n"?(n.seenCR||n.line++,n.column=1,n.seenCR=!1):i==="\r"||i==="\u2028"||i==="\u2029"?(n.line++,n.column=1,n.seenCR=!0):(n.column++,n.seenCR=!1),r++;return Ti[t]=n,n}function Pi(e,t){var n=Di(e),r=Di(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function Hi(e){if(Si<Ni)return;Si>Ni&&(Ni=Si,Ci=[]),Ci.push(e)}function Bi(e,n,r,i){function s(e){var t=1;e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});while(t<e.length)e[t-1]===e[t]?e.splice(t,1):t++}function o(e,t){function n(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0100-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1000-\uFFFF]/g,function(e){return"\\u"+t(e)})}var r=new Array(e.length),i,s,o;for(o=0;o<e.length;o++)r[o]=e[o].description;return i=e.length>1?r.slice(0,-1).join(", ")+" or "+r[e.length-1]:r[0],s=t?'"'+n(t)+'"':"end of input","Expected "+i+" but "+s+" found."}return n!==null&&s(n),new t(e!==null?e:o(n,r),n,r,i)}function ji(){var t,n,r,s,o,h,p,d,v,m;return t=Si,n=xs(),n!==i?(r=Fi(),r!==i?(s=xs(),s!==i?(e.charCodeAt(Si)===123?(o=u,Si++):(o=i,ki===0&&Hi(a)),o!==i?(h=xs(),h!==i?(p=Ii(),p!==i?(d=xs(),d!==i?(e.charCodeAt(Si)===125?(v=f,Si++):(v=i,ki===0&&Hi(l)),v!==i?(m=xs(),m!==i?(xi=t,n=c(n,p),t=n):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i),t}function Fi(){var t;return e.substr(Si,3).toLowerCase()===h?(t=e.substr(Si,3),Si+=3):(t=i,ki===0&&Hi(p)),t}function Ii(){var e,t,n,r,s;return e=Si,t=Si,n=qi(),n!==i&&(xi=t,n=d(n)),t=n,t===i&&(t=null),t!==i?(n=Si,r=zi(),r!==i&&(xi=n,r=v(r)),n=r,n===i&&(n=null),n!==i?(r=Si,s=Xi(),s!==i&&(xi=r,s=m(s)),r=s,r===i&&(r=null),r!==i?(t=[t,n,r],e=t):(Si=e,e=i)):(Si=e,e=i)):(Si=e,e=i),e}function qi(){var t,n,r,s,o,u;t=Si,n=Si,r=[],s=Si,o=Ri(),o!==i?(e.charCodeAt(Si)===44?(u=g,Si++):(u=i,ki===0&&Hi(y)),u!==i?(xi=s,o=b(o),s=o):(Si=s,s=i)):(Si=s,s=i);while(s!==i)r.push(s),s=Si,o=Ri(),o!==i?(e.charCodeAt(Si)===44?(u=g,Si++):(u=i,ki===0&&Hi(y)),u!==i?(xi=s,o=b(o),s=o):(Si=s,s=i)):(Si=s,s=i);return r!==i?(s=Si,o=Ri(),o!==i?(e.charCodeAt(Si)===59?(u=w,Si++):(u=i,ki===0&&Hi(E)),u!==i?(xi=s,o=b(o),s=o):(Si=s,s=i)):(Si=s,s=i),s!==i?(r=[r,s],n=r):(Si=n,n=i)):(Si=n,n=i),n!==i&&(xi=t,n=S(n)),t=n,t}function Ri(){var t,n,r,s,o,u,a,f;return t=Si,n=xs(),n!==i?(r=Ui(),r!==i?(s=xs(),s!==i?(e.charCodeAt(Si)===61?(o=x,Si++):(o=i,ki===0&&Hi(T)),o!==i?(u=xs(),u!==i?(a=Si,f=ls(),f!==i&&(xi=a,f=N(r,f)),a=f,a===i&&(a=Si,f=Ts(),f!==i&&(xi=a,f=C(r,f)),a=f,a===i&&(a=Si,f=ks(),f!==i&&(xi=a,f=k(r,f)),a=f)),a!==i?(f=xs(),f!==i?(xi=t,n=L(r,a),t=n):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i),t}function Ui(){var t;return e.substr(Si,6).toLowerCase()===A?(t=e.substr(Si,6),Si+=6):(t=i,ki===0&&Hi(O)),t===i&&(e.substr(Si,5).toLowerCase()===M?(t=e.substr(Si,5),Si+=5):(t=i,ki===0&&Hi(_)),t===i&&(e.substr(Si,11).toLowerCase()===D?(t=e.substr(Si,11),Si+=11):(t=i,ki===0&&Hi(P)),t===i&&(e.substr(Si,12).toLowerCase()===H?(t=e.substr(Si,12),Si+=12):(t=i,ki===0&&Hi(B)),t===i&&(e.substr(Si,9).toLowerCase()===j?(t=e.substr(Si,9),Si+=9):(t=i,ki===0&&Hi(F)))))),t}function zi(){var t,n,r,s,o,u;t=Si,n=Si,r=[],s=Si,o=Wi(),o!==i?(e.charCodeAt(Si)===44?(u=g,Si++):(u=i,ki===0&&Hi(y)),u!==i?(xi=s,o=I(o),s=o):(Si=s,s=i)):(Si=s,s=i);while(s!==i)r.push(s),s=Si,o=Wi(),o!==i?(e.charCodeAt(Si)===44?(u=g,Si++):(u=i,ki===0&&Hi(y)),u!==i?(xi=s,o=I(o),s=o):(Si=s,s=i)):(Si=s,s=i);return r!==i?(s=Si,o=Wi(),o!==i?(e.charCodeAt(Si)===59?(u=w,Si++):(u=i,ki===0&&Hi(E)),u!==i?(xi=s,o=I(o),s=o):(Si=s,s=i)):(Si=s,s=i),s!==i?(r=[r,s],n=r):(Si=n,n=i)):(Si=n,n=i),n!==i&&(xi=t,n=q(n)),t=n,t}function Wi(){var t,n,r,s,o,u,a,f;return ki++,t=Si,n=xs(),n!==i?(r=hs(),r!==i?(s=xs(),s!==i?(o=Si,e.charCodeAt(Si)===91?(u=U,Si++):(u=i,ki===0&&Hi(z)),u!==i?(a=us(),a!==i?(e.charCodeAt(Si)===93?(f=W,Si++):(f=i,ki===0&&Hi(X)),f!==i?(xi=o,u=V(r,a),o=u):(Si=o,o=i)):(Si=o,o=i)):(Si=o,o=i),o===i&&(o=null),o!==i?(u=xs(),u!==i?(xi=t,n=$(r,o),t=n):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i),ki--,t===i&&(n=i,ki===0&&Hi(R)),t}function Xi(){var t,n,r,s,o;t=[],n=Si,r=Vi(),r!==i?(s=xs(),s!==i?(e.charCodeAt(Si)===59?(o=w,Si++):(o=i,ki===0&&Hi(E)),o!==i?(xi=n,r=J(r),n=r):(Si=n,n=i)):(Si=n,n=i)):(Si=n,n=i);if(n!==i)while(n!==i)t.push(n),n=Si,r=Vi(),r!==i?(s=xs(),s!==i?(e.charCodeAt(Si)===59?(o=w,Si++):(o=i,ki===0&&Hi(E)),o!==i?(xi=n,r=J(r),n=r):(Si=n,n=i)):(Si=n,n=i)):(Si=n,n=i);else t=i;return t}function Vi(){var t,n,r,s,o,u,a;t=Si,n=Si,r=[],s=Si,o=$i(),o!==i?(u=xs(),u!==i?(e.charCodeAt(Si)===44?(a=g,Si++):(a=i,ki===0&&Hi(y)),a!==i?(xi=s,o=J(o),s=o):(Si=s,s=i)):(Si=s,s=i)):(Si=s,s=i);while(s!==i)r.push(s),s=Si,o=$i(),o!==i?(u=xs(),u!==i?(e.charCodeAt(Si)===44?(a=g,Si++):(a=i,ki===0&&Hi(y)),a!==i?(xi=s,o=J(o),s=o):(Si=s,s=i)):(Si=s,s=i)):(Si=s,s=i);return r!==i?(s=Si,o=$i(),o!==i&&(xi=s,o=K(o)),s=o,s!==i?(r=[r,s],n=r):(Si=n,n=i)):(Si=n,n=i),n!==i&&(xi=t,n=Q(n)),t=n,t}function $i(){var e;return e=Ji(),e===i&&(e=Yi()),e}function Ji(){var t,n,r,s,o,u;return t=Si,n=Si,r=Ki(),r!==i&&(xi=n,r=J(r)),n=r,n===i&&(n=Si,r=Gi(),r!==i&&(xi=n,r=J(r)),n=r,n===i&&(n=Si,r=Qi(),r!==i&&(xi=n,r=J(r)),n=r)),n!==i?(r=Si,e.charCodeAt(Si)===91?(s=U,Si++):(s=i,ki===0&&Hi(z)),s!==i?(o=us(),o!==i?(e.charCodeAt(Si)===93?(u=W,Si++):(u=i,ki===0&&Hi(X)),u!==i?(xi=r,s=G(n,o),r=s):(Si=r,r=i)):(Si=r,r=i)):(Si=r,r=i),r===i&&(r=null),r!==i?(xi=t,n=Y(n,r),t=n):(Si=t,t=i)):(Si=t,t=i),t}function Ki(){var e,t,n,r;return e=Si,t=xs(),t!==i?(n=Zi(),n!==i?(r=xs(),r!==i?(xi=e,t=Z(n),e=t):(Si=e,e=i)):(Si=e,e=i)):(Si=e,e=i),e}function Qi(){var e,t,n,r;return e=Si,t=xs(),t!==i?(n=es(),n!==i?(r=xs(),r!==i?(xi=e,t=Z(n),e=t):(Si=e,e=i)):(Si=e,e=i)):(Si=e,e=i),e}function Gi(){var t,n,r,s,o,u,a,f;return t=Si,n=xs(),n!==i?(r=hs(),r!==i?(s=xs(),s!==i?(o=ts(),o!==i?(u=xs(),u!==i?(a=hs(),a!==i?(f=xs(),f!==i?(xi=t,n=et(r,o,a),t=n):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i),t===i&&(t=Si,n=xs(),n!==i?(e.charCodeAt(Si)===42?(r=tt,Si++):(r=i,ki===0&&Hi(nt)),r!==i?(s=xs(),s!==i?(o=is(),o!==i?(u=xs(),u!==i?(a=hs(),a!==i?(f=xs(),f!==i?(xi=t,n=rt(o,a),t=n):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i),t===i&&(t=Si,n=xs(),n!==i?(r=hs(),r!==i?(s=xs(),s!==i?(o=rs(),o!==i?(u=xs(),u!==i?(e.charCodeAt(Si)===42?(a=tt,Si++):(a=i,ki===0&&Hi(nt)),a!==i?(f=xs(),f!==i?(xi=t,n=it(r,o),t=n):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i),t===i&&(t=Si,n=xs(),n!==i?(r=hs(),r!==i?(s=xs(),s!==i?(o=ns(),o!==i?(u=xs(),u!==i?(e.charCodeAt(Si)===42?(a=tt,Si++):(a=i,ki===0&&Hi(nt)),a!==i?(f=xs(),f!==i?(xi=t,n=it(r,o),t=n):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)))),t}function Yi(){var t,n,r,s,o,c,h,p,d,v,m,g,y,b,w,E;return t=Si,n=xs(),n!==i?(r=hs(),r!==i?(s=xs(),s!==i?(o=os(),o!==i?(c=xs(),c!==i?(h=hs(),h!==i?(p=xs(),p!==i?(d=Si,e.charCodeAt(Si)===91?(v=U,Si++):(v=i,ki===0&&Hi(z)),v!==i?(m=us(),m!==i?(e.charCodeAt(Si)===93?(g=W,Si++):(g=i,ki===0&&Hi(X)),g!==i?(xi=d,v=st(r,o,h,m),d=v):(Si=d,d=i)):(Si=d,d=i)):(Si=d,d=i),d===i&&(d=null),d!==i?(v=xs(),v!==i?(e.charCodeAt(Si)===123?(m=u,Si++):(m=i,ki===0&&Hi(a)),m!==i?(g=xs(),g!==i?(y=Xi(),y===i&&(y=null),y!==i?(b=xs(),b!==i?(e.charCodeAt(Si)===125?(w=f,Si++):(w=i,ki===0&&Hi(l)),w!==i?(E=xs(),E!==i?(xi=t,n=ot(r,o,h,d,y),t=n):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i),t}function Zi(){var t;return e.substr(Si,3)===ut?(t=ut,Si+=3):(t=i,ki===0&&Hi(at)),t===i&&(e.substr(Si,3)===ft?(t=ft,Si+=3):(t=i,ki===0&&Hi(lt))),t}function es(){var t;return e.substr(Si,3)===ct?(t=ct,Si+=3):(t=i,ki===0&&Hi(ht)),t}function ts(){var e,t;return e=Si,t=ns(),t===i&&(t=rs(),t===i&&(t=is(),t===i&&(t=ss()))),t!==i&&(xi=e,t=pt(t)),e=t,e}function ns(){var t,n;return ki++,e.substr(Si,2)===vt?(t=vt,Si+=2):(t=i,ki===0&&Hi(mt)),t===i&&(e.substr(Si,3)===gt?(t=gt,Si+=3):(t=i,ki===0&&Hi(yt)),t===i&&(e.substr(Si,2)===bt?(t=bt,Si+=2):(t=i,ki===0&&Hi(wt)),t===i&&(e.substr(Si,5)===Et?(t=Et,Si+=5):(t=i,ki===0&&Hi(St)),t===i&&(e.substr(Si,3)===xt?(t=xt,Si+=3):(t=i,ki===0&&Hi(Tt)),t===i&&(e.substr(Si,2)===Nt?(t=Nt,Si+=2):(t=i,ki===0&&Hi(Ct)),t===i&&(e.substr(Si,4)===kt?(t=kt,Si+=4):(t=i,ki===0&&Hi(Lt)),t===i&&(e.substr(Si,2)===At?(t=At,Si+=2):(t=i,ki===0&&Hi(Ot)),t===i&&(e.substr(Si,3)===Mt?(t=Mt,Si+=3):(t=i,ki===0&&Hi(_t)))))))))),ki--,t===i&&(n=i,ki===0&&Hi(dt)),t}function rs(){var t,n;return ki++,e.substr(Si,2)===Pt?(t=Pt,Si+=2):(t=i,ki===0&&Hi(Ht)),t===i&&(e.substr(Si,3)===Bt?(t=Bt,Si+=3):(t=i,ki===0&&Hi(jt)),t===i&&(e.substr(Si,2)===Ft?(t=Ft,Si+=2):(t=i,ki===0&&Hi(It)),t===i&&(e.substr(Si,2)===qt?(t=qt,Si+=2):(t=i,ki===0&&Hi(Rt)),t===i&&(e.substr(Si,2)===Ut?(t=Ut,Si+=2):(t=i,ki===0&&Hi(zt)),t===i&&(e.substr(Si,2).toLowerCase()===Wt?(t=e.substr(Si,2),Si+=2):(t=i,ki===0&&Hi(Xt))))))),ki--,t===i&&(n=i,ki===0&&Hi(Dt)),t}function is(){var t,n;return ki++,e.substr(Si,2)===$t?(t=$t,Si+=2):(t=i,ki===0&&Hi(Jt)),t===i&&(e.substr(Si,3)===Kt?(t=Kt,Si+=3):(t=i,ki===0&&Hi(Qt)),t===i&&(e.substr(Si,2)===Gt?(t=Gt,Si+=2):(t=i,ki===0&&Hi(Yt)),t===i&&(e.substr(Si,2)===Zt?(t=Zt,Si+=2):(t=i,ki===0&&Hi(en)),t===i&&(e.substr(Si,2)===tn?(t=tn,Si+=2):(t=i,ki===0&&Hi(nn)),t===i&&(e.substr(Si,2).toLowerCase()===rn?(t=e.substr(Si,2),Si+=2):(t=i,ki===0&&Hi(sn))))))),ki--,t===i&&(n=i,ki===0&&Hi(Vt)),t}function ss(){var t,n;return ki++,e.substr(Si,4).toLowerCase()===un?(t=e.substr(Si,4),Si+=4):(t=i,ki===0&&Hi(an)),t===i&&(e.substr(Si,4).toLowerCase()===fn?(t=e.substr(Si,4),Si+=4):(t=i,ki===0&&Hi(ln)),t===i&&(e.substr(Si,4).toLowerCase()===cn?(t=e.substr(Si,4),Si+=4):(t=i,ki===0&&Hi(hn)),t===i&&(e.substr(Si,3).toLowerCase()===pn?(t=e.substr(Si,3),Si+=3):(t=i,ki===0&&Hi(dn))))),ki--,t===i&&(n=i,ki===0&&Hi(on)),t}function os(){var t,n;return ki++,t=Si,e.substr(Si,3).toLowerCase()===mn?(n=e.substr(Si,3),Si+=3):(n=i,ki===0&&Hi(gn)),n===i&&(e.substr(Si,4).toLowerCase()===yn?(n=e.substr(Si,4),Si+=4):(n=i,ki===0&&Hi(bn)),n===i&&(e.substr(Si,3).toLowerCase()===wn?(n=e.substr(Si,3),Si+=3):(n=i,ki===0&&Hi(En)),n===i&&(e.substr(Si,5).toLowerCase()===Sn?(n=e.substr(Si,5),Si+=5):(n=i,ki===0&&Hi(xn)),n===i&&(e.substr(Si,3).toLowerCase()===Tn?(n=e.substr(Si,3),Si+=3):(n=i,ki===0&&Hi(Nn)),n===i&&(e.substr(Si,3).toLowerCase()===Cn?(n=e.substr(Si,3),Si+=3):(n=i,ki===0&&Hi(kn)),n===i&&(e.substr(Si,6).toLowerCase()===Ln?(n=e.substr(Si,6),Si+=6):(n=i,ki===0&&Hi(An)),n===i&&(e.substr(Si,3).toLowerCase()===On?(n=e.substr(Si,3),Si+=3):(n=i,ki===0&&Hi(Mn)),n===i&&(e.substr(Si,8).toLowerCase()===_n?(n=e.substr(Si,8),Si+=8):(n=i,ki===0&&Hi(Dn)),n===i&&(e.substr(Si,6).toLowerCase()===Pn?(n=e.substr(Si,6),Si+=6):(n=i,ki===0&&Hi(Hn)),n===i&&(e.substr(Si,8).toLowerCase()===Bn?(n=e.substr(Si,8),Si+=8):(n=i,ki===0&&Hi(jn)),n===i&&(e.substr(Si,6).toLowerCase()===Fn?(n=e.substr(Si,6),Si+=6):(n=i,ki===0&&Hi(In)),n===i&&(e.substr(Si,4).toLowerCase()===qn?(n=e.substr(Si,4),Si+=4):(n=i,ki===0&&Hi(Rn)),n===i&&(e.substr(Si,3).toLowerCase()===Un?(n=e.substr(Si,3),Si+=3):(n=i,ki===0&&Hi(zn)),n===i&&(e.substr(Si,3).toLowerCase()===Wn?(n=e.substr(Si,3),Si+=3):(n=i,ki===0&&Hi(Xn)))))))))))))))),n!==i&&(xi=t,n=pt(n)),t=n,ki--,t===i&&(n=i,ki===0&&Hi(vn)),t}function us(){var t,n,r,s,o,u;t=Si,n=Si,r=[],s=Si,o=as(),o!==i?(e.charCodeAt(Si)===44?(u=g,Si++):(u=i,ki===0&&Hi(y)),u!==i?(xi=s,o=J(o),s=o):(Si=s,s=i)):(Si=s,s=i);while(s!==i)r.push(s),s=Si,o=as(),o!==i?(e.charCodeAt(Si)===44?(u=g,Si++):(u=i,ki===0&&Hi(y)),u!==i?(xi=s,o=J(o),s=o):(Si=s,s=i)):(Si=s,s=i);return r!==i?(s=Si,o=as(),o!==i&&(xi=s,o=J(o)),s=o,s!==i?(r=[r,s],n=r):(Si=n,n=i)):(Si=n,n=i),n!==i&&(xi=t,n=Vn(n)),t=n,t}function as(){var t,n,r,s,o,u,a,f;return t=Si,n=xs(),n!==i?(r=fs(),r!==i?(s=xs(),s!==i?(e.charCodeAt(Si)===61?(o=x,Si++):(o=i,ki===0&&Hi(T)),o!==i?(u=xs(),u!==i?(a=hs(),a!==i?(f=xs(),f!==i?(xi=t,n=$n(r,a),t=n):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i),t}function fs(){var t,n;return ki++,e.substr(Si,5).toLowerCase()===Kn?(t=e.substr(Si,5),Si+=5):(t=i,ki===0&&Hi(Qn)),t===i&&(e.substr(Si,5).toLowerCase()===Gn?(t=e.substr(Si,5),Si+=5):(t=i,ki===0&&Hi(Yn)),t===i&&(e.substr(Si,2).toLowerCase()===Zn?(t=e.substr(Si,2),Si+=2):(t=i,ki===0&&Hi(er)),t===i&&(e.substr(Si,3).toLowerCase()===tr?(t=e.substr(Si,3),Si+=3):(t=i,ki===0&&Hi(nr)),t===i&&(e.substr(Si,9).toLowerCase()===rr?(t=e.substr(Si,9),Si+=9):(t=i,ki===0&&Hi(ir)),t===i&&(e.substr(Si,10).toLowerCase()===sr?(t=e.substr(Si,10),Si+=10):(t=i,ki===0&&Hi(or)),t===i&&(e.substr(Si,9).toLowerCase()===ur?(t=e.substr(Si,9),Si+=9):(t=i,ki===0&&Hi(ar)),t===i&&(e.substr(Si,10).toLowerCase()===fr?(t=e.substr(Si,10),Si+=10):(t=i,ki===0&&Hi(lr)),t===i&&(e.substr(Si,11).toLowerCase()===cr?(t=e.substr(Si,11),Si+=11):(t=i,ki===0&&Hi(hr)),t===i&&(e.substr(Si,12).toLowerCase()===pr?(t=e.substr(Si,12),Si+=12):(t=i,ki===0&&Hi(dr)),t===i&&(e.substr(Si,12).toLowerCase()===vr?(t=e.substr(Si,12),Si+=12):(t=i,ki===0&&Hi(mr)),t===i&&(e.substr(Si,13).toLowerCase()===gr?(t=e.substr(Si,13),Si+=13):(t=i,ki===0&&Hi(yr)),t===i&&(e.substr(Si,12).toLowerCase()===br?(t=e.substr(Si,12),Si+=12):(t=i,ki===0&&Hi(wr)),t===i&&(e.substr(Si,13).toLowerCase()===Er?(t=e.substr(Si,13),Si+=13):(t=i,ki===0&&Hi(Sr)),t===i&&(e.substr(Si,14).toLowerCase()===xr?(t=e.substr(Si,14),Si+=14):(t=i,ki===0&&Hi(Tr)),t===i&&(e.substr(Si,15).toLowerCase()===Nr?(t=e.substr(Si,15),Si+=15):(t=i,ki===0&&Hi(Cr)),t===i&&(e.substr(Si,7).toLowerCase()===kr?(t=e.substr(Si,7),Si+=7):(t=i,ki===0&&Hi(Lr)))))))))))))))))),ki--,t===i&&(n=i,ki===0&&Hi(Jn)),t}function ls(){var t,n,r,s;return t=Si,e.charCodeAt(Si)===34?(n=Ar,Si++):(n=i,ki===0&&Hi(Or)),n!==i?(r=cs(),r!==i?(e.charCodeAt(Si)===34?(s=Ar,Si++):(s=i,ki===0&&Hi(Or)),s!==i?(xi=t,n=Mr(r),t=n):(Si=t,t=i)):(Si=t,t=i)):(Si=t,t=i),t}function cs(){var t,n,r,s;t=[],n=Si,r=Si,ki++,e.charCodeAt(Si)===34?(s=Ar,Si++):(s=i,ki===0&&Hi(Or)),ki--,s===i?r=void 0:(Si=r,r=i),r!==i?(e.substr(Si,2)===_r?(s=_r,Si+=2):(s=i,ki===0&&Hi(Dr)),s===i&&(e.length>Si?(s=e.charAt(Si),Si++):(s=i,ki===0&&Hi(Pr))),s!==i?(xi=n,r=Hr(s),n=r):(Si=n,n=i)):(Si=n,n=i);while(n!==i)t.push(n),n=Si,r=Si,ki++,e.charCodeAt(Si)===34?(s=Ar,Si++):(s=i,ki===0&&Hi(Or)),ki--,s===i?r=void 0:(Si=r,r=i),r!==i?(e.substr(Si,2)===_r?(s=_r,Si+=2):(s=i,ki===0&&Hi(Dr)),s===i&&(e.length>Si?(s=e.charAt(Si),Si++):(s=i,ki===0&&Hi(Pr))),s!==i?(xi=n,r=Hr(s),n=r):(Si=n,n=i)):(Si=n,n=i);return t}function hs(){var t,n,r;ki++,t=Si,n=[],jr.test(e.charAt(Si))?(r=e.charAt(Si),Si++):(r=i,ki===0&&Hi(Fr));if(r!==i)while(r!==i)n.push(r),jr.test(e.charAt(Si))?(r=e.charAt(Si),Si++):(r=i,ki===0&&Hi(Fr));else n=i;return n!==i&&(xi=t,n=Ir(n)),t=n,t===i&&(t=ls()),ki--,t===i&&(n=i,ki===0&&Hi(Br)),t}function ps(){var t,n;return ki++,t=Si,Rr.test(e.charAt(Si))?(n=e.charAt(Si),Si++):(n=i,ki===0&&Hi(Ur)),n!==i&&(xi=t,n=Hr(n)),t=n,ki--,t===i&&(n=i,ki===0&&Hi(qr)),t}function ds(){var t,n;return ki++,t=Si,Wr.test(e.charAt(Si))?(n=e.charAt(Si),Si++):(n=i,ki===0&&Hi(Xr)),n!==i&&(xi=t,n=Hr(n)),t=n,ki--,t===i&&(n=i,ki===0&&Hi(zr)),t}function vs(){var t;return e.substr(Si,2)===Vr?(t=Vr,Si+=2):(t=i,ki===0&&Hi($r)),t}function ms(){var t;return e.substr(Si,2)===Jr?(t=Jr,Si+=2):(t=i,ki===0&&Hi(Kr)),t}function gs(){var t,n,r;return t=Si,n=Si,ki++,e.substr(Si,2)===Jr?(r=Jr,Si+=2):(r=i,ki===0&&Hi(Kr)),ki--,r===i?n=void 0:(Si=n,n=i),n!==i?(e.length>Si?(r=e.charAt(Si),Si++):(r=i,ki===0&&Hi(Pr)),r!==i?(xi=t,n=Hr(r),t=n):(Si=t,t=i)):(Si=t,t=i),t}function ys(){var e,t,n,r;e=Si,t=vs();if(t!==i){n=[],r=gs();while(r!==i)n.push(r),r=gs();n!==i?(r=ms(),r!==i?(xi=e,t=Qr(t,n,r),e=t):(Si=e,e=i)):(Si=e,e=i)}else Si=e,e=i;return e}function bs(){var t;return e.substr(Si,2)===Gr?(t=Gr,Si+=2):(t=i,ki===0&&Hi(Yr)),t===i&&(e.charCodeAt(Si)===35?(t=Zr,Si++):(t=i,ki===0&&Hi(ei))),t}function ws(){var t;return ti.test(e.charAt(Si))?(t=e.charAt(Si),Si++):(t=i,ki===0&&Hi(ni)),t}function Es(){var e,t,n,r;e=Si,t=bs();if(t!==i){n=[],r=ws();while(r!==i)n.push(r),r=ws();n!==i?(xi=e,t=ri(t,n),e=t):(Si=e,e=i)}else Si=e,e=i;return e}function Ss(){var e,t;return ki++,e=Es(),e===i&&(e=ys()),ki--,e===i&&(t=i,ki===0&&Hi(ii)),e}function xs(){var e,t;e=[],t=ps(),t===i&&(t=ds(),t===i&&(t=Ss()));while(t!==i)e.push(t),t=ps(),t===i&&(t=ds(),t===i&&(t=Ss()));return e}function Ts(){var e;return e=Cs(),e===i&&(e=Ns()),e}function Ns(){var t,n,r;ki++,t=Si,n=[],oi.test(e.charAt(Si))?(r=e.charAt(Si),Si++):(r=i,ki===0&&Hi(ui));if(r!==i)while(r!==i)n.push(r),oi.test(e.charAt(Si))?(r=e.charAt(Si),Si++):(r=i,ki===0&&Hi(ui));else n=i;return n!==i&&(xi=t,n=ai(n)),t=n,ki--,t===i&&(n=i,ki===0&&Hi(si)),t}function Cs(){var t,n,r,s,o,u;ki++,t=Si,n=Si,r=[],oi.test(e.charAt(Si))?(s=e.charAt(Si),Si++):(s=i,ki===0&&Hi(ui));if(s!==i)while(s!==i)r.push(s),oi.test(e.charAt(Si))?(s=e.charAt(Si),Si++):(s=i,ki===0&&Hi(ui));else r=i;if(r!==i){e.charCodeAt(Si)===46?(s=li,Si++):(s=i,ki===0&&Hi(ci));if(s!==i){o=[],oi.test(e.charAt(Si))?(u=e.charAt(Si),Si++):(u=i,ki===0&&Hi(ui));if(u!==i)while(u!==i)o.push(u),oi.test(e.charAt(Si))?(u=e.charAt(Si),Si++):(u=i,ki===0&&Hi(ui));else o=i;o!==i?(r=[r,s,o],n=r):(Si=n,n=i)}else Si=n,n=i}else Si=n,n=i;return n!==i&&(xi=t,n=hi(n)),t=n,ki--,t===i&&(n=i,ki===0&&Hi(fi)),t}function ks(){var t,n;return ki++,e.substr(Si,4).toLowerCase()===di?(t=e.substr(Si,4),Si+=4):(t=i,ki===0&&Hi(vi)),t===i&&(e.substr(Si,5).toLowerCase()===mi?(t=e.substr(Si,5),Si+=5):(t=i,ki===0&&Hi(gi)),t===i&&(e.substr(Si,2).toLowerCase()===yi?(t=e.substr(Si,2),Si+=2):(t=i,ki===0&&Hi(bi)),t===i&&(e.substr(Si,3).toLowerCase()===wi?(t=e.substr(Si,3),Si+=3):(t=i,ki===0&&Hi(Ei))))),ki--,t===i&&(n=i,ki===0&&Hi(pi)),t}function Ls(e,t){t&&Object.getOwnPropertyNames(t).forEach(function(n){e[n]=t[n]})}function As(e,t){return e=e?e:{},Ls(e,t),e}function Os(e){var t={};return e[0].forEach(function(e){t=As(t,e)}),As(t,e[1])}function Ms(e){return(["true","on","1"].indexOf(e.toLowerCase())>-1).toString()}function _s(e,t){return t===undefined||t==="*"||e.entities.some(function(e){return e.name===t})}function Ds(e,t){return"Entity '"+e+"' in arc "+"'"+t.from+" "+t.kind+" "+t.to+"' "+"is not defined."}function Ps(e,t){this.name="EntityNotDefinedError",this.message=Ds(e,t),!t.location||(this.location=t.location,this.location.start.line++,this.location.end.line++)}function Hs(e,t){return e||(e={},e.entities=[]),t&&t.arcs&&t.arcs.forEach(function(t){t.forEach(function(t){if(t.from&&!_s(e,t.from))throw new Ps(t.from,t);if(t.to&&!_s(e,t.to))throw new Ps(t.to,t);!t.location||delete t.location,!t.arcs||Hs(e,t)})}),e}function Bs(e){return e&&e.options?e.options.watermark?!0:!1:!1}function js(e){return e&&e.arcs?e.arcs.some(function(e){return e.some(function(e){return["alt","else","opt","break","par","seq","strict","neg","critical","ignore","consider","assert","loop","ref","exc"].indexOf(e.kind)>-1})}):!1}function Fs(e,t){var n=Bs(e),r=js(t);return{extendedOptions:n,extendedArcTypes:r,extendedFeatures:n||r}}var n=arguments.length>1?arguments[1]:{},r=this,i={},s={program:ji},o=ji,u="{",a={type:"literal",value:"{",description:'"{"'},f="}",l={type:"literal",value:"}",description:'"}"'},c=function(e,t){t[1]=Hs(t[1],t[2]);var n=As(t[0],As(t[1],t[2]));return n=As({meta:Fs(t[0],t[2])},n),e.length>0&&(n=As({precomment:e},n)),n},h="msc",p={type:"literal",value:"msc",description:'"msc"'},d=function(e){return{options:e}},v=function(e){return{entities:e}},m=function(e){return{arcs:e}},g=",",y={type:"literal",value:",",description:'","'},b=function(e){return e},w=";",E={type:"literal",value:";",description:'";"'},S=function(e){return Os(e)},x="=",T={type:"literal",value:"=",description:'"="'},N=function(e,t){return t},C=function(e,t){return t.toString()},k=function(e,t){return t.toString()},L=function(e,t){var n={};return e=e.toLowerCase(),e==="wordwraparcs"?n[e]=Ms(t):n[e]=t,n},A="hscale",O={type:"literal",value:"hscale",description:'"hscale"'},M="width",_={type:"literal",value:"width",description:'"width"'},D="arcgradient",P={type:"literal",value:"arcgradient",description:'"arcgradient"'},H="wordwraparcs",B={type:"literal",value:"wordwraparcs",description:'"wordwraparcs"'},j="watermark",F={type:"literal",value:"watermark",description:'"watermark"'},I=function(e){return e},q=function(e){return e[0].push(e[1]),e[0]},R={type:"other",description:"entity"},U="[",z={type:"literal",value:"[",description:'"["'},W="]",X={type:"literal",value:"]",description:'"]"'},V=function(e,t){return t},$=function(e,t){return As({name:e},t)},J=function(e){return e},K=function(e){return[e]},Q=function(e){return e[0].push(e[1][0]),e[0]},G=function(e,t){return t},Y=function(e,t){return As(e,t)},Z=function(e){return{kind:e}},et=function(e,t,n){return{kind:t,from:e,to:n,location:Oi()}},tt="*",nt={type:"literal",value:"*",description:'"*"'},rt=function(e,t){return{kind:e,from:"*",to:t,location:Oi()}},it=function(e,t){return{kind:t,from:e,to:"*",location:Oi()}},st=function(e,t,n,r){return r},ot=function(e,t,n,r,i){var s={kind:t,from:e,to:n,location:Oi(),arcs:i};return As(s,r)},ut="|||",at={type:"literal",value:"|||",description:'"|||"'},ft="...",lt={type:"literal",value:"...",description:'"..."'},ct="---",ht={type:"literal",value:"---",description:'"---"'},pt=function(e){return e.toLowerCase()},dt={type:"other",description:"bi-directional arrow"},vt="--",mt={type:"literal",value:"--",description:'"--"'},gt="<->",yt={type:"literal",value:"<->",description:'"<->"'},bt="==",wt={type:"literal",value:"==",description:'"=="'},Et="<<=>>",St={type:"literal",value:"<<=>>",description:'"<<=>>"'},xt="<=>",Tt={type:"literal",value:"<=>",description:'"<=>"'},Nt="..",Ct={type:"literal",value:"..",description:'".."'},kt="<<>>",Lt={type:"literal",value:"<<>>",description:'"<<>>"'},At="::",Ot={type:"literal",value:"::",description:'"::"'},Mt="<:>",_t={type:"literal",value:"<:>",description:'"<:>"'},Dt={type:"other",description:"left to right arrow"},Pt="->",Ht={type:"literal",value:"->",description:'"->"'},Bt="=>>",jt={type:"literal",value:"=>>",description:'"=>>"'},Ft="=>",It={type:"literal",value:"=>",description:'"=>"'},qt=">>",Rt={type:"literal",value:">>",description:'">>"'},Ut=":>",zt={type:"literal",value:":>",description:'":>"'},Wt="-x",Xt={type:"literal",value:"-x",description:'"-x"'},Vt={type:"other",description:"right to left arrow"},$t="<-",Jt={type:"literal",value:"<-",description:'"<-"'},Kt="<<=",Qt={type:"literal",value:"<<=",description:'"<<="'},Gt="<=",Yt={type:"literal",value:"<=",description:'"<="'},Zt="<<",en={type:"literal",value:"<<",description:'"<<"'},tn="<:",nn={type:"literal",value:"<:",description:'"<:"'},rn="x-",sn={type:"literal",value:"x-",description:'"x-"'},on={type:"other",description:"box"},un="note",an={type:"literal",value:"note",description:'"note"'},fn="abox",ln={type:"literal",value:"abox",description:'"abox"'},cn="rbox",hn={type:"literal",value:"rbox",description:'"rbox"'},pn="box",dn={type:"literal",value:"box",description:'"box"'},vn={type:"other",description:"arc spanning box"},mn="alt",gn={type:"literal",value:"alt",description:'"alt"'},yn="else",bn={type:"literal",value:"else",description:'"else"'},wn="opt",En={type:"literal",value:"opt",description:'"opt"'},Sn="break",xn={type:"literal",value:"break",description:'"break"'},Tn="par",Nn={type:"literal",value:"par",description:'"par"'},Cn="seq",kn={type:"literal",value:"seq",description:'"seq"'},Ln="strict",An={type:"literal",value:"strict",description:'"strict"'},On="neg",Mn={type:"literal",value:"neg",description:'"neg"'},_n="critical",Dn={type:"literal",value:"critical",description:'"critical"'},Pn="ignore",Hn={type:"literal",value:"ignore",description:'"ignore"'},Bn="consider",jn={type:"literal",value:"consider",description:'"consider"'},Fn="assert",In={type:"literal",value:"assert",description:'"assert"'},qn="loop",Rn={type:"literal",value:"loop",description:'"loop"'},Un="ref",zn={type:"literal",value:"ref",description:'"ref"'},Wn="exc",Xn={type:"literal",value:"exc",description:'"exc"'},Vn=function(e){return Os(e)},$n=function(e,t){var n={};return e=e.toLowerCase(),e=e.replace("colour","color"),n[e]=t,n},Jn={type:"other",description:"attribute name"},Kn="label",Qn={type:"literal",value:"label",description:'"label"'},Gn="idurl",Yn={type:"literal",value:"idurl",description:'"idurl"'},Zn="id",er={type:"literal",value:"id",description:'"id"'},tr="url",nr={type:"literal",value:"url",description:'"url"'},rr="linecolor",ir={type:"literal",value:"linecolor",description:'"linecolor"'},sr="linecolour",or={type:"literal",value:"linecolour",description:'"linecolour"'},ur="textcolor",ar={type:"literal",value:"textcolor",description:'"textcolor"'},fr="textcolour",lr={type:"literal",value:"textcolour",description:'"textcolour"'},cr="textbgcolor",hr={type:"literal",value:"textbgcolor",description:'"textbgcolor"'},pr="textbgcolour",dr={type:"literal",value:"textbgcolour",description:'"textbgcolour"'},vr="arclinecolor",mr={type:"literal",value:"arclinecolor",description:'"arclinecolor"'},gr="arclinecolour",yr={type:"literal",value:"arclinecolour",description:'"arclinecolour"'},br="arctextcolor",wr={type:"literal",value:"arctextcolor",description:'"arctextcolor"'},Er="arctextcolour",Sr={type:"literal",value:"arctextcolour",description:'"arctextcolour"'},xr="arctextbgcolor",Tr={type:"literal",value:"arctextbgcolor",description:'"arctextbgcolor"'},Nr="arctextbgcolour",Cr={type:"literal",value:"arctextbgcolour",description:'"arctextbgcolour"'},kr="arcskip",Lr={type:"literal",value:"arcskip",description:'"arcskip"'},Ar='"',Or={type:"literal",value:'"',description:'"\\""'},Mr=function(e){return e.join("")},_r='\\"',Dr={type:"literal",value:'\\"',description:'"\\\\\\""'},Pr={type:"any",description:"any character"},Hr=function(e){return e},Br={type:"other",description:"identifier"},jr=/^[A-Za-z_0-9]/,Fr={type:"class",value:"[A-Za-z_0-9]",description:"[A-Za-z_0-9]"},Ir=function(e){return e.join("")},qr={type:"other",description:"whitespace"},Rr=/^[ \t]/,Ur={type:"class",value:"[ \\t]",description:"[ \\t]"},zr={type:"other",description:"lineend"},Wr=/^[\r\n]/,Xr={type:"class",value:"[\\r\\n]",description:"[\\r\\n]"},Vr="/*",$r={type:"literal",value:"/*",description:'"/*"'},Jr="*/",Kr={type:"literal",value:"*/",description:'"*/"'},Qr=function(e,t,n){return e+t.join("")+n},Gr="//",Yr={type:"literal",value:"//",description:'"//"'},Zr="#",ei={type:"literal",value:"#",description:'"#"'},ti=/^[^\r\n]/,ni={type:"class",value:"[^\\r\\n]",description:"[^\\r\\n]"},ri=function(e,t){return e+t.join("")},ii={type:"other",description:"comment"},si={type:"other",description:"integer"},oi=/^[0-9]/,ui={type:"class",value:"[0-9]",description:"[0-9]"},ai=function(e){return parseInt(e.join(""),10)},fi={type:"other",description:"real"},li=".",ci={type:"literal",value:".",description:'"."'},hi=function(e){return parseFloat(e.join(""))},pi={type:"other",description:"boolean"},di="true",vi={type:"literal",value:"true",description:'"true"'},mi="false",gi={type:"literal",value:"false",description:'"false"'},yi="on",bi={type:"literal",value:"on",description:'"on"'},wi="off",Ei={type:"literal",value:"off",description:'"off"'},Si=0,xi=0,Ti=[{line:1,column:1,seenCR:!1}],Ni=0,Ci=[],ki=0,Li;if("startRule"in n){if(!(n.startRule in s))throw new Error("Can't start parsing from rule \""+n.startRule+'".');o=s[n.startRule]}Li=o();if(Li!==i&&Si===e.length)return Li;throw Li!==i&&Si<e.length&&Hi({type:"end",description:"end of input"}),Bi(null,Ci,Ni<e.length?e.charAt(Ni):null,Ni<e.length?Pi(Ni,Ni+1):Pi(Ni,Ni))}return e(t,Error),{SyntaxError:t,parse:n}}),n("parse/msgennyparser",[],function(){"use strict";function e(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}function t(e,n,r,i){this.message=e,this.expected=n,this.found=r,this.location=i,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,t)}function n(e){function Vr(){return e.substring(qr,Ir)}function $r(){return Gr(qr,Ir)}function Jr(t){throw Zr(null,[{type:"other",description:t}],e.substring(qr,Ir),Gr(qr,Ir))}function Kr(t){throw Zr(t,null,e.substring(qr,Ir),Gr(qr,Ir))}function Qr(t){var n=Rr[t],r,i;if(n)return n;r=t-1;while(!Rr[r])r--;n=Rr[r],n={line:n.line,column:n.column,seenCR:n.seenCR};while(r<t)i=e.charAt(r),i==="\n"?(n.seenCR||n.line++,n.column=1,n.seenCR=!1):i==="\r"||i==="\u2028"||i==="\u2029"?(n.line++,n.column=1,n.seenCR=!0):(n.column++,n.seenCR=!1),r++;return Rr[t]=n,n}function Gr(e,t){var n=Qr(e),r=Qr(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function Yr(e){if(Ir<Ur)return;Ir>Ur&&(Ur=Ir,zr=[]),zr.push(e)}function Zr(e,n,r,i){function s(e){var t=1;e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});while(t<e.length)e[t-1]===e[t]?e.splice(t,1):t++}function o(e,t){function n(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0100-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1000-\uFFFF]/g,function(e){return"\\u"+t(e)})}var r=new Array(e.length),i,s,o;for(o=0;o<e.length;o++)r[o]=e[o].description;return i=e.length>1?r.slice(0,-1).join(", ")+" or "+r[e.length-1]:r[0],s=t?'"'+n(t)+'"':"end of input","Expected "+i+" but "+s+" found."}return n!==null&&s(n),new t(e!==null?e:o(n,r),n,r,i)}function ei(){var e,t,n,r;return e=Ir,t=Ii(),t!==i?(n=ti(),n!==i?(r=Ii(),r!==i?(qr=e,t=u(t,n),e=t):(Ir=e,e=i)):(Ir=e,e=i)):(Ir=e,e=i),e}function ti(){var e,t,n,r,s;return e=Ir,t=Ir,n=ni(),n!==i&&(qr=t,n=a(n)),t=n,t===i&&(t=null),t!==i?(n=Ir,r=si(),r!==i&&(qr=n,r=f(r)),n=r,n===i&&(n=null),n!==i?(r=Ir,s=ui(),s!==i&&(qr=r,s=l(s)),r=s,r===i&&(r=null),r!==i?(t=[t,n,r],e=t):(Ir=e,e=i)):(Ir=e,e=i)):(Ir=e,e=i),e}function ni(){var t,n,r,s,o,u;t=Ir,n=Ir,r=[],s=Ir,o=ri(),o!==i?(e.charCodeAt(Ir)===44?(u=c,Ir++):(u=i,Wr===0&&Yr(h)),u!==i?(qr=s,o=p(o),s=o):(Ir=s,s=i)):(Ir=s,s=i);while(s!==i)r.push(s),s=Ir,o=ri(),o!==i?(e.charCodeAt(Ir)===44?(u=c,Ir++):(u=i,Wr===0&&Yr(h)),u!==i?(qr=s,o=p(o),s=o):(Ir=s,s=i)):(Ir=s,s=i);return r!==i?(s=Ir,o=ri(),o!==i?(e.charCodeAt(Ir)===59?(u=d,Ir++):(u=i,Wr===0&&Yr(v)),u!==i?(qr=s,o=p(o),s=o):(Ir=s,s=i)):(Ir=s,s=i),s!==i?(r=[r,s],n=r):(Ir=n,n=i)):(Ir=n,n=i),n!==i&&(qr=t,n=m(n)),t=n,t}function ri(){var t,n,r,s,o,u,a,f;return t=Ir,n=Ii(),n!==i?(r=ii(),r!==i?(s=Ii(),s!==i?(e.charCodeAt(Ir)===61?(o=g,Ir++):(o=i,Wr===0&&Yr(y)),o!==i?(u=Ii(),u!==i?(a=Ir,f=Ti(),f!==i&&(qr=a,f=b(r,f)),a=f,a===i&&(a=Ir,f=qi(),f!==i&&(qr=a,f=w(r,f)),a=f,a===i&&(a=Ir,f=zi(),f!==i&&(qr=a,f=E(r,f)),a=f)),a!==i?(f=Ii(),f!==i?(qr=t,n=S(r,a),t=n):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i),t}function ii(){var t;return e.substr(Ir,6).toLowerCase()===x?(t=e.substr(Ir,6),Ir+=6):(t=i,Wr===0&&Yr(T)),t===i&&(e.substr(Ir,5).toLowerCase()===N?(t=e.substr(Ir,5),Ir+=5):(t=i,Wr===0&&Yr(C)),t===i&&(e.substr(Ir,11).toLowerCase()===k?(t=e.substr(Ir,11),Ir+=11):(t=i,Wr===0&&Yr(L)),t===i&&(e.substr(Ir,12).toLowerCase()===A?(t=e.substr(Ir,12),Ir+=12):(t=i,Wr===0&&Yr(O)),t===i&&(e.substr(Ir,9).toLowerCase()===M?(t=e.substr(Ir,9),Ir+=9):(t=i,Wr===0&&Yr(_)))))),t}function si(){var t,n,r,s,o,u;t=Ir,n=Ir,r=[],s=Ir,o=oi(),o!==i?(e.charCodeAt(Ir)===44?(u=c,Ir++):(u=i,Wr===0&&Yr(h)),u!==i?(qr=s,o=D(o),s=o):(Ir=s,s=i)):(Ir=s,s=i);while(s!==i)r.push(s),s=Ir,o=oi(),o!==i?(e.charCodeAt(Ir)===44?(u=c,Ir++):(u=i,Wr===0&&Yr(h)),u!==i?(qr=s,o=D(o),s=o):(Ir=s,s=i)):(Ir=s,s=i);return r!==i?(s=Ir,o=oi(),o!==i?(e.charCodeAt(Ir)===59?(u=d,Ir++):(u=i,Wr===0&&Yr(v)),u!==i?(qr=s,o=D(o),s=o):(Ir=s,s=i)):(Ir=s,s=i),s!==i?(r=[r,s],n=r):(Ir=n,n=i)):(Ir=n,n=i),n!==i&&(qr=t,n=P(n)),t=n,t}function oi(){var t,n,r,s,o,u,a,f,l;return Wr++,t=Ir,n=Ii(),n!==i?(r=Li(),r!==i?(s=Ii(),s!==i?(o=Ir,e.charCodeAt(Ir)===58?(u=B,Ir++):(u=i,Wr===0&&Yr(j)),u!==i?(a=Ii(),a!==i?(f=xi(),f!==i?(l=Ii(),l!==i?(qr=o,u=F(r,f),o=u):(Ir=o,o=i)):(Ir=o,o=i)):(Ir=o,o=i)):(Ir=o,o=i),o===i&&(o=null),o!==i?(qr=t,n=I(r,o),t=n):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i),Wr--,t===i&&(n=i,Wr===0&&Yr(H)),t}function ui(){var t,n,r,s,o;t=[],n=Ir,r=ai(),r!==i?(s=Ii(),s!==i?(e.charCodeAt(Ir)===59?(o=d,Ir++):(o=i,Wr===0&&Yr(v)),o!==i?(qr=n,r=q(r),n=r):(Ir=n,n=i)):(Ir=n,n=i)):(Ir=n,n=i);if(n!==i)while(n!==i)t.push(n),n=Ir,r=ai(),r!==i?(s=Ii(),s!==i?(e.charCodeAt(Ir)===59?(o=d,Ir++):(o=i,Wr===0&&Yr(v)),o!==i?(qr=n,r=q(r),n=r):(Ir=n,n=i)):(Ir=n,n=i)):(Ir=n,n=i);else t=i;return t}function ai(){var t,n,r,s,o,u;t=Ir,n=Ir,r=[],s=Ir,o=fi(),o!==i?(e.charCodeAt(Ir)===44?(u=c,Ir++):(u=i,Wr===0&&Yr(h)),u!==i?(qr=s,o=q(o),s=o):(Ir=s,s=i)):(Ir=s,s=i);while(s!==i)r.push(s),s=Ir,o=fi(),o!==i?(e.charCodeAt(Ir)===44?(u=c,Ir++):(u=i,Wr===0&&Yr(h)),u!==i?(qr=s,o=q(o),s=o):(Ir=s,s=i)):(Ir=s,s=i);return r!==i?(s=Ir,o=fi(),o!==i&&(qr=s,o=R(o)),s=o,s!==i?(r=[r,s],n=r):(Ir=n,n=i)):(Ir=n,n=i),n!==i&&(qr=t,n=U(n)),t=n,t}function fi(){var e;return e=li(),e===i&&(e=di()),e}function li(){var t,n,r,s,o,u,a;return t=Ir,n=Ir,r=ci(),r!==i&&(qr=n,r=z(r)),n=r,n===i&&(n=Ir,r=pi(),r!==i&&(qr=n,r=W(r)),n=r,n===i&&(n=Ir,r=hi(),r!==i&&(qr=n,r=X(r)),n=r)),n!==i?(r=Ir,e.charCodeAt(Ir)===58?(s=B,Ir++):(s=i,Wr===0&&Yr(j)),s!==i?(o=Ii(),o!==i?(u=xi(),u!==i?(a=Ii(),a!==i?(qr=r,s=V(n,u),r=s):(Ir=r,r=i)):(Ir=r,r=i)):(Ir=r,r=i)):(Ir=r,r=i),r===i&&(r=null),r!==i?(qr=t,n=$(n,r),t=n):(Ir=t,t=i)):(Ir=t,t=i),t}function ci(){var e,t,n,r;return e=Ir,t=Ii(),t!==i?(n=vi(),n!==i?(r=Ii(),r!==i?(qr=e,t=J(n),e=t):(Ir=e,e=i)):(Ir=e,e=i)):(Ir=e,e=i),e}function hi(){var e,t,n,r;return e=Ir,t=Ii(),t!==i?(n=mi(),n!==i?(r=Ii(),r!==i?(qr=e,t=J(n),e=t):(Ir=e,e=i)):(Ir=e,e=i)):(Ir=e,e=i),e}function pi(){var t,n,r,s,o,u,a,f;return t=Ir,n=Ii(),n!==i?(r=Li(),r!==i?(s=Ii(),s!==i?(o=gi(),o!==i?(u=Ii(),u!==i?(a=Li(),a!==i?(f=Ii(),f!==i?(qr=t,n=K(r,o,a),t=n):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i),t===i&&(t=Ir,n=Ii(),n!==i?(e.charCodeAt(Ir)===42?(r=Q,Ir++):(r=i,Wr===0&&Yr(G)),r!==i?(s=Ii(),s!==i?(o=wi(),o!==i?(u=Ii(),u!==i?(a=Li(),a!==i?(f=Ii(),f!==i?(qr=t,n=Y(o,a),t=n):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i),t===i&&(t=Ir,n=Ii(),n!==i?(r=Li(),r!==i?(s=Ii(),s!==i?(o=bi(),o!==i?(u=Ii(),u!==i?(e.charCodeAt(Ir)===42?(a=Q,Ir++):(a=i,Wr===0&&Yr(G)),a!==i?(f=Ii(),f!==i?(qr=t,n=Z(r,o),t=n):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i),t===i&&(t=Ir,n=Ii(),n!==i?(r=Li(),r!==i?(s=Ii(),s!==i?(o=yi(),o!==i?(u=Ii(),u!==i?(e.charCodeAt(Ir)===42?(a=Q,Ir++):(a=i,Wr===0&&Yr(G)),a!==i?(f=Ii(),f!==i?(qr=t,n=Z(r,o),t=n):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)))),t}function di(){var t,n,r,s,o,u,a,f,l,c,h,p,d,v,m;return t=Ir,n=Ii(),n!==i?(r=Li(),r!==i?(s=Ii(),s!==i?(o=Si(),o!==i?(u=Ii(),u!==i?(a=Li(),a!==i?(f=Ii(),f!==i?(l=Ir,e.charCodeAt(Ir)===58?(c=B,Ir++):(c=i,Wr===0&&Yr(j)),c!==i?(h=Ii(),h!==i?(p=xi(),p!==i?(d=Ii(),d!==i?(qr=l,c=et(r,o,a,p),l=c):(Ir=l,l=i)):(Ir=l,l=i)):(Ir=l,l=i)):(Ir=l,l=i),l===i&&(l=null),l!==i?(e.charCodeAt(Ir)===123?(c=tt,Ir++):(c=i,Wr===0&&Yr(nt)),c!==i?(h=Ii(),h!==i?(p=ui(),p===i&&(p=null),p!==i?(d=Ii(),d!==i?(e.charCodeAt(Ir)===125?(v=rt,Ir++):(v=i,Wr===0&&Yr(it)),v!==i?(m=Ii(),m!==i?(qr=t,n=st(r,o,a,l,p),t=n):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i),t}function vi(){var t;return e.substr(Ir,3)===ot?(t=ot,Ir+=3):(t=i,Wr===0&&Yr(ut)),t===i&&(e.substr(Ir,3)===at?(t=at,Ir+=3):(t=i,Wr===0&&Yr(ft))),t}function mi(){var t;return e.substr(Ir,3)===lt?(t=lt,Ir+=3):(t=i,Wr===0&&Yr(ct)),t}function gi(){var e,t;return e=Ir,t=yi(),t===i&&(t=bi(),t===i&&(t=wi(),t===i&&(t=Ei()))),t!==i&&(qr=e,t=ht(t)),e=t,e}function yi(){var t,n;return Wr++,e.substr(Ir,2)===dt?(t=dt,Ir+=2):(t=i,Wr===0&&Yr(vt)),t===i&&(e.substr(Ir,3)===mt?(t=mt,Ir+=3):(t=i,Wr===0&&Yr(gt)),t===i&&(e.substr(Ir,2)===yt?(t=yt,Ir+=2):(t=i,Wr===0&&Yr(bt)),t===i&&(e.substr(Ir,5)===wt?(t=wt,Ir+=5):(t=i,Wr===0&&Yr(Et)),t===i&&(e.substr(Ir,3)===St?(t=St,Ir+=3):(t=i,Wr===0&&Yr(xt)),t===i&&(e.substr(Ir,2)===Tt?(t=Tt,Ir+=2):(t=i,Wr===0&&Yr(Nt)),t===i&&(e.substr(Ir,4)===Ct?(t=Ct,Ir+=4):(t=i,Wr===0&&Yr(kt)),t===i&&(e.substr(Ir,2)===Lt?(t=Lt,Ir+=2):(t=i,Wr===0&&Yr(At)),t===i&&(e.substr(Ir,3)===Ot?(t=Ot,Ir+=3):(t=i,Wr===0&&Yr(Mt)))))))))),Wr--,t===i&&(n=i,Wr===0&&Yr(pt)),t}function bi(){var t,n;return Wr++,e.substr(Ir,2)===Dt?(t=Dt,Ir+=2):(t=i,Wr===0&&Yr(Pt)),t===i&&(e.substr(Ir,3)===Ht?(t=Ht,Ir+=3):(t=i,Wr===0&&Yr(Bt)),t===i&&(e.substr(Ir,2)===jt?(t=jt,Ir+=2):(t=i,Wr===0&&Yr(Ft)),t===i&&(e.substr(Ir,2)===It?(t=It,Ir+=2):(t=i,Wr===0&&Yr(qt)),t===i&&(e.substr(Ir,2)===Rt?(t=Rt,Ir+=2):(t=i,Wr===0&&Yr(Ut)),t===i&&(e.substr(Ir,2).toLowerCase()===zt?(t=e.substr(Ir,2),Ir+=2):(t=i,Wr===0&&Yr(Wt))))))),Wr--,t===i&&(n=i,Wr===0&&Yr(_t)),t}function wi(){var t,n;return Wr++,e.substr(Ir,2)===Vt?(t=Vt,Ir+=2):(t=i,Wr===0&&Yr($t)),t===i&&(e.substr(Ir,3)===Jt?(t=Jt,Ir+=3):(t=i,Wr===0&&Yr(Kt)),t===i&&(e.substr(Ir,2)===Qt?(t=Qt,Ir+=2):(t=i,Wr===0&&Yr(Gt)),t===i&&(e.substr(Ir,2)===Yt?(t=Yt,Ir+=2):(t=i,Wr===0&&Yr(Zt)),t===i&&(e.substr(Ir,2)===en?(t=en,Ir+=2):(t=i,Wr===0&&Yr(tn)),t===i&&(e.substr(Ir,2).toLowerCase()===nn?(t=e.substr(Ir,2),Ir+=2):(t=i,Wr===0&&Yr(rn))))))),Wr--,t===i&&(n=i,Wr===0&&Yr(Xt)),t}function Ei(){var t,n;return Wr++,e.substr(Ir,4).toLowerCase()===on?(t=e.substr(Ir,4),Ir+=4):(t=i,Wr===0&&Yr(un)),t===i&&(e.substr(Ir,4).toLowerCase()===an?(t=e.substr(Ir,4),Ir+=4):(t=i,Wr===0&&Yr(fn)),t===i&&(e.substr(Ir,4).toLowerCase()===ln?(t=e.substr(Ir,4),Ir+=4):(t=i,Wr===0&&Yr(cn)),t===i&&(e.substr(Ir,3).toLowerCase()===hn?(t=e.substr(Ir,3),Ir+=3):(t=i,Wr===0&&Yr(pn))))),Wr--,t===i&&(n=i,Wr===0&&Yr(sn)),t}function Si(){var t,n;return Wr++,t=Ir,e.substr(Ir,3).toLowerCase()===vn?(n=e.substr(Ir,3),Ir+=3):(n=i,Wr===0&&Yr(mn)),n===i&&(e.substr(Ir,4).toLowerCase()===gn?(n=e.substr(Ir,4),Ir+=4):(n=i,Wr===0&&Yr(yn)),n===i&&(e.substr(Ir,3).toLowerCase()===bn?(n=e.substr(Ir,3),Ir+=3):(n=i,Wr===0&&Yr(wn)),n===i&&(e.substr(Ir,5).toLowerCase()===En?(n=e.substr(Ir,5),Ir+=5):(n=i,Wr===0&&Yr(Sn)),n===i&&(e.substr(Ir,3).toLowerCase()===xn?(n=e.substr(Ir,3),Ir+=3):(n=i,Wr===0&&Yr(Tn)),n===i&&(e.substr(Ir,3).toLowerCase()===Nn?(n=e.substr(Ir,3),Ir+=3):(n=i,Wr===0&&Yr(Cn)),n===i&&(e.substr(Ir,6).toLowerCase()===kn?(n=e.substr(Ir,6),Ir+=6):(n=i,Wr===0&&Yr(Ln)),n===i&&(e.substr(Ir,3).toLowerCase()===An?(n=e.substr(Ir,3),Ir+=3):(n=i,Wr===0&&Yr(On)),n===i&&(e.substr(Ir,8).toLowerCase()===Mn?(n=e.substr(Ir,8),Ir+=8):(n=i,Wr===0&&Yr(_n)),n===i&&(e.substr(Ir,6).toLowerCase()===Dn?(n=e.substr(Ir,6),Ir+=6):(n=i,Wr===0&&Yr(Pn)),n===i&&(e.substr(Ir,8).toLowerCase()===Hn?(n=e.substr(Ir,8),Ir+=8):(n=i,Wr===0&&Yr(Bn)),n===i&&(e.substr(Ir,6).toLowerCase()===jn?(n=e.substr(Ir,6),Ir+=6):(n=i,Wr===0&&Yr(Fn)),n===i&&(e.substr(Ir,4).toLowerCase()===In?(n=e.substr(Ir,4),Ir+=4):(n=i,Wr===0&&Yr(qn)),n===i&&(e.substr(Ir,3).toLowerCase()===Rn?(n=e.substr(Ir,3),Ir+=3):(n=i,Wr===0&&Yr(Un)),n===i&&(e.substr(Ir,3).toLowerCase()===zn?(n=e.substr(Ir,3),Ir+=3):(n=i,Wr===0&&Yr(Wn)))))))))))))))),n!==i&&(qr=t,n=ht(n)),t=n,Wr--,t===i&&(n=i,Wr===0&&Yr(dn)),t}function xi(){var e;return e=Ti(),e===i&&(e=Ci()),e}function Ti(){var t,n,r,s;return t=Ir,e.charCodeAt(Ir)===34?(n=Xn,Ir++):(n=i,Wr===0&&Yr(Vn)),n!==i?(r=Ni(),r!==i?(e.charCodeAt(Ir)===34?(s=Xn,Ir++):(s=i,Wr===0&&Yr(Vn)),s!==i?(qr=t,n=$n(r),t=n):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i),t}function Ni(){var t,n,r,s;t=[],n=Ir,r=Ir,Wr++,e.charCodeAt(Ir)===34?(s=Xn,Ir++):(s=i,Wr===0&&Yr(Vn)),Wr--,s===i?r=void 0:(Ir=r,r=i),r!==i?(e.substr(Ir,2)===Jn?(s=Jn,Ir+=2):(s=i,Wr===0&&Yr(Kn)),s===i&&(e.length>Ir?(s=e.charAt(Ir),Ir++):(s=i,Wr===0&&Yr(Qn))),s!==i?(qr=n,r=Gn(s),n=r):(Ir=n,n=i)):(Ir=n,n=i);while(n!==i)t.push(n),n=Ir,r=Ir,Wr++,e.charCodeAt(Ir)===34?(s=Xn,Ir++):(s=i,Wr===0&&Yr(Vn)),Wr--,s===i?r=void 0:(Ir=r,r=i),r!==i?(e.substr(Ir,2)===Jn?(s=Jn,Ir+=2):(s=i,Wr===0&&Yr(Kn)),s===i&&(e.length>Ir?(s=e.charAt(Ir),Ir++):(s=i,Wr===0&&Yr(Qn))),s!==i?(qr=n,r=Gn(s),n=r):(Ir=n,n=i)):(Ir=n,n=i);return t}function Ci(){var e,t;return e=Ir,t=ki(),t!==i&&(qr=e,t=Yn(t)),e=t,e}function ki(){var t,n,r,s;t=[],n=Ir,r=Ir,Wr++,e.charCodeAt(Ir)===44?(s=c,Ir++):(s=i,Wr===0&&Yr(h)),s===i&&(e.charCodeAt(Ir)===59?(s=d,Ir++):(s=i,Wr===0&&Yr(v)),s===i&&(e.charCodeAt(Ir)===123?(s=tt,Ir++):(s=i,Wr===0&&Yr(nt)))),Wr--,s===i?r=void 0:(Ir=r,r=i),r!==i?(e.length>Ir?(s=e.charAt(Ir),Ir++):(s=i,Wr===0&&Yr(Qn)),s!==i?(qr=n,r=Gn(s),n=r):(Ir=n,n=i)):(Ir=n,n=i);while(n!==i)t.push(n),n=Ir,r=Ir,Wr++,e.charCodeAt(Ir)===44?(s=c,Ir++):(s=i,Wr===0&&Yr(h)),s===i&&(e.charCodeAt(Ir)===59?(s=d,Ir++):(s=i,Wr===0&&Yr(v)),s===i&&(e.charCodeAt(Ir)===123?(s=tt,Ir++):(s=i,Wr===0&&Yr(nt)))),Wr--,s===i?r=void 0:(Ir=r,r=i),r!==i?(e.length>Ir?(s=e.charAt(Ir),Ir++):(s=i,Wr===0&&Yr(Qn)),s!==i?(qr=n,r=Gn(s),n=r):(Ir=n,n=i)):(Ir=n,n=i);return t}function Li(){var t,n,r;Wr++,t=Ir,n=[],er.test(e.charAt(Ir))?(r=e.charAt(Ir),Ir++):(r=i,Wr===0&&Yr(tr));if(r!==i)while(r!==i)n.push(r),er.test(e.charAt(Ir))?(r=e.charAt(Ir),Ir++):(r=i,Wr===0&&Yr(tr));else n=i;return n!==i&&(qr=t,n=nr(n)),t=n,t===i&&(t=Ti()),Wr--,t===i&&(n=i,Wr===0&&Yr(Zn)),t}function Ai(){var t,n;return Wr++,t=Ir,ir.test(e.charAt(Ir))?(n=e.charAt(Ir),Ir++):(n=i,Wr===0&&Yr(sr)),n!==i&&(qr=t,n=Gn(n)),t=n,Wr--,t===i&&(n=i,Wr===0&&Yr(rr)),t}function Oi(){var t,n;return Wr++,t=Ir,ur.test(e.charAt(Ir))?(n=e.charAt(Ir),Ir++):(n=i,Wr===0&&Yr(ar)),n!==i&&(qr=t,n=Gn(n)),t=n,Wr--,t===i&&(n=i,Wr===0&&Yr(or)),t}function Mi(){var t;return e.substr(Ir,2)===fr?(t=fr,Ir+=2):(t=i,Wr===0&&Yr(lr)),t}function _i(){var t;return e.substr(Ir,2)===cr?(t=cr,Ir+=2):(t=i,Wr===0&&Yr(hr)),t}function Di(){var t,n,r;return t=Ir,n=Ir,Wr++,e.substr(Ir,2)===cr?(r=cr,Ir+=2):(r=i,Wr===0&&Yr(hr)),Wr--,r===i?n=void 0:(Ir=n,n=i),n!==i?(e.length>Ir?(r=e.charAt(Ir),Ir++):(r=i,Wr===0&&Yr(Qn)),r!==i?(qr=t,n=Gn(r),t=n):(Ir=t,t=i)):(Ir=t,t=i),t}function Pi(){var e,t,n,r;e=Ir,t=Mi();if(t!==i){n=[],r=Di();while(r!==i)n.push(r),r=Di();n!==i?(r=_i(),r!==i?(qr=e,t=pr(t,n,r),e=t):(Ir=e,e=i)):(Ir=e,e=i)}else Ir=e,e=i;return e}function Hi(){var t;return e.substr(Ir,2)===dr?(t=dr,Ir+=2):(t=i,Wr===0&&Yr(vr)),t===i&&(e.charCodeAt(Ir)===35?(t=mr,Ir++):(t=i,Wr===0&&Yr(gr))),t}function Bi(){var t;return yr.test(e.charAt(Ir))?(t=e.charAt(Ir),Ir++):(t=i,Wr===0&&Yr(br)),t}function ji(){var e,t,n,r;e=Ir,t=Hi();if(t!==i){n=[],r=Bi();while(r!==i)n.push(r),r=Bi();n!==i?(qr=e,t=wr(t,n),e=t):(Ir=e,e=i)}else Ir=e,e=i;return e}function Fi(){var e,t;return Wr++,e=ji(),e===i&&(e=Pi()),Wr--,e===i&&(t=i,Wr===0&&Yr(Er)),e}function Ii(){var e,t;e=[],t=Ai(),t===i&&(t=Oi(),t===i&&(t=Fi()));while(t!==i)e.push(t),t=Ai(),t===i&&(t=Oi(),t===i&&(t=Fi()));return e}function qi(){var e;return e=Ui(),e===i&&(e=Ri()),e}function Ri(){var t,n,r;Wr++,t=Ir,n=[],xr.test(e.charAt(Ir))?(r=e.charAt(Ir),Ir++):(r=i,Wr===0&&Yr(Tr));if(r!==i)while(r!==i)n.push(r),xr.test(e.charAt(Ir))?(r=e.charAt(Ir),Ir++):(r=i,Wr===0&&Yr(Tr));else n=i;return n!==i&&(qr=t,n=Nr(n)),t=n,Wr--,t===i&&(n=i,Wr===0&&Yr(Sr)),t}function Ui(){var t,n,r,s,o,u;Wr++,t=Ir,n=Ir,r=[],xr.test(e.charAt(Ir))?(s=e.charAt(Ir),Ir++):(s=i,Wr===0&&Yr(Tr));if(s!==i)while(s!==i)r.push(s),xr.test(e.charAt(Ir))?(s=e.charAt(Ir),Ir++):(s=i,Wr===0&&Yr(Tr));else r=i;if(r!==i){e.charCodeAt(Ir)===46?(s=kr,Ir++):(s=i,Wr===0&&Yr(Lr));if(s!==i){o=[],xr.test(e.charAt(Ir))?(u=e.charAt(Ir),Ir++):(u=i,Wr===0&&Yr(Tr));if(u!==i)while(u!==i)o.push(u),xr.test(e.charAt(Ir))?(u=e.charAt(Ir),Ir++):(u=i,Wr===0&&Yr(Tr));else o=i;o!==i?(r=[r,s,o],n=r):(Ir=n,n=i)}else Ir=n,n=i}else Ir=n,n=i;return n!==i&&(qr=t,n=Ar(n)),t=n,Wr--,t===i&&(n=i,Wr===0&&Yr(Cr)),t}function zi(){var t,n;return Wr++,e.substr(Ir,4).toLowerCase()===Mr?(t=e.substr(Ir,4),Ir+=4):(t=i,Wr===0&&Yr(_r)),t===i&&(e.substr(Ir,5).toLowerCase()===Dr?(t=e.substr(Ir,5),Ir+=5):(t=i,Wr===0&&Yr(Pr)),t===i&&(e.substr(Ir,2).toLowerCase()===Hr?(t=e.substr(Ir,2),Ir+=2):(t=i,Wr===0&&Yr(Br)),t===i&&(e.substr(Ir,3).toLowerCase()===jr?(t=e.substr(Ir,3),Ir+=3):(t=i,Wr===0&&Yr(Fr))))),Wr--,t===i&&(n=i,Wr===0&&Yr(Or)),t}function Wi(e,t){t&&Object.getOwnPropertyNames(t).forEach(function(n){e[n]=t[n]})}function Xi(e,t){return e=e?e:{},Wi(e,t),e}function Vi(e){var t={};return e[0].forEach(function(e){t=Xi(t,e)}),Xi(t,e[1])}function $i(e){return(["true","on","1"].indexOf(e.toLowerCase())>-1).toString()}function Ji(e,t,n){return t===undefined||t==="*"?!0:e.entities.some(function(e){return e.name===t})?!0:n[t]===!0}function Ki(e){var t={};return t.name=e,t}function Qi(e,t,n){return e||(e={},e.entities=[]),n||(n={}),t&&t.arcs&&t.arcs.forEach(function(t){t.forEach(function(t){Ji(e,t.from,n)||(e.entities[e.entities.length]=Ki(t.from)),t.arcs&&(n[t.to]=!0,Xi(e,Qi(e,t,n)),delete n[t.to]),Ji(e,t.to,n)||(e.entities[e.entities.length]=Ki(t.to))})}),e}function Gi(e){return e&&e.options?e.options.watermark?!0:!1:!1}function Yi(e){return e&&e.arcs?e.arcs.some(function(e){return e.some(function(e){return["alt","else","opt","break","par","seq","strict","neg","critical","ignore","consider","assert","loop","ref","exc"].indexOf(e.kind)>-1})}):!1}function Zi(e,t){var n=Gi(e),r=Yi(t);return{extendedOptions:n,extendedArcTypes:r,extendedFeatures:n||r}}var n=arguments.length>1?arguments[1]:{},r=this,i={},s={program:ei},o=ei,u=function(e,t){t[1]=Qi(t[1],t[2]);var n=Xi(t[0],Xi(t[1],t[2]));return n=Xi({meta:Zi(t[0],t[2])},n),e.length>0&&(n=Xi({precomment:e},n)),n},a=function(e){return{options:e}},f=function(e){return{entities:e}},l=function(e){return{arcs:e}},c=",",h={type:"literal",value:",",description:'","'},p=function(e){return e},d=";",v={type:"literal",value:";",description:'";"'},m=function(e){return Vi(e)},g="=",y={type:"literal",value:"=",description:'"="'},b=function(e,t){return t},w=function(e,t){return t.toString()},E=function(e,t){return t.toString()},S=function(e,t){var n={};return e=e.toLowerCase(),e==="wordwraparcs"?n[e]=$i(t):n[e]=t,n},x="hscale",T={type:"literal",value:"hscale",description:'"hscale"'},N="width",C={type:"literal",value:"width",description:'"width"'},k="arcgradient",L={type:"literal",value:"arcgradient",description:'"arcgradient"'},A="wordwraparcs",O={type:"literal",value:"wordwraparcs",description:'"wordwraparcs"'},M="watermark",_={type:"literal",value:"watermark",description:'"watermark"'},D=function(e){return e},P=function(e){return e[0].push(e[1]),e[0]},H={type:"other",description:"entity"},B=":",j={type:"literal",value:":",description:'":"'},F=function(e,t){return t},I=function(e,t){var n={};return n.name=e,!t||(n.label=t),n},q=function(e){return e},R=function(e){return[e]},U=function(e){return e[0].push(e[1][0]),e[0]},z=function(e){return e},W=function(e){return e},X=function(e){return e},V=function(e,t){return t},$=function(e,t){return t&&(e.label=t),e},J=function(e){return{kind:e}},K=function(e,t,n){return{kind:t,from:e,to:n}},Q="*",G={type:"literal",value:"*",description:'"*"'},Y=function(e,t){return{kind:e,from:"*",to:t}},Z=function(e,t){return{kind:t,from:e,to:"*"}},et=function(e,t,n,r){return r},tt="{",nt={type:"literal",value:"{",description:'"{"'},rt="}",it={type:"literal",value:"}",description:'"}"'},st=function(e,t,n,r,i){var s={kind:t,from:e,to:n,arcs:i};return r&&(s.label=r),s},ot="|||",ut={type:"literal",value:"|||",description:'"|||"'},at="...",ft={type:"literal",value:"...",description:'"..."'},lt="---",ct={type:"literal",value:"---",description:'"---"'},ht=function(e){return e.toLowerCase()},pt={type:"other",description:"bi-directional arrow"},dt="--",vt={type:"literal",value:"--",description:'"--"'},mt="<->",gt={type:"literal",value:"<->",description:'"<->"'},yt="==",bt={type:"literal",value:"==",description:'"=="'},wt="<<=>>",Et={type:"literal",value:"<<=>>",description:'"<<=>>"'},St="<=>",xt={type:"literal",value:"<=>",description:'"<=>"'},Tt="..",Nt={type:"literal",value:"..",description:'".."'},Ct="<<>>",kt={type:"literal",value:"<<>>",description:'"<<>>"'},Lt="::",At={type:"literal",value:"::",description:'"::"'},Ot="<:>",Mt={type:"literal",value:"<:>",description:'"<:>"'},_t={type:"other",description:"left to right arrow"},Dt="->",Pt={type:"literal",value:"->",description:'"->"'},Ht="=>>",Bt={type:"literal",value:"=>>",description:'"=>>"'},jt="=>",Ft={type:"literal",value:"=>",description:'"=>"'},It=">>",qt={type:"literal",value:">>",description:'">>"'},Rt=":>",Ut={type:"literal",value:":>",description:'":>"'},zt="-x",Wt={type:"literal",value:"-x",description:'"-x"'},Xt={type:"other",description:"right to left arrow"},Vt="<-",$t={type:"literal",value:"<-",description:'"<-"'},Jt="<<=",Kt={type:"literal",value:"<<=",description:'"<<="'},Qt="<=",Gt={type:"literal",value:"<=",description:'"<="'},Yt="<<",Zt={type:"literal",value:"<<",description:'"<<"'},en="<:",tn={type:"literal",value:"<:",description:'"<:"'},nn="x-",rn={type:"literal",value:"x-",description:'"x-"'},sn={type:"other",description:"box"},on="note",un={type:"literal",value:"note",description:'"note"'},an="abox",fn={type:"literal",value:"abox",description:'"abox"'},ln="rbox",cn={type:"literal",value:"rbox",description:'"rbox"'},hn="box",pn={type:"literal",value:"box",description:'"box"'},dn={type:"other",description:"arc spanning box"},vn="alt",mn={type:"literal",value:"alt",description:'"alt"'},gn="else",yn={type:"literal",value:"else",description:'"else"'},bn="opt",wn={type:"literal",value:"opt",description:'"opt"'},En="break",Sn={type:"literal",value:"break",description:'"break"'},xn="par",Tn={type:"literal",value:"par",description:'"par"'},Nn="seq",Cn={type:"literal",value:"seq",description:'"seq"'},kn="strict",Ln={type:"literal",value:"strict",description:'"strict"'},An="neg",On={type:"literal",value:"neg",description:'"neg"'},Mn="critical",_n={type:"literal",value:"critical",description:'"critical"'},Dn="ignore",Pn={type:"literal",value:"ignore",description:'"ignore"'},Hn="consider",Bn={type:"literal",value:"consider",description:'"consider"'},jn="assert",Fn={type:"literal",value:"assert",description:'"assert"'},In="loop",qn={type:"literal",value:"loop",description:'"loop"'},Rn="ref",Un={type:"literal",value:"ref",description:'"ref"'},zn="exc",Wn={type:"literal",value:"exc",description:'"exc"'},Xn='"',Vn={type:"literal",value:'"',description:'"\\""'},$n=function(e){return e.join("")},Jn='\\"',Kn={type:"literal",value:'\\"',description:'"\\\\\\""'},Qn={type:"any",description:"any character"},Gn=function(e){return e},Yn=function(e){return e.join("").trim()},Zn={type:"other",description:"identifier"},er=/^[^;, "\t\n\r=\-><:{*]/,tr={type:"class",value:'[^;, \\"\\t\\n\\r=\\-><:\\{\\*]',description:'[^;, \\"\\t\\n\\r=\\-><:\\{\\*]'},nr=function(e){return e.join("")},rr={type:"other",description:"whitespace"},ir=/^[ \t]/,sr={type:"class",value:"[ \\t]",description:"[ \\t]"},or={type:"other",description:"lineend"},ur=/^[\r\n]/,ar={type:"class",value:"[\\r\\n]",description:"[\\r\\n]"},fr="/*",lr={type:"literal",value:"/*",description:'"/*"'},cr="*/",hr={type:"literal",value:"*/",description:'"*/"'},pr=function(e,t,n){return e+t.join("")+n},dr="//",vr={type:"literal",value:"//",description:'"//"'},mr="#",gr={type:"literal",value:"#",description:'"#"'},yr=/^[^\r\n]/,br={type:"class",value:"[^\\r\\n]",description:"[^\\r\\n]"},wr=function(e,t){return e+t.join("")},Er={type:"other",description:"comment"},Sr={type:"other",description:"integer"},xr=/^[0-9]/,Tr={type:"class",value:"[0-9]",description:"[0-9]"},Nr=function(e){return parseInt(e.join(""),10)},Cr={type:"other",description:"real"},kr=".",Lr={type:"literal",value:".",description:'"."'},Ar=function(e){return parseFloat(e.join(""))},Or={type:"other",description:"boolean"},Mr="true",_r={type:"literal",value:"true",description:'"true"'},Dr="false",Pr={type:"literal",value:"false",description:'"false"'},Hr="on",Br={type:"literal",value:"on",description:'"on"'},jr="off",Fr={type:"literal",value:"off",description:'"off"'},Ir=0,qr=0,Rr=[{line:1,column:1,seenCR:!1}],Ur=0,zr=[],Wr=0,Xr;if("startRule"in n){if(!(n.startRule in s))throw new Error("Can't start parsing from rule \""+n.startRule+'".');o=s[n.startRule]}Xr=o();if(Xr!==i&&Ir===e.length)return Xr;throw Xr!==i&&Ir<e.length&&Yr({type:"end",description:"end of input"}),Zr(null,zr,Ur<e.length?e.charAt(Ur):null,Ur<e.length?Gr(Ur,Ur+1):Gr(Ur,Ur))}return e(t,Error),{SyntaxError:t,parse:n}}),n("render/graphics/constants",[],function(){"use strict";return{SVGNS:"http://www.w3.org/2000/svg",XLINKNS:"http://www.w3.org/1999/xlink",LINE_WIDTH:2,FONT_SIZE:12}}),n("render/graphics/svgelementfactory",["./constants"],function(e){"use strict";function r(e){return t.createTextNode(e)}function i(n,r,i,s){var o=t.createElementNS(e.SVGNS,"path");return o.setAttribute("d",n),r&&o.setAttribute("class",r),u(o,i,s),o}function s(n,r){var i=t.createElementNS(e.SVGNS,"polygon");return i.setAttribute("points",n),r&&i.setAttribute("class",r),i}function o(n,r,i,s,o,a){var f=t.createElementNS(e.SVGNS,"rect");return f.setAttribute("width",n.width),f.setAttribute("height",n.height),n.x&&f.setAttribute("x",n.x),n.y&&f.setAttribute("y",n.y),o&&f.setAttribute("rx",o),a&&f.setAttribute("ry",a),r&&f.setAttribute("class",r),u(f,i,s),f}function u(e,t,n){if(!!t||!!n){var r="";n&&(r+="fill:"+n+";"),t&&(r+="stroke:"+t+";"),e.setAttribute("style",r)}}function a(e,t,n,r){var s=3;return i("M"+e.x+","+e.y+"l"+s+", -"+e.height/2+"l"+(e.width-2*s)+",0"+"l"+s+","+e.height/2+"l-"+s+","+e.height/2+"l-"+(e.width-2*s)+",0 "+"l-"+s+",-"+e.height/2,t,n,r)}function f(t,n,r,s){var o=Math.max(9,Math.min(4.5*e.LINE_WIDTH,t.height/2)),u=o.toString(10);return i("M"+t.x+","+t.y+"l"+(t.width-o)+",0 "+"l0,"+u+" l"+u+",0 m-"+u+",-"+u+" l"+u+","+u+" "+"l0,"+(t.height-o)+" "+"l-"+t.width+",0 "+"l0,-"+(t.height+e.LINE_WIDTH/2)+" ",n,r,s)}function l(e,t,n,r,s){var o=s?s:7;return i("M"+e.x+","+e.y+" l"+e.width+",0 "+" l0,"+(e.height-o)+" l-"+o.toString(10)+","+o.toString(10)+" l-"+(e.width-o)+",0 ",t,n,r)}function c(n,r){var i=t.createElementNS(e.SVGNS,"a");return i.setAttributeNS(e.XLINKNS,"xlink:href",n),i.setAttributeNS(e.XLINKNS,"xlink:title",n),i.setAttributeNS(e.XLINKNS,"xlink:show","new"),i.appendChild(r),i}function h(n,r){var i=t.createElementNS(e.SVGNS,"tspan"),s=t.createTextNode(n);return i.appendChild(s),r?c(r,i):i}function p(r,i,s,o,u,a,f){var l=t.createElementNS(e.SVGNS,"text");if(!!r&&r!==""){l.setAttribute("x",i.toString()),l.setAttribute("y",s.toString()),o&&l.setAttribute("class",o),l.appendChild(h(r,u));if(a){var c=h(" ["+a+"]",f);c.setAttribute("style",n),l.appendChild(c)}}return l}function d(e,t){var n=p(e,t.width/2,t.height/2,"watermark"),r=0-Math.atan(t.height/t.width)*360/(2*Math.PI);return n.setAttribute("transform","rotate("+r.toString()+" "+(t.width/2).toString()+" "+(t.height/2).toString()+")"),n}function v(n,r){var i=t.createElementNS(e.SVGNS,"line");return i.setAttribute("x1",n.xFrom.toString()),i.setAttribute("y1",n.yFrom.toString()),i.setAttribute("x2",n.xTo.toString()),i.setAttribute("y2",n.yTo.toString()),r&&i.setAttribute("class",r),i}function m(e){var t=-1;return e.xTo>e.xFrom&&(t=1),{dx:t,dy:t*(e.yTo-e.yFrom)/(e.xTo-e.xFrom)}}function g(t,n){var r=0;return n!=="nodi"&&(r=t.xTo>t.xFrom?-7.5*e.LINE_WIDTH:7.5*e.LINE_WIDTH),r}function y(t,n){var r=0;return n!=="nodi"&&(r=n==="bidi"?t.xTo>t.xFrom?7.5*e.LINE_WIDTH:-7.5*e.LINE_WIDTH:0),r}function b(t,n){var r=e.LINE_WIDTH,s=m(t),o=g(t,n),u=y(t,n),a=(t.xTo-t.xFrom+o-u).toString(),f=(t.yTo-t.yFrom).toString(),l="l"+s.dx.toString()+","+s.dy.toString(),c=" l"+a+","+f;return i("M"+t.xFrom.toString()+","+(t.yFrom-7.5*e.LINE_WIDTH*s.dy).toString()+l+"M"+(t.xFrom+u).toString()+","+(t.yFrom-r).toString()+c+"M"+(t.xFrom+u).toString()+","+(t.yFrom+r).toString()+c+"M"+(t.xTo-s.dx).toString()+","+(t.yTo+7.5*e.LINE_WIDTH*s.dy).toString()+l,n)}function w(e,t,n){return n?b(e,t):v(e,t)}function E(t,n,r,s){var o=s?t.x+7.5*e.LINE_WIDTH:t.x;return i("M"+t.x.toString()+", -"+t.y.toString()+" C"+(t.x+r).toString()+","+(t.y-7.5*e.LINE_WIDTH).toString()+" "+(t.x+r).toString()+","+(n+0).toString()+" "+o.toString()+","+n.toString())}function S(n){var r=t.createElementNS(e.SVGNS,"g");return!n||r.setAttribute("id",n),r}function x(n,r,i){var s=t.createElementNS(e.SVGNS,"use");return s.setAttribute("x",n.toString()),s.setAttribute("y",r.toString()),s.setAttributeNS(e.XLINKNS,"xlink:href","#"+i),s}function T(n,r,i,s){var o=s?s:"0 0 10 10",u=t.createElementNS(e.SVGNS,"marker");return u.setAttribute("orient",i),u.setAttribute("id",n),u.setAttribute("class",r),u.setAttribute("viewBox",o),u.setAttribute("refX","9"),u.setAttribute("refY","3"),u.setAttribute("markerUnits","strokeWidth"),u.setAttribute("markerWidth","10"),u.setAttribute("markerHeight","10"),u}function N(e,t,n){var r=T(e,"arrow-marker","auto"),s=i(t,"arrow-style");return s.setAttribute("style","stroke-dasharray:100,1; stroke : "+n||"black"),r.appendChild(s),r}function C(e,t,n){var r=T(e,"arrow-marker","auto"),i=s(t,"arrow-style");return i.setAttribute("stroke",n||"black"),i.setAttribute("fill",n||"black"),r.appendChild(i),r}var t,n="vertical-align : text-top;";return n+="font-size: 0.7em; text-anchor: start;",{init:function(e){t=e},createTextNode:r,createRect:o,createABox:a,createNote:f,createEdgeRemark:l,createText:p,createDiagonalText:d,createLine:w,createUTurn:E,createGroup:S,createUse:x,createMarkerPath:N,createMarkerPolygon:C}}),n("render/graphics/idmanager",[],function(){"use strict";var e="mscgen_js-svg-",t=e;return{setPrefix:function(n){t=e+n},get:function(e){return e?t+e:t}}}),n("utl/utensils",[],function(){"use strict";function e(e,t){return e!==null&&hasOwnProperty.call(e,t)}function t(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}return{flatten:function(e){var t=[];return t.concat.apply(t,e)},clone:function(t){return JSON.parse(JSON.stringify(t))},memoize:function(t){var n=function(r){var i=n.lCache,s=""+r;return e(i,s)||(i[s]=t.apply(this,arguments)),i[s]};return n.lCache={},n},swapfromto:function(e){t(e,"from","to")},sanitizeBooleanesque:function(e){return["1","true","y","yes","on"].indexOf(e)>-1},formatNumber:function(e,t){var n=e.toString(),r=t-n.length;for(var i=0;i<r;i++)n=" "+n;return n}}}),n("render/graphics/svgutensils",["./constants","./idmanager","../../utl/utensils"],function(e,t,n){"use strict";function s(t){var n=r.createElementNS(e.SVGNS,"svg");return n.setAttribute("version","1.1"),n.setAttribute("xmlns",e.SVGNS),n.setAttribute("xmlns:xlink",e.XLINKNS),n.setAttribute("id",t),n.setAttribute("width",0),n.setAttribute("height",0),r.body.appendChild(n),n}function o(e){var t=r.getElementById(i);t=t?t:s(i),t.appendChild(e);var n=e.getBBox();return t.removeChild(e),n}function u(e){var t=1e5;return Math.abs(e.height)>t||Math.abs(e.width)>t?{height:0,width:0,x:0,y:0}:e}function a(e){return typeof e.getBBox=="function"?u(o(e)):{height:15,width:15,x:2,y:2}}function f(t){var n=r.createElementNS(e.SVGNS,"tspan");return n.appendChild(r.createTextNode(t)),n}function l(t){var n=r.createElementNS(e.SVGNS,"text");return n.setAttribute("x","0"),n.setAttribute("y","0"),n.appendChild(f(t)),n}function c(){return a(l("ÁjyÎ9ƒ@💩")).height}function h(e){t.setPrefix(e);var n=r.getElementById(t.get());if(!!n){var i=r.getElementById(e);i?i.removeChild(n):r.body.removeChild(n)}}var r,i=t.get("bboxer");return{init:function(e){r=e},removeRenderedSVGFromElement:h,getBBox:a,calculateTextHeight:n.memoize(c)}}),n("render/graphics/renderutensils",[],function(){"use strict";function e(e,t){t.scale=e/t.width,t.width*=t.scale,t.height*=t.scale,t.horizontaltransform*=t.scale,t.verticaltransform*=t.scale,t.x=0-t.horizontaltransform,t.y=0-t.verticaltransform}function t(e,t){return e?2*(e+1)*2*t:0}function n(e,t,n){return"-x"===e?t+(n-t)*.75:n}return{scaleCanvasToWidth:e,determineDepthCorrection:t,determineArcXTo:n}}),n("render/graphics/renderskeleton",["./svgelementfactory","./constants"],function(e,t){"use strict";function r(t,n){return n.forEach(function(n){n.type==="method"?t.appendChild(e.createMarkerPolygon(n.name,n.path,n.color)):t.appendChild(e.createMarkerPath(n.name,n.path,n.color))}),t}function i(){var e=n.createElement("style");return e.setAttribute("type","text/css"),e.appendChild(n.createTextNode(c())),e}function s(e){var r=n.createElementNS(t.SVGNS,"svg");return r.setAttribute("version","1.1"),r.setAttribute("id",e),r.setAttribute("xmlns",t.SVGNS),r.setAttribute("xmlns:xlink",t.XLINKNS),r}function o(s,o){var u=n.createElementNS(t.SVGNS,"defs");return u.appendChild(i()),u=r(u,o),u.appendChild(e.createGroup(s+"__defs")),u}function u(e){var r=n.createElementNS(t.SVGNS,"desc");return r.setAttribute("id",e+"__msc_source"),r}function a(t){var n=e.createGroup(t+"__body");return n.appendChild(e.createGroup(t+"__background")),n.appendChild(e.createGroup(t+"__arcspanlayer")),n.appendChild(e.createGroup(t+"__lifelinelayer")),n.appendChild(e.createGroup(t+"__sequencelayer")),n.appendChild(e.createGroup(t+"__notelayer")),n.appendChild(e.createGroup(t+"__watermark")),n}function f(t){return e.init(t.document),t.document}function l(e,t,r,i){n=f(i);var l=n.getElementById(e);l===null&&(l=n.body);var c=s(t);return c.appendChild(u(t)),c.appendChild(o(t,r)),c.appendChild(a(t)),l.appendChild(c),n}function c(){return"svg{  font-family:Helvetica,sans-serif;  font-size:"+t.FONT_SIZE+"px;  font-weight:normal;  font-style:normal;  text-decoration:none;  background-color:white;  stroke:black;  color:black;}rect{  fill:none;  stroke:black;  stroke-width:"+t.LINE_WIDTH+";}.bglayer{  fill:white;  stroke:white;  stroke-width:0;}rect.textbg{  fill:white;  stroke:white;  stroke-width:0;  opacity:0.9;}line{  stroke:black;  stroke-width:"+t.LINE_WIDTH+";}.arcrowomit{  stroke-dasharray:2,2;}text{  color:inherit;  stroke:none;  text-anchor:middle;}text.entity{  text-decoration:underline;}text.anchor-start{  text-anchor:start;}path{  stroke:black;  color:black;  stroke-width:"+t.LINE_WIDTH+";  fill:none;}.dotted{  stroke-dasharray:5,2;}.striped{  stroke-dasharray:10,5;}.arrow-marker{  overflow:visible;}.arrow-style{  stroke-width:1;}.arcrowomit{  stroke-dasharray:2,2;}.box{  /* fill: #ffc;  no-inherit */  fill:white;  opacity:0.9;}.boxtext, .arctext{  font-size:0.8em;  text-anchor:middle;}.comment{  stroke-dasharray:5,2;} .inherit{  stroke:inherit;  color:inherit;} .inherit-fill{  fill:inherit;}.watermark{  stroke:black;  color:black;  fill:black;  font-size: 48pt;  font-weight:bold;  opacity:0.14;}"}var n;return{bootstrap:l,init:f}}),n("render/text/asttransform",[],function(){"use strict";function e(e,t){e&&t&&e.forEach(function(e){t.forEach(function(t){t(e)})})}function t(e,t,n,r){r&&r.forEach(function(r){r(n,e,t)})}function n(e,n,i){n.forEach(function(s){t(e,n,s,i),s.arcs&&r(e,s.arcs,i)})}function r(e,t,r){e&&t&&r&&t.forEach(function(t){n(e,t,r)})}function i(t,n,i){return e(t.entities,n),r(t.entities,t.arcs,i),t}return{transform:i}}),n("render/text/arcmappings",[],function(){"use strict";var e={"->":"rvee","<->":"rvee","=>":"normal","<=>":"normal","-x":"oinvonormal"},t={box:"box",abox:"hexagon",rbox:"box",note:"note"},n={">>":"dashed","<<>>":"dashed","..":"dashed",":>":"bold","<:>":"bold","::":"bold",rbox:"rounded"},r={"|||":"emptyarc","...":"emptyarc","---":"emptyarc","->":"directional","=>":"directional","=>>":"directional",">>":"directional",":>":"directional","-x":"directional",note:"box",box:"box",abox:"box",rbox:"box","<->":"bidirectional","<=>":"bidirectional","<<=>>":"bidirectional","<<>>":"bidirectional","<:>":"bidirectional","--":"nondirectional","==":"nondirectional","..":"nondirectional","::":"nondirectional",alt:"inline_expression","else":"inline_expression",opt:"inline_expression","break":"inline_expression",par:"inline_expression",seq:"inline_expression",strict:"inline_expression",neg:"inline_expression",critical:"inline_expression",ignore:"inline_expression",consider:"inline_expression",assert:"inline_expression",loop:"inline_expression",ref:"inline_expression",exc:"inline_expression"},i={"<-":"->","<=":"=>","<<=":"=>>","<<":">>","<:":":>","x-":"-x"};return{getArrow:function(t){return e[t]},getShape:function(e){return t[e]},getStyle:function(e){return n[e]},getAggregate:function(e){return r[e]},getNormalizedKind:function(e){return i[e]?i[e]:e}}}),n("render/text/textutensils",[],function(){"use strict";return{wrap:function(e,t){var n=0,r=[],i=0,s=0,o=0,u=0,a=e.replace(/[\t\n]+/g," ").replace(/\\n/g,"\n");while(u<=a.length)u>=a.length?r.push(a.substring(i,u)):a[u]==="\n"?(n=0,o=u,r.push(a.substring(i,o)),i=o+1):n++>=t&&(o=a.substring(0,u).lastIndexOf(" "),o===-1||o<i?(n=1,o=u,s=u):(n=0,s=o+1),r.push(a.substring(i,o)),i=s),u++;return r},unescapeString:function(e){return e.replace(/\\\"/g,'"')},escapeString:function(e){return e.replace(/\\\"/g,'"').replace(/\"/g,'\\"')}}}),n("render/text/flatten",["./asttransform","./arcmappings","../../utl/utensils","./textutensils"],function(e,t,n,r){"use strict";function s(e){e.label===undefined&&(e.label=e.name)}function o(e){!e.label||(e.label=r.unescapeString(e.label)),!e.id||(e.id=r.unescapeString(e.id))}function u(e){e.label=e.label?e.label:""}function a(e){if(e.kind&&t.getNormalizedKind(e.kind)!==e.kind){e.kind=t.getNormalizedKind(e.kind);var n=e.from;e.from=e.to,e.to=n}return e}function f(e,t){!e.linecolor&&t.arclinecolor&&(e.linecolor=t.arclinecolor),!e.textcolor&&t.arctextcolor&&(e.textcolor=t.arctextcolor),!e.textbgcolor&&t.arctextbgcolor&&(e.textbgcolor=t.arctextbgcolor)}function l(e,t){if(e&&e.from){var n=t.filter(function(t){return t.name===e.from});n.length>0&&f(e,n[0])}}function c(e){return e.arcs.reduce(function(e,t){return e+(t[0].arcs?c(t[0])+1:0)},e.arcs.length)}function h(e,r,s,o,u){var a={};"inline_expression"===t.getAggregate(e[0].kind)?(a=n.clone(e[0]),a.arcs?(a.numberofrows=c(a),delete a.arcs,r.arcs.push([a]),e[0].arcs.forEach(function(e){h(e,r,s+1,a.from,a.to),e.forEach(function(e){f(e,a)})}),s>i&&(i=s)):r.arcs.push([a]),r.arcs.push([{kind:"|||",from:a.from,to:a.to}]),a.depth=s):(o&&u&&e.filter(function(e){return"emptyarc"===t.getAggregate(e.kind)}).forEach(function(e){e.from=o,e.to=u,e.depth=s}),r.arcs.push(e))}function p(e){var t={};return i=0,!e.options||(t.options=n.clone(e.options)),!e.entities||(t.entities=n.clone(e.entities)),t.arcs=[],e&&e.arcs&&e.arcs.forEach(function(e){h(e,t,0)}),t.depth=i+1,t}function d(e,t){return e.filter(function(e){return t.from!==e.name}).map(function(e){return t.to=e.name,n.clone(t)})}function v(e){if(e.entities&&e.arcs){var t=[],r={};e.arcs.forEach(function(i,s){i.filter(function(e){return e.to==="*"}).forEach(function(o,u){r=n.clone(o),delete e.arcs[s][u],t=d(e.entities,r),i[u]=t.shift(),e.arcs[s]=i.concat(t)})})}return e}var i=0;return{swapRTLArc:a,unwind:p,explodeBroadcasts:v,flatten:function(t){return e.transform(p(t),[s,o],[a,l,o,u])},dotFlatten:function(t){return v(e.transform(t,[s],[a,l]))}}}),n("render/graphics/rowmemory",[],function(){"use strict";function r(r,i){e=[],t=r,n=i}function i(r){return e[r]?e[r]:{y:t+1.5*n+r*n,height:n}}function s(){return i(e.length-1)}function o(t,r,s){if(r===undefined||r<n)r=n;if(s===undefined){var o=i(t-1);o&&o.y>0&&(s=o.y+(o.height+r)/2)}e[t]={y:s,height:r}}var e=[],t=0,n=0;return{clear:r,get:i,getLast:s,set:o}}),n("render/graphics/markermanager",["../../utl/utensils","../text/arcmappings"],function(e,t){"use strict";function i(e,t,n){if(t&&n&&["<->","->"].indexOf(e>-1))return t<n?"signal":"signal-u"}function s(e,t,n){return"<->"===e&&t<=n?"signal-l":"signal-lu"}function o(e,t,r,o,u){var a=[];return n[t]&&n[t].attributes&&(a=n[t].attributes.map(function(n){return{name:n.name,value:n.value.replace(/\{\{signal-marker-end\}\}/g,i(t,o,u)).replace(/\{\{signal-marker-start\}\}/g,s(t,o,u)).replace(/\{\{id\}\}/g,e).replace(/\{\{color\}\}/g,r||"black")}})),a}function u(e,r){return n[t.getNormalizedKind(e)].marker.name+(r?" "+r:" black")}function a(e,r){function i(t){a(e,t)}return Array.isArray(r)&&r.forEach(i),!r.arcs||r.arcs.forEach(i),!!r.kind&&!!n[t.getNormalizedKind(r.kind)]&&!!n[t.getNormalizedKind(r.kind)].marker&&e.indexOf(u(r.kind,r.linecolor))<0&&e.push(u(r.kind,r.linecolor)),e}function f(e){return{kind:e.split(" ")[0],color:e.split(" ")[1]}}function l(e){return e.arcs.reduce(a,[]).sort().map(f)}var n={"->":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}{{signal-marker-end}}-{{color}})"}],marker:{name:"signal"}},"<->":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}{{signal-marker-end}}-{{color}})"},{name:"marker-start",value:"url(#{{id}}{{signal-marker-start}}-{{color}})"}],marker:{name:"signal"}},"=>>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}callback-{{color}})"}],marker:{name:"callback",end:""}},"<<=>>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}callback-{{color}})"},{name:"marker-start",value:"url(#{{id}}callback-l-{{color}})"}],marker:{name:"callback",end:"",start:"-l"}},">>":{attributes:[{name:"style",value:"stroke:{{color}};stroke-dasharray:5,2;"},{name:"marker-end",value:"url(#{{id}}callback-{{color}})"}],marker:{name:"callback",end:""}},"<<>>":{attributes:[{name:"style",value:"stroke:{{color}};stroke-dasharray:5,2;"},{name:"marker-end",value:"url(#{{id}}callback-{{color}})"},{name:"marker-start",value:"url(#{{id}}callback-l-{{color}})"}],marker:{name:"callback",end:"",start:"-l"}},"..":{attributes:[{name:"style",value:"stroke:{{color}};stroke-dasharray:5,2;"}]},"--":{attributes:[{name:"style",value:"stroke:{{color}};"}]},"==":{attributes:[{name:"style",value:"stroke:{{color}};"}]},"::":{attributes:[{name:"style",value:"stroke:{{color}};"}]},"=>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}method-{{color}})"}],marker:{name:"method",end:""}},"<=>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}method-{{color}})"},{name:"marker-start",value:"url(#{{id}}method-l-{{color}})"}],marker:{name:"method",end:"",start:"-l"}},":>":{attributes:[{name:"style",value:"stroke:{{color}};"},{name:"marker-end",value:"url(#{{id}}method-{{color}})"}],marker:{name:"method",end:""}},"<:>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}method-{{color}})"},{name:"marker-start",value:"url(#{{id}}method-l-{{color}})"}],marker:{name:"method",end:"",start:"-l"}},"-x":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}lost-{{color}})"}],marker:{name:"lost",end:""}}},r={signal:{variants:[{name:"",path:"M9,3 l-8, 2"},{name:"-u",path:"M9,3 l-8,-2"},{name:"-l",path:"M9,3 l 8, 2"},{name:"-lu",path:"M9,3 l 8,-2"}]},method:{variants:[{name:"",path:"1,1  9,3  1,5"},{name:"-l",path:"17,1 9,3 17,5"}]},callback:{variants:[{name:"",path:"M 1,1 l 8,2 l-8,2"},{name:"-l",path:"M17,1 l-8,2 l 8,2"}]},lost:{variants:[{name:"",path:"M7,0 l5,6 M7,6 l5,-6"}]}};return{getAttributes:o,getMarkerDefs:function(t,n){return e.flatten(l(n).map(function(e){return r[e.kind].variants.map(function(n){return{name:t+e.kind+n.name+"-"+e.color,path:n.path,color:e.color,type:e.kind}})}))}}}),n("render/graphics/renderlabels",["./svgelementfactory","./svgutensils","./constants","../text/textutensils","../text/arcmappings"],function(e,t,n,r,i){"use strict";function s(e,t){t&&e.setAttribute("style","fill:"+t+";")}function o(e,t,n){s(e,t&&!n?"blue":n)}function u(n,r){var i=e.createRect(t.getBBox(n),"textbg");return r&&i.setAttribute("style","fill: "+r+"; stroke:"+r+";"),i}function a(t,n,r,i,s,o){var u={};return t===0?u=e.createText(n,r,i,s,o.url,o.id,o.idurl):u=e.createText(n,r,i,s,o.url),u}function f(e,r,i,u,f,l){var c=i+(f+.25)*t.calculateTextHeight(),h;!l||(l.underline&&(h="entity"),l.alignLeft&&(h="anchor-start"),l.alignAround&&(c=i+(f+.25)*(t.calculateTextHeight()+n.LINE_WIDTH)));var p=a(f,e,r,c,h,u);return s(p,u.textcolor),o(p,u.url,u.textcolor),p}function l(r,i,s,o){var a=e.createGroup(o);if(r.label){var l=i.x+i.width/2,c=h(r.label,r.kind,i.width,n.FONT_SIZE,s?s.wordWrapArcs:!1),p={};!!s&&s.alignAbove&&c.forEach(function(){c.push("")});var d=i.y-(c.length-1)/2*(t.calculateTextHeight()+1);!!s&&s.alignAround&&(c.length===1&&c.push(""),d=i.y-(c.length-1)/2*(t.calculateTextHeight()+n.LINE_WIDTH+1)),c.forEach(function(e,t){e!==""&&(p=f(e,l,d,r,t,s),!!s&&s.ownBackground&&a.appendChild(u(p,r.textbgcolor)),a.appendChild(p)),d++})}return a}function c(e,t){var n=Math.abs(e),r=12;return n<=160?n/(t/r*8):n<=320?n/(t/r*6.4):n<=480?n/(t/r*5.9):n/(t/r*5.6)}function h(e,t,n,s,o){return"box"===i.getAggregate(t)||undefined===t||o?r.wrap(e,c(n,s)):e.split("\\n")}return{createLabel:l,splitLabel:h}}),n("render/graphics/entities",["./renderlabels","./constants"],function(e,t){"use strict";function u(e){s.interEntitySpacing=n,s.height=i,s.width=r,e&&e.hscale&&(s.interEntitySpacing=e.hscale*n,s.width=e.hscale*r),o={}}function a(e,t){return{from:f(e),to:f(t)}}function f(e){return o[e]}function l(e,t){o[e.name]=t+s.width/2}function c(){return s}function h(e){s.height=e}var n=160,r=100,i=34,s={interEntitySpacing:n,height:i,width:r},o={};return{init:u,getX:f,setX:l,getOAndD:a,setHeight:h,getDims:c,getNoEntityLines:function(n){return e.splitLabel(n,"box",s.width,t.FONT_SIZE).length}}}),n("render/graphics/renderast",["./svgelementfactory","./svgutensils","./renderutensils","./renderskeleton","../text/flatten","../text/arcmappings","../../utl/utensils","./rowmemory","./idmanager","./markermanager","./entities","./renderlabels","./constants"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";function y(e,t,n,r){var s=i.flatten(e);b(s,t,n,r),w(s),E(s)}function b(e,n,i,s){a.setPrefix(i),m.document=r.bootstrap(i,a.get(),f.getMarkerDefs(a.get(),e),s),t.init(m.document),S(m,e.depth),N(m,e.options),C(m,n)}function w(e){H(e.entities),u.clear(l.getDims().height,m.arcRowHeight),j(e.arcs,e.entities)}function E(e){var t=k(e);L(m,t),O(e.options,t),M(t)}function S(e,t){x(e.layer,e.document),e.maxDepth=t?t:0}function x(e,t){e.defs=t.getElementById(a.get("__defs")),e.lifeline=t.getElementById(a.get("__lifelinelayer")),e.sequence=t.getElementById(a.get("__sequencelayer")),e.notes=t.getElementById(a.get("__notelayer")),e.inline=t.getElementById(a.get("__arcspanlayer")),e.watermark=t.getElementById(a.get("__watermark"))}function T(e,t){e.arcRowHeight=d,e.arcGradient=v,e.wordWrapArcs=!1,t&&(t.arcgradient&&(e.arcRowHeight=parseInt(t.arcgradient,10)+d,e.arcGradient=parseInt(t.arcgradient,10)+v),t.wordwraparcs&&t.wordwraparcs==="true"&&(e.wordWrapArcs=!0))}function N(e,t){l.init(t),T(e,t)}function C(t,n){if(n){var r=e.createTextNode("\n\n# Generated by mscgen_js - https://sverweij.github.io/mscgen_js\n"+n);t.document.getElementById(a.get("__msc_source")).appendChild(r)}}function k(e){var t=n.determineDepthCorrection(e.depth,h.LINE_WIDTH),r=u.getLast(),i={width:e.entities.length*l.getDims().interEntitySpacing+t,height:r.y+r.height/2+2*p,horizontaltransform:(l.getDims().interEntitySpacing+t-l.getDims().width)/2,verticaltransform:p,scale:1};return i.x=0-i.horizontaltransform,i.y=0-i.verticaltransform,i}function L(t,n){var r=e.createRect(n,"bglayer");t.document.getElementById(a.get("__background")).appendChild(r)}function A(t,n){m.layer.watermark.appendChild(e.createDiagonalText(t,n))}function O(e,t){e&&(e.watermark&&A(e.watermark,t),e.width&&n.scaleCanvasToWidth(e.width,t))}function M(e){var t=m.document.getElementById(a.get()),n=m.document.getElementById(a.get("__body"));n.setAttribute("transform","translate("+e.horizontaltransform+","+e.verticaltransform+")"+" scale("+e.scale+","+e.scale+")"),t.setAttribute("width",e.width.toString()),t.setAttribute("height",e.height.toString())}function _(e){var n=e[0],r=2;return e.forEach(function(e){var t=l.getNoEntityLines(e.label);t>r&&(r=t,n=e)}),r>2?Math.max(l.getDims().height,t.getBBox(D(n)).height):l.getDims().height}function D(t){var n=e.createGroup(a.get(t.name)),r=l.getDims(),i=c.createLabel(t,{x:0,y:r.height/2,width:r.width},{underline:!0}),s=e.createRect(r,null,t.linecolor,t.textbgcolor);return n.appendChild(s),n.appendChild(i),n}function P(t,n){m.layer.defs.appendChild(D(t)),m.layer.sequence.appendChild(e.createUse(n,0,a.get(t.name)))}function H(e){var t=0;e&&(l.setHeight(_(e)+h.LINE_WIDTH*2),e.forEach(function(e){P(e,t),l.setX(e,t),t+=l.getDims().interEntitySpacing})),m.arcEndX=t-l.getDims().interEntitySpacing+l.getDims().width}function B(n,r,i){var o=!1,f=[];u.set(r),n.forEach(function(e,n){var p=a.get(r.toString()+"_"+n.toString()),d;switch(s.getAggregate(e.kind)){case"emptyarc":d=z(e,p),o="..."===e.kind,f.push({id:p,layer:m.layer.sequence});break;case"box":d=J(p,l.getOAndD(e.from,e.to),e),f.push({id:p,layer:m.layer.notes});break;case"inline_expression":d=F(p+"_label",e),f.push({id:p+"_label",layer:m.layer.notes}),g.push({id:p,arc:e,rownum:r});break;default:if(e.from&&e.to){var v=0,y=0;if(e.to==="*"){var b=e.label;y=l.getX(e.from),i.forEach(function(t,n){t.name!==e.from&&(v=l.getX(t.name),e.label="",m.layer.defs.appendChild(X(p+"bc"+n,e,y,v)),f.push({id:p+"bc"+n,layer:m.layer.sequence}))}),e.label=b,d=c.createLabel(e,{x:0,y:0,width:m.arcEndX},{alignAround:!0,ownBackground:!0,wordWrapArcs:m.wordWrapArcs},p+"_lbl"),f.push({id:p+"_lbl",layer:m.layer.sequence})}else d=X(p,e,l.getX(e.from),l.getX(e.to)),f.push({id:p,layer:m.layer.sequence})}}d&&(u.set(r,Math.max(u.get(r).height,t.getBBox(d).height+2*h.LINE_WIDTH)),m.layer.defs.appendChild(d))});var p="arcrow_"+r.toString(),d="arcrow";o&&(d="arcrowomit"),m.layer.defs.appendChild(R(i,d,u.get(r).height,a.get(p))),m.layer.lifeline.appendChild(e.createUse(0,u.get(r).y,a.get(p))),f.forEach(function(t){t.layer.appendChild(e.createUse(0,u.get(r).y,t.id))})}function j(t,n){g=[],m.layer.defs.appendChild(R(n,a.get("arcrow"))),m.layer.lifeline.appendChild(e.createUse(0,u.get(-1).y,a.get("arcrow")));if(t){for(var r=0;r<t.length;r++)B(t[r],r,n);I(g)}}function F(n,r){var i={from:l.getX(r.from),to:l.getX(r.to)},s=7;i.from>i.to&&o.swapfromto(i);var u=i.to-i.from+(l.getDims().interEntitySpacing-2*h.LINE_WIDTH)-s-h.LINE_WIDTH,a=i.from-(l.getDims().interEntitySpacing-3*h.LINE_WIDTH)/2-(m.maxDepth-r.depth)*2*h.LINE_WIDTH,f=e.createGroup(n);r.label=r.kind+(r.label?": "+r.label:"");var p=c.createLabel(r,{x:a+h.LINE_WIDTH-u/2,y:m.arcRowHeight/4,width:u},{alignLeft:!0,ownBackground:!1,wordWrapArcs:m.wordWrapArcs}),d=t.getBBox(p),v=Math.max(d.height+2*h.LINE_WIDTH,m.arcRowHeight/2-2*h.LINE_WIDTH),g=Math.min(d.width+2*h.LINE_WIDTH,u),y=e.createEdgeRemark({width:g-h.LINE_WIDTH+s,height:v,x:a,y:0},"box",r.linecolor,r.textbgcolor,s);return f.appendChild(y),f.appendChild(p),f}function I(t){t.forEach(function(t){m.layer.defs.appendChild(q(t)),m.layer.inline.appendChild(e.createUse(0,u.get(t.rownum).y,t.id))})}function q(e){var t=u.get(e.rownum).y,n=u.get(e.rownum+e.arc.numberofrows+1).y,r=n-t;return e.arc.label="",J(e.id,l.getOAndD(e.arc.from,e.arc.to),e.arc,r)}function R(t,n,r,i){i||(i=n);if(!r||r<m.arcRowHeight)r=m.arcRowHeight;var s=e.createGroup(i);return t.forEach(function(t){var i=e.createLine({xFrom:l.getX(t.name),yFrom:0-r/2,xTo:l.getX(t.name),yTo:r/2},n);t.linecolor&&i.setAttribute("style","stroke : "+t.linecolor+";"),s.appendChild(i)}),s}function U(t,n,r,i,s){var o=2*(m.arcRowHeight/5),u=l.getDims().interEntitySpacing/2,c={};if(i){c=e.createGroup();var p=e.createUTurn({x:n,y:o/2},r+o-2*h.LINE_WIDTH,u-2*h.LINE_WIDTH,t!=="::"),d=e.createUTurn({x:n,y:o/2},r+o-h.LINE_WIDTH,u),v=e.createUTurn({x:n,y:o/2},r+o,u,t!=="::");p.setAttribute("style","stroke:"+s),f.getAttributes(a.get(),t,s,n,n).forEach(function(e){d.setAttribute(e.name,e.value)}),d.setAttribute("style","stroke:transparent;"),v.setAttribute("style","stroke:"+s),c.appendChild(p),c.appendChild(v),c.appendChild(d)}else c=e.createUTurn({x:n,y:o/2},r+o,u,t==="-x"),f.getAttributes(a.get(),t,s,n,n).forEach(function(e){c.setAttribute(e.name,e.value)});return c}function z(e,t){var n;e.from&&e.to&&l.getX(e.from)>l.getX(e.to)&&o.swapfromto(e);switch(e.kind){case"...":case"|||":n=V(t,e);break;case"---":n=$(t,e)}return n}function W(e){return e.arcskip?e.arcskip*m.arcRowHeight:0}function X(t,r,i,s){var o=e.createGroup(t),u=r.kind==="<:>"?"bidi":r.kind==="::"?"nodi":"",p=[":>","::","<:>"].indexOf(r.kind)>-1,d=W(r),v=d===0?m.arcGradient:d;s=n.determineArcXTo(r.kind,i,s);if(i===s){o.appendChild(U(r.kind,i,d,p,r.linecolor));var g=2*l.getDims().interEntitySpacing/3;o.appendChild(c.createLabel(r,{x:i+1.5*h.LINE_WIDTH-g/2,y:0-m.arcRowHeight/5-h.LINE_WIDTH/2,width:g},{alignLeft:!0,alignAbove:!0,ownBackground:!0,wordWrapArcs:m.wordWrapArcs}))}else{var y=e.createLine({xFrom:i,yFrom:0,xTo:s,yTo:v},u,p);f.getAttributes(a.get(),r.kind,r.linecolor,i,s).forEach(function(e){y.setAttribute(e.name,e.value)}),o.appendChild(y),o.appendChild(c.createLabel(r,{x:i,y:0,width:s-i},{alignAround:!0,ownBackground:!0,wordWrapArcs:m.wordWrapArcs}))}return o}function V(t,n){var r=0,i=m.arcEndX,s=e.createGroup(t);return n.from&&n.to&&(r=l.getX(n.from),i=Math.abs(l.getX(n.to)-l.getX(n.from))),s.appendChild(c.createLabel(n,{x:r,y:0,width:i},{ownBackground:!0,wordWrapArcs:m.wordWrapArcs},t+"_lbl")),s}function $(t,n){var r=0,i=m.arcEndX,s="dotted",o=e.createGroup(t);if(n.from&&n.to){var u=(m.maxDepth-n.depth)*2*h.LINE_WIDTH;r=l.getX(n.from)-(l.getDims().interEntitySpacing+2*h.LINE_WIDTH)/2-u,i=l.getX(n.to)+(l.getDims().interEntitySpacing+2*h.LINE_WIDTH)/2+u,s="striped"}var a=e.createLine({xFrom:r,yFrom:0,xTo:i,yTo:0},s);return o.appendChild(a),o.appendChild(V(t+"_txt",n)),n.linecolor&&a.setAttribute("style","stroke: "+n.linecolor+";"),o}function J(n,r,i,s){r.from>r.to&&o.swapfromto(r);var u=r.to-r.from+l.getDims().interEntitySpacing-2*h.LINE_WIDTH,a=6,f=r.from-(l.getDims().interEntitySpacing-2*h.LINE_WIDTH)/2,p=e.createGroup(n),d,v=c.createLabel(i,{x:f,y:0,width:u}),g=t.getBBox(v),y=s?s:Math.max(g.height+2*h.LINE_WIDTH,m.arcRowHeight-2*h.LINE_WIDTH),b={width:u,height:y,x:f,y:0-y/2};switch(i.kind){case"box":d=e.createRect(b,"box",i.linecolor,i.textbgcolor);break;case"rbox":d=e.createRect(b,"box",i.linecolor,i.textbgcolor,a,a);break;case"abox":b.y=0,d=e.createABox(b,"box",i.linecolor,i.textbgcolor);break;case"note":d=e.createNote(b,"box",i.linecolor,i.textbgcolor);break;default:var w=(m.maxDepth-i.depth)*2*h.LINE_WIDTH;d=e.createRect({width:u+w*2,height:y,x:f-w,y:0},"box",i.linecolor,i.textbgcolor)}return p.appendChild(d),p.appendChild(v),p}function K(e,n){m.document=r.init(n),t.init(m.document),t.removeRenderedSVGFromElement(e)}var p=3,d=38,v=0,m={arcRowHeight:d,arcGradient:v,arcEndX:0,wordWrapArcs:!1,maxDepth:0,document:{},layer:{defs:{},lifeline:{},sequence:{},notes:{},inline:{}}},g=[];return{clean:K,renderAST:y}}),n("render/text/ast2dot",["./flatten","./textutensils","./arcmappings","../../utl/utensils"],function(e,t,n,r){"use strict";function o(e){var t="/* Sequence chart represented as a directed graph\n * in the graphviz dot language (http://graphviz.org/)\n *\n * Generated by mscgen_js (https://sverweij.github.io/mscgen_js)\n */\n\ngraph {\n";return t+=i+"rankdir=LR\n",t+=i+"splines=true\n",t+=i+"ordering=out\n",t+=i+'fontname="Helvetica"\n',t+=i+'fontsize="9"\n',t+=i+'node [style=filled, fillcolor=white fontname="Helvetica", fontsize="9" ]\n',t+=i+'edge [fontname="Helvetica", fontsize="9", arrowhead=vee, arrowtail=vee, dir=forward]\n',t+="\n",e&&(e.entities&&(t+=d(e.entities)+"\n"),e.arcs&&(s=0,t+=w(e.arcs,""))),t+="}"}function u(e){var n=t.wrap(e.replace(/\"/g,'\\"'),40),r=n.slice(0,-1).reduce(function(e,t){return e+t+"\n"},"");return r+=n.slice(-1),r}function a(e,t){return t+'="'+u(e)+'"'}function f(e,t,n){!t||e.push(a(t,n))}function l(e){return["label","color","fontcolor","fillcolor"].filter(function(t){return!!e[t]}).map(function(t){return a(e[t],t)})}function c(e){var t="";return e.length>0&&(t=e.slice(0,-1).reduce(function(e,t){return e+t+", "}," ["),t+=e.slice(-1)+"]"),t}function h(e){return'"'+e+'"'}function p(e){return h(e.name)+c(l(e))}function d(e){return e.reduce(function(e,t){return e+i+p(t)+";\n"},"")}function v(e,t){return e?"("+t+") "+e:"("+t+")"}function m(e,t,r){var s="",o="box"+t.toString();s+=o;var u=l(e);return f(u,n.getStyle(e.kind),"style"),f(u,n.getShape(e.kind),"shape"),s+=c(u)+"\n"+i+r,u=[],f(u,"dotted","style"),f(u,"none","dir"),s+=o+" -- {"+h(e.from)+","+h(e.to)+"}",s+=c(u),s}function g(e,t,r){var i="";e.label=v(e.label,r);var s=l(e);f(s,n.getStyle(e.kind),"style");switch(t){case"directional":f(s,n.getArrow(e.kind),"arrowhead");break;case"bidirectional":f(s,n.getArrow(e.kind),"arrowhead"),f(s,n.getArrow(e.kind),"arrowtail"),f(s,"both","dir");break;case"nondirectional":f(s,"none","dir")}return e.arcs||(i+=h(e.from)+" ",i+="--",i+=" "+h(e.to),i+=c(s)),i}function y(e,t,r){var i="",s=n.getAggregate(e.kind);return s==="box"?i+=m(e,t,r):i+=g(e,s,t),i}function b(e,t){var n="";return e.from&&e.kind&&e.to&&(n+=i+t+y(e,++s,t)+"\n",e.arcs&&(n+=i+t+"subgraph cluster_"+s.toString()+"{",e.label&&(n+="\n"+i+t+' label="'+e.kind+": "+e.label+'" labeljust="l" \n'),n+=w(e.arcs,t+i),n+=i+t+"}\n")),n}function w(e,t){return e.reduce(function(e,n){return e+n.reduce(function(e,n){return e+b(n,t)},"")},"")}var i="  ",s=0;return{render:function(t){return o(e.dotFlatten(r.clone(t)))}}}),n("render/text/ast2thing",["./textutensils"],function(e){"use strict";function o(e){Object.getOwnPropertyNames(e).forEach(function(t){s[t]=e[t]})}function u(e){o(i),o(e)}function a(e,t){return u(t),f(e)}function f(e){var t="";return e&&(e.precomment&&(t+=s.renderCommentfn(e.precomment)),t+=s.program.opener,e.options&&(t+=d(e.options)),e.entities&&(t+=m(e.entities,s.renderEntityfn)),e.arcs&&(t+=E(e.arcs,"")),t+=s.program.closer),t}function l(e,t){return t.filter(function(t){return!!e[t]}).map(function(t){return{name:t,value:e[t]}})}function c(e){return e.reduce(function(e,t){return e+t},"")}function h(e){function t(e){var t=e.match(/[a-z0-9]+/gi);return t?t.length!==1:e!=="*"}return t(e)?'"'+e+'"':e}function p(t){return t.name+'="'+e.escapeString(t.value)+'"'}function d(e){var t=l(e,s.supportedOptions),n="";if(t.length>0){var r=t.pop();n=t.reduce(function(e,t){return e+s.renderOptionfn(t)+s.option.separator},s.option.opener),n+=s.renderOptionfn(r)+s.option.closer}return n}function v(e){return s.renderEntityNamefn(e.name)+g(e,s.supportedEntityAttributes)}function m(e){var t="";return e.length>0&&(t=e.slice(0,-1).reduce(function(e,t){return e+v(t)+s.entity.separator},s.entity.opener),t+=v(e[e.length-1])+s.entity.closer),t}function g(e,t){var n="",r=l(e,t);if(r.length>0){var i=r.pop();n=r.reduce(function(e,t){return e+s.renderAttributefn(t)+s.attribute.separator},s.attribute.opener),n+=s.renderAttributefn(i)+s.attribute.closer}return n}function y(e){return e}function b(e,n){var r="";return e.from&&(r+=s.renderEntityNamefn(e.from)+" "),e.kind&&(r+=s.renderKindfn(e.kind)),e.to&&(r+=" "+s.renderEntityNamefn(e.to)),r+=g(e,s.supportedArcAttributes),e.arcs&&(r+=s.inline.opener,r+=E(e.arcs,n+t),r+=n+s.inline.closer),null===e.arcs&&(r+=s.inline.opener,r+=n+s.inline.closer),r}function w(e,t){var n="";return e.length>0&&(n=e.slice(0,-1).reduce(function(e,n){return e+t+b(n,t)+s.arcline.separator},s.arcline.opener),n+=t+b(e[e.length-1],t)+s.arcline.closer),n}function E(e,t){return e.reduce(function(e,n){return e+w(n,t)},"")}var t="  ",n=" ",r="\n",i={renderCommentfn:c,renderOptionfn:p,renderEntityNamefn:h,renderKindfn:y,supportedOptions:["hscale","width","arcgradient","wordwraparcs","watermark"],supportedEntityAttributes:["label"],supportedArcAttributes:["label"],program:{opener:"",closer:""},option:{opener:"",separator:","+r,closer:";"+r+r},entity:{opener:"",separator:","+n,closer:";"+r+r},arcline:{opener:"",separator:","+r,closer:";"+r},inline:{opener:" {"+r,closer:"}"},attribute:{opener:"",separator:"",closer:""}},s={};return{render:a}}),n("render/text/ast2mscgen",["./arcmappings","./textutensils","./ast2thing"],function(e,t,n){"use strict";function u(e){!0===e?(o=!0,r="",i="",s=""):(o=!1,r="  ",i=" ",s="\n")}function a(t){return"inline_expression"===e.getAggregate(t)?"--":t}function f(e){var n="";return e.name&&e.value&&(n+=e.name+'="'+t.escapeString(e.value)+'"'),n}var r="  ",i=" ",s="\n",o=!1;return{render:function(e,t){return u(t),n.render(e,{renderAttributefn:f,renderKindfn:a,supportedOptions:["hscale","width","arcgradient","wordwraparcs"],supportedEntityAttributes:["label","idurl","id","url","linecolor","textcolor","textbgcolor","arclinecolor","arctextcolor","arctextbgcolor","arcskip"],supportedArcAttributes:["label","idurl","id","url","linecolor","textcolor","textbgcolor","arclinecolor","arctextcolor","arctextbgcolor","arcskip"],program:{opener:"msc"+i+"{"+s,closer:"}"},option:{opener:r,separator:","+s,closer:";"+s+s},entity:{opener:r,separator:","+s+r,closer:";"+s+s},attribute:{opener:i+"[",separator:","+i,closer:"]"},arcline:{opener:r,separator:","+s,closer:";"+s},inline:{opener:";"+s,closer:"#"}})}}}),n("render/text/ast2doxygen",["./arcmappings","./textutensils","./ast2thing"],function(e,t,n){"use strict";function u(t){return"inline_expression"===e.getAggregate(t)?"--":t}function a(e){var n="";return e.name&&e.value&&(n+=e.name+'="'+t.escapeString(e.value)+'"'),n}function f(){return""}var r="  ",i=" ",s="\n",o=" * ";return{render:function(e){return n.render(e,{renderCommentfn:f,renderAttributefn:a,renderKindfn:u,supportedOptions:["hscale","width","arcgradient","wordwraparcs"],supportedEntityAttributes:["label","idurl","id","url","linecolor","textcolor","textbgcolor","arclinecolor","arctextcolor","arctextbgcolor","arcskip"],supportedArcAttributes:["label","idurl","id","url","linecolor","textcolor","textbgcolor","arclinecolor","arctextcolor","arctextbgcolor","arcskip"],program:{opener:o+"\\msc"+s,closer:o+"\\endmsc"},option:{opener:o+r,separator:","+s+o+r,closer:";"+s+o+s},entity:{opener:o+r,separator:","+s+o+r,closer:";"+s+o+s},attribute:{opener:i+"[",separator:","+i,closer:"]"},arcline:{opener:o+r,separator:","+s+o+r,closer:";"+s},inline:{opener:";"+s,closer:o+"#"}})}}}),n("ui/utl/paramslikker",[],function(){"use strict";return{getParams:function(e){var t={};if(e){var n;e.slice(1).split("&").forEach(function(e){n=e.split("="),2===n.length&&(t[n[0]]=decodeURIComponent(n[1]))})}return t}}}),n("ui/utl/exporter",["../../render/text/ast2dot","../../render/text/ast2mscgen","../../render/text/ast2doxygen","./paramslikker"],function(e,t,n,r){"use strict";function u(e,t,n){return s.replace(/{{config}}/g,n?o:"").replace(/{{language}}/g,t).replace(/{{source}}/g,e)}function a(e){var t=r.getParams(e.search),n="";return t.donottrack&&(n+="&donottrack="+t.donottrack),t.debug&&(n+="&debug="+t.debug),n}function f(e,t,n){return e.pathname+"?lang="+n+a(e)+"&msc="+encodeURIComponent(t)}function l(e,t,n){return f(e,t,n).length<i}var i=4094,s="<!DOCTYPE html>\n<html>\n  <head>\n    <meta content='text/html;charset=utf-8' http-equiv='Content-Type'>\n{{config}}    <script src='https://sverweij.github.io/mscgen_js/mscgen-inpage.js' defer>\n    </script>\n  </head>\n  <body>\n    <pre class='code {{language}} mscgen_js' data-language='{{language}}'>\n{{source}}\n    </pre>\n  </body>\n</html>",o="    <script>\n      var mscgen_js_config = {\n        clickable: true\n      }\n    </script>\n";return{toVectorURI:function(e,t){t=t?t:window;var n=t.btoa(unescape(encodeURIComponent(e)));return"data:image/svg+xml;charset=utf-8;base64,"+n},toHTMLSnippet:u,toHTMLSnippetURI:function(e,t,n){return"data:text/plain;charset=utf-8,"+encodeURIComponent(u(e,t,n))},todotURI:function(t){return"data:text/plain;charset=utf-8,"+encodeURIComponent(e.render(t))},toVanillaMscGenURI:function(e){return"data:text/plain;charset=utf-8,"+encodeURIComponent(t.render(e))},toDoxygenURI:function(e){return"data:text/plain;charset=utf-8,"+encodeURIComponent(n.render(e))},toLocationString:function(e,t,n){var r="# source too long for an URL";return l(e,t,n)&&(r=t),f(e,r,n)}}}),n("ui/embedding/config",[],function(){"use strict";function t(e,t){Object.getOwnPropertyNames(t).forEach(function(n){e[n]=t[n]})}var e={defaultLanguage:"mscgen",parentElementPrefix:"mscgen_js-parent_",clickable:!1,clickURL:"https://sverweij.github.io/mscgen_js/",loadFromSrcAttribute:!1};return{getConfig:function(){return"undefined"!=typeof mscgen_js_config&&mscgen_js_config&&"object"==typeof mscgen_js_config&&t(e,mscgen_js_config),e}}}),n("ui/utl/domutl",[],function(){"use strict";return{SS:function(t){return{show:function(e){t.removeAttribute("style"),e&&(t.style.display=e)},hide:function(){t.style.display="none"},toggle:function(){t.style.display==="none"?t.removeAttribute("style"):t.style.display="none"}}},attachEventHandler:function(e,t,n){var r=document.querySelectorAll(e);for(var i=0;i<r.length;i++)r[i].addEventListener(t,n,!1)},doForAllOfClass:function(e,t){var n=document.getElementsByClassName(e);for(var r=0;r<n.length;r++)t(n[r])},ajax:function(e,t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(e){e.target.readyState===XMLHttpRequest.DONE&&(200===r.status?t(e):n(e))},r.open("GET",e),r.responseType="text";try{r.send()}catch(i){n()}},webkitNamespaceBugWorkaround:function(e){return e.replace(/\ xlink=/g," xmlns:xlink=","g").replace(/\ href=/g," xlink:href=","g")}}}),t(["parse/xuparser","parse/msgennyparser","render/graphics/renderast","utl/utensils","ui/utl/exporter","ui/embedding/config","ui/utl/domutl"],function(e,t,n,r,i,s,o){"use strict";function u(){var e=document.getElementsByClassName("mscgen_js");l(e,0),l(document.getElementsByTagName("mscgen"),e.length)}function a(e,t){return r.formatNumber(t,3)+" "+e}function f(e,t){return e.split("").reduce(function(e,n,r){return r===t?e+"<span style='text-decoration:underline'>"+n+"</span>":e+n},"")}function l(e,t){for(var n=0;n<e.length;n++)c(e[n],t+n)}function c(e,t){e.hasAttribute("data-renderedby")||p(e,t)}function h(e,t,n){var r=t?"<pre><div style='color: red'># ERROR on line "+t.start.line+", column "+t.start.column+" - "+n+"</div>":"<pre><div style='color: red'># ERROR "+n+"</div>";return e.split("\n").reduce(function(e,n,r){return!t||r!==t.start.line-1?e+a(n,r+1)+"\n":e+"<mark>"+a(f(n,t.start.column-1),r+1)+"\n"+"</mark>"},r)+"</pre>"}function p(e,t){m(e,t),e.setAttribute("data-renderedby","mscgen_js"),s.getConfig().loadFromSrcAttribute&&!!e.getAttribute("src")?o.ajax(e.getAttribute("src"),function(n){d(e,n.target.response)},function(){e.innerHTML="<code><div style='color: red'>ERROR: Could not find or open the URL '"+e.getAttribute("src")+"' specified in the <code>src</code> attribute.</div></code>"}):d(e,e.textContent)}function d(e,t){var n=g(e),r=y(t,n);r.entities?b(r,e.id,t,n):e.innerHTML=h(t,r.location,r.message)}function v(e,t,n){var r={pathname:"index.html"},o=document.createElement("a");return o.setAttribute("href",s.getConfig().clickURL+i.toLocationString(r,e,t)),o.setAttribute("id",n+"link"),o.setAttribute("style","text-decoration: none;"),o.setAttribute("title","click to edit in the mscgen_js interpreter"),o}function m(e,t){e.id||(e.id=s.getConfig().parentElementPrefix+t.toString())}function g(e){var t=e.getAttribute("data-language");return t||(t=s.getConfig().defaultLanguage),t}function y(n,r){var i={};try{"msgenny"===r?i=t.parse(n):"json"===r?i=JSON.parse(n):i=e.parse(n)}catch(s){return s}return i}function b(e,t,r,i){var o=document.getElementById(t);o.innerHTML="",!0===s.getConfig().clickable&&(o.appendChild(v(r,i,t)),t+="link"),n.clean(t,window),n.renderAST(e,r,t,window)}u()}),n("mscgen-inpage",function(){})})();